{"code":"!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=140)}([function(e,t,n){\"use strict\";var r=n(7),i=n(51),s=n(26),o=n(96),a=n(19);function l(e){return e}function c(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}t.newBlob=function(e,n){t.checkSupport(\"blob\");try{return new Blob([e],{type:n})}catch(t){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(n)}catch(e){throw new Error(\"Bug : can't construct the Blob.\")}}};var h={stringifyByChunk:function(e,t,n){var r=[],i=0,s=e.length;if(s<=n)return String.fromCharCode.apply(null,e);for(;i<s;)\"array\"===t||\"nodebuffer\"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,s)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,s)))),i+=n;return r.join(\"\")},stringifyByChar:function(e){for(var t=\"\",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var n=65536,r=t.getTypeOf(e),i=!0;if(\"uint8array\"===r?i=h.applyCanBeUsed.uint8array:\"nodebuffer\"===r&&(i=h.applyCanBeUsed.nodebuffer),i)for(;n>1;)try{return h.stringifyByChunk(e,r,n)}catch(e){n=Math.floor(n/2)}return h.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}t.applyFromCharCode=u;var f={};f.string={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return f.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,s.allocBuffer(e.length))}},f.array={string:u,array:l,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(e)}},f.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:l,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(new Uint8Array(e))}},f.uint8array={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:l,nodebuffer:function(e){return s.newBufferFrom(e)}},f.nodebuffer={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return f.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:l},t.transformTo=function(e,n){if(n||(n=\"\"),!e)return n;t.checkSupport(e);var r=t.getTypeOf(n);return f[r][e](n)},t.getTypeOf=function(e){return\"string\"==typeof e?\"string\":\"[object Array]\"===Object.prototype.toString.call(e)?\"array\":r.nodebuffer&&s.isBuffer(e)?\"nodebuffer\":r.uint8array&&e instanceof Uint8Array?\"uint8array\":r.arraybuffer&&e instanceof ArrayBuffer?\"arraybuffer\":void 0},t.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+\" is not supported by this platform\")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(e){var t,n,r=\"\";for(n=0;n<(e||\"\").length;n++)r+=\"\\\\x\"+((t=e.charCodeAt(n))<16?\"0\":\"\")+t.toString(16).toUpperCase();return r},t.delay=function(e,t,n){o(function(){e.apply(n||null,t||[])})},t.inherits=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},t.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},t.prepareContent=function(e,n,s,o,l){return a.Promise.resolve(n).then(function(e){return r.blob&&(e instanceof Blob||-1!==[\"[object File]\",\"[object Blob]\"].indexOf(Object.prototype.toString.call(e)))&&\"undefined\"!=typeof FileReader?new a.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(n){var h,u=t.getTypeOf(n);return u?(\"arraybuffer\"===u?n=t.transformTo(\"uint8array\",n):\"string\"===u&&(l?n=i.decode(n):s&&!0!==o&&(n=c(h=n,r.uint8array?new Uint8Array(h.length):new Array(h.length)))),n):a.Promise.reject(new Error(\"Can't read the data of '\"+e+\"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?\"))})}},function(e,t,n){\"use strict\";var r,i,s=e.exports=n(6),o=n(79);s.codegen=n(135),s.fetch=n(136),s.path=n(137),s.fs=s.inquire(\"fs\"),s.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},s.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],i=e[n++];void 0!==i&&(t[r]=i)}return t};var a=/\\\\/g,l=/\"/g;s.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},s.safeProp=function(e){return!/^[$\\w_]+$/.test(e)||s.isReserved(e)?'[\"'+e.replace(a,\"\\\\\\\\\").replace(l,'\\\\\"')+'\"]':\".\"+e},s.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;s.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(c,function(e,t){return t.toUpperCase()})},s.compareFieldsById=function(e,t){return e.id-t.id},s.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(s.decorateRoot.remove(e.$type),e.$type.name=t,s.decorateRoot.add(e.$type)),e.$type;r||(r=n(37));var i=new r(t||e.name);return s.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,\"$type\",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,\"$type\",{value:i,enumerable:!1}),i};var h=0;s.decorateEnum=function(e){if(e.$type)return e.$type;i||(i=n(5));var t=new i(\"Enum\"+h++,e);return s.decorateRoot.add(t),Object.defineProperty(e,\"$type\",{value:t,enumerable:!1}),t},Object.defineProperty(s,\"decorateRoot\",{get:function(){return o.decorated||(o.decorated=new(n(42)))}})},function(e,t,n){\"use strict\";function r(e){this.name=e||\"default\",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit(\"data\",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit(\"end\"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit(\"error\",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit(\"error\",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error(\"The stream '\"+this+\"' has already been used.\");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on(\"data\",function(e){t.processChunk(e)}),e.on(\"end\",function(){t.end()}),e.on(\"error\",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error(\"The stream '\"+this+\"' has already been used.\");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e=\"Worker \"+this.name;return this.previous?this.previous+\" -> \"+e:e}},e.exports=r},function(e,t){e.exports=require(\"stream\")},function(e,t,n){var r=n(91),i=r.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(s(r,t),t.Buffer=o),s(i,o),o.from=function(e,t,n){if(\"number\"==typeof e)throw new TypeError(\"Argument must not be a number\");return i(e,t,n)},o.alloc=function(e,t,n){if(\"number\"!=typeof e)throw new TypeError(\"Argument must be a number\");var r=i(e);return void 0!==t?\"string\"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Argument must be a number\");return i(e)},o.allocUnsafeSlow=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Argument must be a number\");return r.SlowBuffer(e)}},function(e,t,n){\"use strict\";e.exports=o;var r=n(14);((o.prototype=Object.create(r.prototype)).constructor=o).className=\"Enum\";var i=n(20),s=n(1);function o(e,t,n,i,s){if(r.call(this,e,n),t&&\"object\"!=typeof t)throw TypeError(\"values must be an object\");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=s||{},this.reserved=void 0,t)for(var o=Object.keys(t),a=0;a<o.length;++a)\"number\"==typeof t[o[a]]&&(this.valuesById[this.values[o[a]]=t[o[a]]]=o[a])}o.fromJSON=function(e,t){var n=new o(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject([\"options\",this.options,\"values\",this.values,\"reserved\",this.reserved&&this.reserved.length?this.reserved:void 0,\"comment\",t?this.comment:void 0,\"comments\",t?this.comments:void 0])},o.prototype.add=function(e,t,n){if(!s.isString(e))throw TypeError(\"name must be a string\");if(!s.isInteger(t))throw TypeError(\"id must be an integer\");if(void 0!==this.values[e])throw Error(\"duplicate name '\"+e+\"' in \"+this);if(this.isReservedId(t))throw Error(\"id \"+t+\" is reserved in \"+this);if(this.isReservedName(e))throw Error(\"name '\"+e+\"' is reserved in \"+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error(\"duplicate id \"+t+\" in \"+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=n||null,this},o.prototype.remove=function(e){if(!s.isString(e))throw TypeError(\"name must be a string\");var t=this.values[e];if(null==t)throw Error(\"name '\"+e+\"' does not exist in \"+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},o.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},o.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},function(e,t,n){\"use strict\";var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function s(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,\"message\",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,\"stack\",{value:(new Error).stack||\"\"}),n&&i(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,\"name\",{get:function(){return e}}),t.prototype.toString=function(){return this.name+\": \"+this.message},t}r.asPromise=n(76),r.base64=n(126),r.EventEmitter=n(127),r.float=n(128),r.inquire=n(77),r.utf8=n(129),r.pool=n(130),r.LongBits=n(131),r.global=\"undefined\"!=typeof window&&window||\"undefined\"!=typeof global&&global||\"undefined\"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isNode=Boolean(r.global.process&&r.global.process.versions&&r.global.process.versions.node),r.isInteger=Number.isInteger||function(e){return\"number\"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return\"string\"==typeof e||e instanceof String},r.isObject=function(e){return e&&\"object\"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&(\"object\"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire(\"buffer\").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return\"number\"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):\"undefined\"==typeof Uint8Array?e:new Uint8Array(e)},r.Array=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire(\"long\"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\\\x00-\\\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=s,r.ProtocolError=s(\"ProtocolError\"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},function(e,t,n){\"use strict\";if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer=\"undefined\"!=typeof ArrayBuffer&&\"undefined\"!=typeof Uint8Array,t.nodebuffer=\"undefined\"!=typeof Buffer,t.uint8array=\"undefined\"!=typeof Uint8Array,\"undefined\"==typeof ArrayBuffer)t.blob=!1;else{var r=new ArrayBuffer(0);try{t.blob=0===new Blob([r],{type:\"application/zip\"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),t.blob=0===i.getBlob(\"application/zip\").size}catch(e){t.blob=!1}}}try{t.nodestream=!!n(44).Readable}catch(e){t.nodestream=!1}},function(e,t,n){\"use strict\";var r=\"undefined\"!=typeof Uint8Array&&\"undefined\"!=typeof Uint16Array&&\"undefined\"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if(\"object\"!=typeof n)throw new TypeError(n+\"must be non-object\");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var s=0;s<r;s++)e[i+s]=t[n+s]},flattenChunks:function(e){var t,n,r,i,s,o;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)s=e[t],o.set(s,i),i+=s.length;return o}},o={arraySet:function(e,t,n,r,i){for(var s=0;s<r;s++)e[i+s]=t[n+s]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,s)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(r)},function(e,t,n){\"use strict\";e.exports=c;var r=n(14);((c.prototype=Object.create(r.prototype)).constructor=c).className=\"Field\";var i,s=n(5),o=n(15),a=n(1),l=/^required|optional|repeated$/;function c(e,t,n,i,s,c,h){if(a.isObject(i)?(h=s,c=i,i=s=void 0):a.isObject(s)&&(h=c,c=s,s=void 0),r.call(this,e,c),!a.isInteger(t)||t<0)throw TypeError(\"id must be a non-negative integer\");if(!a.isString(n))throw TypeError(\"type must be a string\");if(void 0!==i&&!l.test(i=i.toString().toLowerCase()))throw TypeError(\"rule must be a string rule\");if(void 0!==s&&!a.isString(s))throw TypeError(\"extend must be a string\");this.rule=i&&\"optional\"!==i?i:void 0,this.type=n,this.id=t,this.extend=s||void 0,this.required=\"required\"===i,this.optional=!this.required,this.repeated=\"repeated\"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&void 0!==o.long[n],this.bytes=\"bytes\"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=h}c.fromJSON=function(e,t){return new c(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(c.prototype,\"packed\",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption(\"packed\")),this._packed}}),c.prototype.setOption=function(e,t,n){return\"packed\"===e&&(this._packed=null),r.prototype.setOption.call(this,e,t,n)},c.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject([\"rule\",\"optional\"!==this.rule&&this.rule||void 0,\"type\",this.type,\"id\",this.id,\"extend\",this.extend,\"options\",this.options,\"comment\",t?this.comment:void 0])},c.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=o.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof s&&\"string\"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof s)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=a.Long.fromNumber(this.typeDefault,\"u\"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&\"string\"==typeof this.typeDefault){var e;a.base64.test(this.typeDefault)?a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0):a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=a.emptyObject:this.repeated?this.defaultValue=a.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},c.d=function(e,t,n,r){return\"function\"==typeof t?t=a.decorateType(t).name:t&&\"object\"==typeof t&&(t=a.decorateEnum(t).name),function(i,s){a.decorateType(i.constructor).add(new c(s,e,t,n,{default:r}))}},c._configure=function(e){i=e}},function(e,t){e.exports=require(\"fs\")},function(e,t){e.exports=require(\"zlib\")},function(e,t,n){\"use strict\";for(var r=n(0),i=n(7),s=n(26),o=n(2),a=new Array(256),l=0;l<256;l++)a[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;a[254]=a[254]=1;function c(){o.call(this,\"utf-8 decode\"),this.leftOver=null}function h(){o.call(this,\"utf-8 encode\")}t.utf8encode=function(e){return i.nodebuffer?s.newBufferFrom(e,\"utf-8\"):function(e){var t,n,r,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),o=0,s=0;o<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t}(e)},t.utf8decode=function(e){return i.nodebuffer?r.transformTo(\"nodebuffer\",e).toString(\"utf-8\"):function(e){var t,n,i,s,o=e.length,l=new Array(2*o);for(n=0,t=0;t<o;)if((i=e[t++])<128)l[n++]=i;else if((s=a[i])>4)l[n++]=65533,t+=s-1;else{for(i&=2===s?31:3===s?15:7;s>1&&t<o;)i=i<<6|63&e[t++],s--;s>1?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(i.uint8array?\"uint8array\":\"array\",e))},r.inherits(c,o),c.prototype.processChunk=function(e){var n=r.transformTo(i.uint8array?\"uint8array\":\"array\",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var s=n;(n=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),n.set(s,this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}var o=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+a[e[n]]>t?n:t}(n),l=n;o!==n.length&&(i.uint8array?(l=n.subarray(0,o),this.leftOver=n.subarray(o,n.length)):(l=n.slice(0,o),this.leftOver=n.slice(o,n.length))),this.push({data:t.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=c,r.inherits(h,o),h.prototype.processChunk=function(e){this.push({data:t.utf8encode(e.data),meta:e.meta})},t.Utf8EncodeWorker=h},function(e,t,n){\"use strict\";var r=n(24),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=u;var s=n(17);s.inherits=n(18);var o=n(45),a=n(48);s.inherits(u,o);for(var l=i(a.prototype),c=0;c<l.length;c++){var h=l[c];u.prototype[h]||(u.prototype[h]=a.prototype[h])}function u(e){if(!(this instanceof u))return new u(e);o.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once(\"end\",d)}function d(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(u.prototype,\"writableHighWaterMark\",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,\"destroyed\",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),u.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,n){\"use strict\";e.exports=s,s.className=\"ReflectionObject\";var r,i=n(1);function s(e,t){if(!i.isString(e))throw TypeError(\"name must be a string\");if(t&&!i.isObject(t))throw TypeError(\"options must be an object\");this.options=t,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(s.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(\".\")}}}),s.prototype.toJSON=function(){throw Error()},s.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},s.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},s.prototype.resolve=function(){return this.resolved?this:(this.root instanceof r&&(this.resolved=!0),this)},s.prototype.getOption=function(e){if(this.options)return this.options[e]},s.prototype.setOption=function(e,t,n){return n&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},s.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},s.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+\" \"+t:e},s._configure=function(e){r=e}},function(e,t,n){\"use strict\";var r=t,i=n(1),s=[\"double\",\"float\",\"int32\",\"uint32\",\"sint32\",\"fixed32\",\"sfixed32\",\"int64\",\"uint64\",\"sint64\",\"fixed64\",\"sfixed64\",\"bool\",\"string\",\"bytes\"];function o(e,t){var n=0,r={};for(t|=0;n<e.length;)r[s[n+t]]=e[n++];return r}r.basic=o([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=o([0,0,0,0,0,0,0,0,0,0,0,0,!1,\"\",i.emptyArray,null]),r.long=o([0,0,0,1,1],7),r.mapKey=o([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=o([1,5,0,0,0,5,5,0,0,0,1,1,0])},function(e,t){e.exports=require(\"url\")},function(e,t){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):\"[object Array]\"===n(e)},t.isBoolean=function(e){return\"boolean\"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return\"number\"==typeof e},t.isString=function(e){return\"string\"==typeof e},t.isSymbol=function(e){return\"symbol\"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return\"[object RegExp]\"===n(e)},t.isObject=function(e){return\"object\"==typeof e&&null!==e},t.isDate=function(e){return\"[object Date]\"===n(e)},t.isError=function(e){return\"[object Error]\"===n(e)||e instanceof Error},t.isFunction=function(e){return\"function\"==typeof e},t.isPrimitive=function(e){return null===e||\"boolean\"==typeof e||\"number\"==typeof e||\"string\"==typeof e||\"symbol\"==typeof e||void 0===e},t.isBuffer=Buffer.isBuffer},function(e,t,n){try{var r=n(25);if(\"function\"!=typeof r.inherits)throw\"\";e.exports=r.inherits}catch(t){e.exports=n(92)}},function(e,t,n){\"use strict\";var r=null;r=\"undefined\"!=typeof Promise?Promise:n(97),e.exports={Promise:r}},function(e,t,n){\"use strict\";e.exports=h;var r=n(14);((h.prototype=Object.create(r.prototype)).constructor=h).className=\"Namespace\";var i,s,o,a=n(9),l=n(1);function c(e,t){if(e&&e.length){for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}}function h(e,t){r.call(this,e,t),this.nested=void 0,this._nestedArray=null}function u(e){return e._nestedArray=null,e}h.fromJSON=function(e,t){return new h(e,t.options).addJSON(t.nested)},h.arrayToJSON=c,h.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if(\"string\"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>=t)return!0;return!1},h.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(h.prototype,\"nestedArray\",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),h.prototype.toJSON=function(e){return l.toObject([\"options\",this.options,\"nested\",c(this.nestedArray,e)])},h.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),r=0;r<n.length;++r)t=e[n[r]],this.add((void 0!==t.fields?i.fromJSON:void 0!==t.values?o.fromJSON:void 0!==t.methods?s.fromJSON:void 0!==t.id?a.fromJSON:h.fromJSON)(n[r],t));return this},h.prototype.get=function(e){return this.nested&&this.nested[e]||null},h.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof o)return this.nested[e].values;throw Error(\"no such enum: \"+e)},h.prototype.add=function(e){if(!(e instanceof a&&void 0!==e.extend||e instanceof i||e instanceof o||e instanceof s||e instanceof h))throw TypeError(\"object must be a valid nested object\");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof h&&e instanceof h)||t instanceof i||t instanceof s)throw Error(\"duplicate name '\"+e.name+\"' in \"+this);for(var n=t.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),u(this)},h.prototype.remove=function(e){if(!(e instanceof r))throw TypeError(\"object must be a ReflectionObject\");if(e.parent!==this)throw Error(e+\" is not a member of \"+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),u(this)},h.prototype.define=function(e,t){if(l.isString(e))e=e.split(\".\");else if(!Array.isArray(e))throw TypeError(\"illegal path\");if(e&&e.length&&\"\"===e[0])throw Error(\"path must be relative\");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(!((n=n.nested[r])instanceof h))throw Error(\"path conflicts with non-namespace objects\")}else n.add(n=new h(r))}return t&&n.addJSON(t),n},h.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof h?e[t++].resolveAll():e[t++].resolve();return this.resolve()},h.prototype.lookup=function(e,t,n){if(\"boolean\"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if(\".\"===e)return this.root;e=e.split(\".\")}else if(!e.length)return this;if(\"\"===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof h&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof h&&(r=this._nestedArray[i].lookup(e,t,!0)))return r;return null===this.parent||n?null:this.parent.lookup(e,t)},h.prototype.lookupType=function(e){var t=this.lookup(e,[i]);if(!t)throw Error(\"no such type: \"+e);return t},h.prototype.lookupEnum=function(e){var t=this.lookup(e,[o]);if(!t)throw Error(\"no such Enum '\"+e+\"' in \"+this);return t},h.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[i,o]);if(!t)throw Error(\"no such Type or Enum '\"+e+\"' in \"+this);return t},h.prototype.lookupService=function(e){var t=this.lookup(e,[s]);if(!t)throw Error(\"no such Service '\"+e+\"' in \"+this);return t},h._configure=function(e,t,n){i=e,s=t,o=n}},function(e,t){e.exports=require(\"crypto\")},function(e,t){e.exports=require(\"http\")},function(e,t){e.exports=require(\"path\")},function(e,t,n){\"use strict\";!process.version||0===process.version.indexOf(\"v0.\")||0===process.version.indexOf(\"v1.\")&&0!==process.version.indexOf(\"v1.8.\")?e.exports={nextTick:function(e,t,n,r){if(\"function\"!=typeof e)throw new TypeError('\"callback\" argument must be a function');var i,s,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,t)});case 3:return process.nextTick(function(){e.call(null,t,n)});case 4:return process.nextTick(function(){e.call(null,t,n,r)});default:for(i=new Array(o-1),s=0;s<i.length;)i[s++]=arguments[s];return process.nextTick(function(){e.apply(null,i)})}}}:e.exports=process},function(e,t){e.exports=require(\"util\")},function(e,t,n){\"use strict\";e.exports={isNode:\"undefined\"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if(\"number\"==typeof e)throw new Error('The \"data\" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&\"function\"==typeof e.on&&\"function\"==typeof e.pause&&\"function\"==typeof e.resume}}},function(e,t,n){\"use strict\";const r=n(4),i=n(120),s=n(11),o=n(34),a=r.Buffer,l=a.from([0,0,255,255]),c=a.from([0]),h=Symbol(\"write-in-progress\"),u=Symbol(\"pending-close\"),d=Symbol(\"total-length\"),f=Symbol(\"callback\"),p=Symbol(\"buffers\"),m=Symbol(\"error\"),g=Symbol(\"owner\");let y;function _(e){this[p].push(e),this[d]+=e.length}function v(e){this[d]+=e.length,this[g]._maxPayload<1||this[d]<=this[g]._maxPayload?this[p].push(e):(this[m]=new RangeError(\"Max payload size exceeded\"),this[m].closeCode=1009,this.removeListener(\"data\",v),this.reset())}function b(e){this[g]._inflate=null,this[f](e)}e.exports=class{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!y){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;y=new i({concurrency:e})}}static get extensionName(){return\"permessage-deflate\"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){this._inflate&&(this._inflate[h]?this._inflate[u]=!0:(this._inflate.close(),this._inflate=null)),this._deflate&&(this._deflate[h]?this._deflate[u]=!0:(this._deflate.close(),this._deflate=null))}acceptAsServer(e){const t=this._options,n=e.find(e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||\"number\"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||\"number\"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits));if(!n)throw new Error(\"None of the extension offers can be accepted\");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),\"number\"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),\"number\"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter \"client_no_context_takeover\"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||\"number\"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter \"client_max_window_bits\"')}else\"number\"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{var n=e[t];if(n.length>1)throw new Error(`Parameter \"${t}\" must have only a single value`);if(n=n[0],\"client_max_window_bits\"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter \"${t}\": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter \"${t}\": ${n}`)}else if(\"server_max_window_bits\"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter \"${t}\": ${n}`);n=e}else{if(\"client_no_context_takeover\"!==t&&\"server_no_context_takeover\"!==t)throw new Error(`Unknown parameter \"${t}\"`);if(!0!==n)throw new TypeError(`Invalid value for parameter \"${t}\": ${n}`)}e[t]=n})}),e}decompress(e,t,n){y.push(r=>{this._decompress(e,t,(e,t)=>{r(),n(e,t)})})}compress(e,t,n){y.push(r=>{this._compress(e,t,(e,t)=>{r(),n(e,t)})})}_decompress(e,t,n){const r=this._isServer?\"client\":\"server\";if(!this._inflate){const e=`${r}_max_window_bits`,t=\"number\"!=typeof this.params[e]?s.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=s.createInflateRaw(Object.assign({},this._options.zlibInflateOptions,{windowBits:t})),this._inflate[d]=0,this._inflate[p]=[],this._inflate[g]=this,this._inflate.on(\"error\",b),this._inflate.on(\"data\",v)}this._inflate[f]=n,this._inflate[h]=!0,this._inflate.write(e),t&&this._inflate.write(l),this._inflate.flush(()=>{const e=this._inflate[m];if(e)return this._inflate.close(),this._inflate=null,void n(e);const i=o.concat(this._inflate[p],this._inflate[d]);t&&this.params[`${r}_no_context_takeover`]||this._inflate[u]?(this._inflate.close(),this._inflate=null):(this._inflate[h]=!1,this._inflate[d]=0,this._inflate[p]=[]),n(null,i)})}_compress(e,t,n){if(!e||0===e.length)return void process.nextTick(n,null,c);const r=this._isServer?\"server\":\"client\";if(!this._deflate){const e=`${r}_max_window_bits`,t=\"number\"!=typeof this.params[e]?s.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=s.createDeflateRaw(Object.assign({memLevel:this._options.memLevel,level:this._options.level},this._options.zlibDeflateOptions,{windowBits:t})),this._deflate[d]=0,this._deflate[p]=[],this._deflate.on(\"data\",_)}this._deflate[h]=!0,this._deflate.write(e),this._deflate.flush(s.Z_SYNC_FLUSH,()=>{var e=o.concat(this._deflate[p],this._deflate[d]);t&&(e=e.slice(0,e.length-4)),t&&this.params[`${r}_no_context_takeover`]||this._deflate[u]?(this._deflate.close(),this._deflate=null):(this._deflate[h]=!1,this._deflate[d]=0,this._deflate[p]=[]),n(null,e)})}}},function(e,t,n){\"use strict\";const r=n(4).Buffer;t.BINARY_TYPES=[\"nodebuffer\",\"arraybuffer\",\"fragments\"],t.GUID=\"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\",t.EMPTY_BUFFER=r.alloc(0),t.NOOP=(()=>{})},function(e,t,n){\"use strict\";e.exports=o;var r=n(14);((o.prototype=Object.create(r.prototype)).constructor=o).className=\"OneOf\";var i=n(9),s=n(1);function o(e,t,n,i){if(Array.isArray(t)||(n=t,t=void 0),r.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError(\"fieldNames must be an Array\");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}o.fromJSON=function(e,t){return new o(e,t.oneof,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject([\"options\",this.options,\"oneof\",this.oneof,\"comment\",t?this.comment:void 0])},o.prototype.add=function(e){if(!(e instanceof i))throw TypeError(\"field must be a Field\");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},o.prototype.remove=function(e){if(!(e instanceof i))throw TypeError(\"field must be a Field\");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+\" is not a member of \"+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},o.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}a(this)},o.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},o.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){s.decorateType(t.constructor).add(new o(n,e)),Object.defineProperty(t,n,{get:s.oneOfGetter(e),set:s.oneOfSetter(e)})}}},function(e,t){e.exports=require(\"events\")},function(e,t,n){\"use strict\";var r=n(19),i=n(54),s=n(55),o=n(56);s=n(55);function a(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}a.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s(\"data_length\")),t=this;return e.on(\"end\",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error(\"Bug : uncompressed data size mismatch\")}),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo(\"compressedSize\",this.compressedSize).withStreamInfo(\"uncompressedSize\",this.uncompressedSize).withStreamInfo(\"crc32\",this.crc32).withStreamInfo(\"compression\",this.compression)}},a.createWorkerFrom=function(e,t,n){return e.pipe(new o).pipe(new s(\"uncompressedSize\")).pipe(t.compressWorker(n)).pipe(new s(\"compressedSize\")).withStreamInfo(\"compression\",t)},e.exports=a},function(e,t,n){\"use strict\";var r=n(0);var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t){return void 0!==e&&e.length?\"string\"!==r.getTypeOf(e)?function(e,t,n,r){var s=i,o=r+n;e^=-1;for(var a=r;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}(0|t,e,e.length,0):function(e,t,n,r){var s=i,o=r+n;e^=-1;for(var a=r;a<o;a++)e=e>>>8^s[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length,0):0}},function(e,t,n){\"use strict\";e.exports={2:\"need dictionary\",1:\"stream end\",0:\"\",\"-1\":\"file error\",\"-2\":\"stream error\",\"-3\":\"data error\",\"-4\":\"insufficient memory\",\"-5\":\"buffer error\",\"-6\":\"incompatible version\"}},function(e,t,n){\"use strict\";const r=n(4).Buffer,i=(e,t)=>{const n=r.allocUnsafe(t);for(var i=0,s=0;s<e.length;s++){const t=e[s];t.copy(n,i),i+=t.length}return n};try{const t=n(!function(){var e=new Error(\"Cannot find module 'bufferutil'\");throw e.code=\"MODULE_NOT_FOUND\",e}());e.exports=Object.assign({concat:i},t.BufferUtil||t)}catch(t){const n=(e,t,n,r,i)=>{for(var s=0;s<i;s++)n[r+s]=e[s]^t[3&s]},r=(e,t)=>{const n=e.length;for(var r=0;r<n;r++)e[r]^=t[3&r]};e.exports={concat:i,mask:n,unmask:r}}},function(e,t,n){\"use strict\";e.exports=u;var r,i=n(6),s=i.LongBits,o=i.base64,a=i.utf8;function l(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function c(){}function h(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}function d(e,t,n){t[n]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function p(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function m(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}u.create=i.Buffer?function(){return(u.create=function(){return new r})()}:function(){return new u},u.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(u.alloc=i.pool(u.alloc,i.Array.prototype.subarray)),u.prototype._push=function(e,t,n){return this.tail=this.tail.next=new l(e,t,n),this.len+=t,this},f.prototype=Object.create(l.prototype),f.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(p,10,s.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=s.from(e);return this._push(p,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(p,t.length(),t)},u.prototype.bool=function(e){return this._push(d,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=s.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var g=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(i.isString(e)){var n=u.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},u.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(d,1,0)},u.prototype.fork=function(){return this.states=new h(this),this.head=this.tail=new l(c,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},u._configure=function(e){r=e}},function(e,t,n){\"use strict\";e.exports=l;var r,i=n(6),s=i.LongBits,o=i.utf8;function a(e,t){return RangeError(\"index out of range: \"+e.pos+\" + \"+(t||1)+\" > \"+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var c,h=\"undefined\"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error(\"illegal buffer\")}:function(e){if(Array.isArray(e))return new l(e);throw Error(\"illegal buffer\")};function u(){var e=new s(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error(\"invalid varint encoding\")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new s(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}l.create=i.Buffer?function(e){return(l.create=function(e){return i.Buffer.isBuffer(e)?new r(e):h(e)})(e)}:h,l.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,l.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return c}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},l.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},l.prototype.skip=function(e){if(\"number\"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(\"invalid wire type \"+e+\" at offset \"+this.pos)}return this},l._configure=function(e){r=e;var t=i.Long?\"toLong\":\"toNumber\";i.merge(l.prototype,{int64:function(){return u.call(this)[t](!1)},uint64:function(){return u.call(this)[t](!0)},sint64:function(){return u.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},function(e,t,n){\"use strict\";e.exports=_;var r=n(20);((_.prototype=Object.create(r.prototype)).constructor=_).className=\"Type\";var i=n(5),s=n(29),o=n(9),a=n(38),l=n(39),c=n(41),h=n(36),u=n(35),d=n(1),f=n(80),p=n(81),m=n(82),g=n(83),y=n(84);function _(e,t){r.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function v(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(_.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error(\"duplicate id \"+r+\" in \"+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=d.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=d.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=_.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof c||((e.prototype=new c).constructor=e,d.merge(e.prototype,t)),e.$type=e.prototype.$type=this,d.merge(e,c,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:d.oneOfGetter(this._oneofsArray[n].oneof),set:d.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,r)}}}),_.generateConstructor=function(e){for(var t,n=d.codegen([\"p\"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?n(\"this%s={}\",d.safeProp(t.name)):t.repeated&&n(\"this%s=[]\",d.safeProp(t.name));return n(\"if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)\")(\"this[ks[i]]=p[ks[i]]\")},_.fromJSON=function(e,t){var n=new _(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var c=Object.keys(t.fields),h=0;h<c.length;++h)n.add((void 0!==t.fields[c[h]].keyType?a.fromJSON:o.fromJSON)(c[h],t.fields[c[h]]));if(t.oneofs)for(c=Object.keys(t.oneofs),h=0;h<c.length;++h)n.add(s.fromJSON(c[h],t.oneofs[c[h]]));if(t.nested)for(c=Object.keys(t.nested),h=0;h<c.length;++h){var u=t.nested[c[h]];n.add((void 0!==u.id?o.fromJSON:void 0!==u.fields?_.fromJSON:void 0!==u.values?i.fromJSON:void 0!==u.methods?l.fromJSON:r.fromJSON)(c[h],u))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},_.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return d.toObject([\"options\",t&&t.options||void 0,\"oneofs\",r.arrayToJSON(this.oneofsArray,e),\"fields\",r.arrayToJSON(this.fieldsArray.filter(function(e){return!e.declaringField}),e)||{},\"extensions\",this.extensions&&this.extensions.length?this.extensions:void 0,\"reserved\",this.reserved&&this.reserved.length?this.reserved:void 0,\"group\",this.group||void 0,\"nested\",t&&t.nested||void 0,\"comment\",n?this.comment:void 0])},_.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return r.prototype.resolveAll.call(this)},_.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},_.prototype.add=function(e){if(this.get(e.name))throw Error(\"duplicate name '\"+e.name+\"' in \"+this);if(e instanceof o&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error(\"duplicate id \"+e.id+\" in \"+this);if(this.isReservedId(e.id))throw Error(\"id \"+e.id+\" is reserved in \"+this);if(this.isReservedName(e.name))throw Error(\"name '\"+e.name+\"' is reserved in \"+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),v(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),v(this)):r.prototype.add.call(this,e)},_.prototype.remove=function(e){if(e instanceof o&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+\" is not a member of \"+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),v(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+\" is not a member of \"+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),v(this)}return r.prototype.remove.call(this,e)},_.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},_.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},_.prototype.create=function(e){return new this.ctor(e)},_.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=f(this)({Writer:u,types:t,util:d}),this.decode=p(this)({Reader:h,types:t,util:d}),this.verify=m(this)({types:t,util:d}),this.fromObject=g.fromObject(this)({types:t,util:d}),this.toObject=g.toObject(this)({types:t,util:d});var r=y[e];if(r){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(i),i.toObject=this.toObject,this.toObject=r.toObject.bind(i)}return this},_.prototype.encode=function(e,t){return this.setup().encode(e,t)},_.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},_.prototype.decode=function(e,t){return this.setup().decode(e,t)},_.prototype.decodeDelimited=function(e){return e instanceof h||(e=h.create(e)),this.decode(e,e.uint32())},_.prototype.verify=function(e){return this.setup().verify(e)},_.prototype.fromObject=function(e){return this.setup().fromObject(e)},_.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},_.d=function(e){return function(t){d.decorateType(t,e)}}},function(e,t,n){\"use strict\";e.exports=o;var r=n(9);((o.prototype=Object.create(r.prototype)).constructor=o).className=\"MapField\";var i=n(15),s=n(1);function o(e,t,n,i,o,a){if(r.call(this,e,t,i,void 0,void 0,o,a),!s.isString(n))throw TypeError(\"keyType must be a string\");this.keyType=n,this.resolvedKeyType=null,this.map=!0}o.fromJSON=function(e,t){return new o(e,t.id,t.keyType,t.type,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject([\"keyType\",this.keyType,\"type\",this.type,\"id\",this.id,\"extend\",this.extend,\"options\",this.options,\"comment\",t?this.comment:void 0])},o.prototype.resolve=function(){if(this.resolved)return this;if(void 0===i.mapKey[this.keyType])throw Error(\"invalid key type: \"+this.keyType);return r.prototype.resolve.call(this)},o.d=function(e,t,n){return\"function\"==typeof n?n=s.decorateType(n).name:n&&\"object\"==typeof n&&(n=s.decorateEnum(n).name),function(r,i){s.decorateType(r.constructor).add(new o(i,e,t,n))}}},function(e,t,n){\"use strict\";e.exports=a;var r=n(20);((a.prototype=Object.create(r.prototype)).constructor=a).className=\"Service\";var i=n(40),s=n(1),o=n(78);function a(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}a.fromJSON=function(e,t){var n=new a(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),s=0;s<r.length;++s)n.add(i.fromJSON(r[s],t.methods[r[s]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},a.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return s.toObject([\"options\",t&&t.options||void 0,\"methods\",r.arrayToJSON(this.methodsArray,e)||{},\"nested\",t&&t.nested||void 0,\"comment\",n?this.comment:void 0])},Object.defineProperty(a.prototype,\"methodsArray\",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},a.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},a.prototype.add=function(e){if(this.get(e.name))throw Error(\"duplicate name '\"+e.name+\"' in \"+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,l(this)):r.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+\" is not a member of \"+this);return delete this.methods[e.name],e.parent=null,l(this)}return r.prototype.remove.call(this,e)},a.prototype.create=function(e,t,n){for(var r,i=new o.Service(e,t,n),a=0;a<this.methodsArray.length;++a){var l=s.lcFirst((r=this._methodsArray[a]).resolve().name).replace(/[^$\\w_]/g,\"\");i[l]=s.codegen([\"r\",\"c\"],s.isReserved(l)?l+\"_\":l)(\"return this.rpcCall(m,q,s,r,c)\")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return i}},function(e,t,n){\"use strict\";e.exports=s;var r=n(14);((s.prototype=Object.create(r.prototype)).constructor=s).className=\"Method\";var i=n(1);function s(e,t,n,s,o,a,l,c){if(i.isObject(o)?(l=o,o=a=void 0):i.isObject(a)&&(l=a,a=void 0),void 0!==t&&!i.isString(t))throw TypeError(\"type must be a string\");if(!i.isString(n))throw TypeError(\"requestType must be a string\");if(!i.isString(s))throw TypeError(\"responseType must be a string\");r.call(this,e,l),this.type=t||\"rpc\",this.requestType=n,this.requestStream=!!o||void 0,this.responseType=s,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=c}s.fromJSON=function(e,t){return new s(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject([\"type\",\"rpc\"!==this.type&&this.type||void 0,\"requestType\",this.requestType,\"requestStream\",this.requestStream,\"responseType\",this.responseType,\"responseStream\",this.responseStream,\"options\",this.options,\"comment\",t?this.comment:void 0])},s.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},function(e,t,n){\"use strict\";e.exports=i;var r=n(6);function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},function(e,t,n){\"use strict\";e.exports=u;var r=n(20);((u.prototype=Object.create(r.prototype)).constructor=u).className=\"Root\";var i,s,o,a=n(9),l=n(5),c=n(29),h=n(1);function u(e){r.call(this,\"\",e),this.deferred=[],this.files=[]}function d(){}u.fromJSON=function(e,t){return t||(t=new u),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},u.prototype.resolvePath=h.path.resolve,u.prototype.load=function e(t,n,r){\"function\"==typeof n&&(r=n,n=void 0);var i=this;if(!r)return h.asPromise(e,i,t,n);var a=r===d;function l(e,t){if(r){var n=r;if(r=null,a)throw e;n(e,t)}}function c(e,t){try{if(h.isString(t)&&\"{\"===t.charAt(0)&&(t=JSON.parse(t)),h.isString(t)){s.filename=e;var r,o=s(t,i,n),c=0;if(o.imports)for(;c<o.imports.length;++c)(r=i.resolvePath(e,o.imports[c]))&&u(r);if(o.weakImports)for(c=0;c<o.weakImports.length;++c)(r=i.resolvePath(e,o.weakImports[c]))&&u(r,!0)}else i.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}a||f||l(null,i)}function u(e,t){var n=e.lastIndexOf(\"google/protobuf/\");if(n>-1){var s=e.substring(n);s in o&&(e=s)}if(!(i.files.indexOf(e)>-1))if(i.files.push(e),e in o)a?c(e,o[e]):(++f,setTimeout(function(){--f,c(e,o[e])}));else if(a){var u;try{u=h.fs.readFileSync(e).toString(\"utf8\")}catch(e){return void(t||l(e))}c(e,u)}else++f,h.fetch(e,function(n,s){--f,r&&(n?t?f||l(null,i):l(n):c(e,s))})}var f=0;h.isString(t)&&(t=[t]);for(var p,m=0;m<t.length;++m)(p=i.resolvePath(\"\",t[m]))&&u(p);if(a)return i;f||l(null,i)},u.prototype.loadSync=function(e,t){if(!h.isNode)throw Error(\"not supported\");return this.load(e,t,d)},u.prototype.resolveAll=function(){if(this.deferred.length)throw Error(\"unresolvable extensions: \"+this.deferred.map(function(e){return\"'extend \"+e.extend+\"' in \"+e.parent.fullName}).join(\", \"));return r.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function p(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new a(t.fullName,t.id,t.type,t.rule,void 0,t.options);return r.declaringField=t,t.extensionField=r,n.add(r),!0}return!1}u.prototype._handleAdd=function(e){if(e instanceof a)void 0===e.extend||e.extensionField||p(0,e)||this.deferred.push(e);else if(e instanceof l)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof c)){if(e instanceof i)for(var t=0;t<this.deferred.length;)p(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);f.test(e.name)&&(e.parent[e.name]=e)}},u.prototype._handleRemove=function(e){if(e instanceof a){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof l)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);f.test(e.name)&&delete e.parent[e.name]}},u._configure=function(e,t,n){i=e,s=t,o=n}},function(e,t){e.exports=require(\"https\")},function(e,t,n){var r=n(3);\"disable\"===process.env.READABLE_STREAM&&r?(e.exports=r,(t=e.exports=r.Readable).Readable=r.Readable,t.Writable=r.Writable,t.Duplex=r.Duplex,t.Transform=r.Transform,t.PassThrough=r.PassThrough,t.Stream=r):((t=e.exports=n(45)).Stream=r||t,t.Readable=t,t.Writable=n(48),t.Duplex=n(13),t.Transform=n(50),t.PassThrough=n(95))},function(e,t,n){\"use strict\";var r=n(24);e.exports=_;var i,s=n(90);_.ReadableState=y;n(30).EventEmitter;var o=function(e,t){return e.listeners(t).length},a=n(46),l=n(4).Buffer,c=global.Uint8Array||function(){};var h=n(17);h.inherits=n(18);var u=n(25),d=void 0;d=u&&u.debuglog?u.debuglog(\"stream\"):function(){};var f,p=n(93),m=n(47);h.inherits(_,a);var g=[\"error\",\"close\",\"destroy\",\"pause\",\"resume\"];function y(e,t){e=e||{};var r=t instanceof(i=i||n(13));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var s=e.highWaterMark,o=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=s||0===s?s:r&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||\"utf8\",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(f||(f=n(49).StringDecoder),this.decoder=new f(e.encoding),this.encoding=e.encoding)}function _(e){if(i=i||n(13),!(this instanceof _))return new _(e);this._readableState=new y(e,this),this.readable=!0,e&&(\"function\"==typeof e.read&&(this._read=e.read),\"function\"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function v(e,t,n,r,i){var s,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,k(e)}(e,o)):(i||(s=function(e,t){var n;r=t,l.isBuffer(r)||r instanceof c||\"string\"==typeof t||void 0===t||e.objectMode||(n=new TypeError(\"Invalid non-string/buffer chunk\"));var r;return n}(o,t)),s?e.emit(\"error\",s):o.objectMode||t&&t.length>0?(\"string\"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),r?o.endEmitted?e.emit(\"error\",new Error(\"stream.unshift() after end event\")):b(e,o,t,!0):o.ended?e.emit(\"error\",new Error(\"stream.push() after EOF\")):(o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?b(e,o,t,!1):x(e,o)):b(e,o,t,!1))):r||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function b(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit(\"data\",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&k(e)),x(e,t)}Object.defineProperty(_.prototype,\"destroyed\",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=m.destroy,_.prototype._undestroy=m.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:\"string\"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=\"\"),n=!0),v(this,e,t,!1,n)},_.prototype.unshift=function(e){return v(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return f||(f=n(49).StringDecoder),this._readableState.decoder=new f(e),this._readableState.encoding=e,this};var w=8388608;function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=w?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function k(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(d(\"emitReadable\",t.flowing),t.emittedReadable=!0,t.sync?r.nextTick(C,e):C(e))}function C(e){d(\"emit readable\"),e.emit(\"readable\"),O(e)}function x(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(T,e,t))}function T(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(d(\"maybeReadMore read 0\"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function E(e){d(\"readable nexttick read 0\"),e.read(0)}function A(e,t){t.reading||(d(\"resume read 0\"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit(\"resume\"),O(e),t.flowing&&!t.reading&&e.read(0)}function O(e){var t=e._readableState;for(d(\"flow\",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(\"\"):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var s=n.data,o=e>s.length?s.length:e;if(o===s.length?i+=s:i+=s.slice(0,e),0===(e-=o)){o===s.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=s.slice(o));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=l.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var s=r.data,o=e>s.length?s.length:e;if(s.copy(n,n.length-e,0,o),0===(e-=o)){o===s.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(o));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function R(e){var t=e._readableState;if(t.length>0)throw new Error('\"endReadable()\" called on non-empty stream');t.endEmitted||(t.ended=!0,r.nextTick(N,t,e))}function N(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit(\"end\"))}function $(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){d(\"read\",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return d(\"read: emitReadable\",t.length,t.ended),0===t.length&&t.ended?R(this):k(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&R(this),null;var r,i=t.needReadable;return d(\"need readable\",i),(0===t.length||t.length-e<t.highWaterMark)&&d(\"length less than watermark\",i=!0),t.ended||t.reading?d(\"reading or ended\",i=!1):i&&(d(\"do read\"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(n,t))),null===(r=e>0?I(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&R(this)),null!==r&&this.emit(\"data\",r),r},_.prototype._read=function(e){this.emit(\"error\",new Error(\"_read() is not implemented\"))},_.prototype.pipe=function(e,t){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,d(\"pipe count=%d opts=%j\",i.pipesCount,t);var a=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?c:_;function l(t,r){d(\"onunpipe\"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,d(\"cleanup\"),e.removeListener(\"close\",g),e.removeListener(\"finish\",y),e.removeListener(\"drain\",h),e.removeListener(\"error\",m),e.removeListener(\"unpipe\",l),n.removeListener(\"end\",c),n.removeListener(\"end\",_),n.removeListener(\"data\",p),u=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}function c(){d(\"onend\"),e.end()}i.endEmitted?r.nextTick(a):n.once(\"end\",a),e.on(\"unpipe\",l);var h=function(e){return function(){var t=e._readableState;d(\"pipeOnDrain\",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,\"data\")&&(t.flowing=!0,O(e))}}(n);e.on(\"drain\",h);var u=!1;var f=!1;function p(t){d(\"ondata\"),f=!1,!1!==e.write(t)||f||((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==$(i.pipes,e))&&!u&&(d(\"false write response, pause\",n._readableState.awaitDrain),n._readableState.awaitDrain++,f=!0),n.pause())}function m(t){d(\"onerror\",t),_(),e.removeListener(\"error\",m),0===o(e,\"error\")&&e.emit(\"error\",t)}function g(){e.removeListener(\"finish\",y),_()}function y(){d(\"onfinish\"),e.removeListener(\"close\",g),_()}function _(){d(\"unpipe\"),n.unpipe(e)}return n.on(\"data\",p),function(e,t,n){if(\"function\"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,\"error\",m),e.once(\"close\",g),e.once(\"finish\",y),e.emit(\"pipe\",n),i.flowing||(d(\"pipe resume\"),n.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit(\"unpipe\",this,n),this);if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)r[s].emit(\"unpipe\",this,n);return this}var o=$(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit(\"unpipe\",this,n),this)},_.prototype.on=function(e,t){var n=a.prototype.on.call(this,e,t);if(\"data\"===e)!1!==this._readableState.flowing&&this.resume();else if(\"readable\"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&k(this):r.nextTick(E,this))}return n},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var e=this._readableState;return e.flowing||(d(\"resume\"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(A,e,t))}(this,e)),this},_.prototype.pause=function(){return d(\"call pause flowing=%j\",this._readableState.flowing),!1!==this._readableState.flowing&&(d(\"pause\"),this._readableState.flowing=!1,this.emit(\"pause\")),this},_.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on(\"end\",function(){if(d(\"wrapped end\"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on(\"data\",function(i){(d(\"wrapped data\"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&\"function\"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<g.length;s++)e.on(g[s],this.emit.bind(this,g[s]));return this._read=function(t){d(\"wrapped _read\",t),r&&(r=!1,e.resume())},this},Object.defineProperty(_.prototype,\"readableHighWaterMark\",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=I},function(e,t,n){e.exports=n(3)},function(e,t,n){\"use strict\";var r=n(24);function i(e,t){e.emit(\"error\",t)}e.exports={destroy:function(e,t){var n=this,s=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return s||o?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){\"use strict\";var r=n(24);function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=g;var s,o=!process.browser&&[\"v0.10\",\"v0.9.\"].indexOf(process.version.slice(0,5))>-1?setImmediate:r.nextTick;g.WritableState=m;var a=n(17);a.inherits=n(18);var l={deprecate:n(94)},c=n(46),h=n(4).Buffer,u=global.Uint8Array||function(){};var d,f=n(47);function p(){}function m(e,t){s=s||n(13),e=e||{};var a=t instanceof s;this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var l=e.highWaterMark,c=e.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=l||0===l?l:a&&(c||0===c)?c:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===e.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=e.defaultEncoding||\"utf8\",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,s=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,s){--t.pendingcb,n?(r.nextTick(s,i),r.nextTick(S,e,t),e._writableState.errorEmitted=!0,e.emit(\"error\",i)):(s(i),e._writableState.errorEmitted=!0,e.emit(\"error\",i),S(e,t))}(e,n,i,t,s);else{var a=b(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||v(e,n),i?o(_,e,n,a,s):_(e,n,a,s)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function g(e){if(s=s||n(13),!(d.call(g,this)||this instanceof s))return new g(e);this._writableState=new m(e,this),this.writable=!0,e&&(\"function\"==typeof e.write&&(this._write=e.write),\"function\"==typeof e.writev&&(this._writev=e.writev),\"function\"==typeof e.destroy&&(this._destroy=e.destroy),\"function\"==typeof e.final&&(this._final=e.final)),c.call(this)}function y(e,t,n,r,i,s,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function _(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit(\"drain\"))}(e,t),t.pendingcb--,r(),S(e,t)}function v(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,s=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var a=0,l=!0;n;)s[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;s.allBuffers=l,y(e,t,!0,t.length,s,\"\",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,h=n.encoding,u=n.callback;if(y(e,t,!1,t.objectMode?1:c.length,c,h,u),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function b(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final(function(n){t.pendingcb--,n&&e.emit(\"error\",n),t.prefinished=!0,e.emit(\"prefinish\"),S(e,t)})}function S(e,t){var n=b(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||(\"function\"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,r.nextTick(w,e,t)):(t.prefinished=!0,e.emit(\"prefinish\")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit(\"finish\"))),n}a.inherits(g,c),m.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(m.prototype,\"buffer\",{get:l.deprecate(function(){return this.getBuffer()},\"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.\",\"DEP0003\")})}catch(e){}}(),\"function\"==typeof Symbol&&Symbol.hasInstance&&\"function\"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!d.call(this,e)||this===g&&(e&&e._writableState instanceof m)}})):d=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit(\"error\",new Error(\"Cannot pipe, not readable\"))},g.prototype.write=function(e,t,n){var i,s=this._writableState,o=!1,a=!s.objectMode&&(i=e,h.isBuffer(i)||i instanceof u);return a&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),\"function\"==typeof t&&(n=t,t=null),a?t=\"buffer\":t||(t=s.defaultEncoding),\"function\"!=typeof n&&(n=p),s.ended?function(e,t){var n=new Error(\"write after end\");e.emit(\"error\",n),r.nextTick(t,n)}(this,n):(a||function(e,t,n,i){var s=!0,o=!1;return null===n?o=new TypeError(\"May not write null values to stream\"):\"string\"==typeof n||void 0===n||t.objectMode||(o=new TypeError(\"Invalid non-string/buffer chunk\")),o&&(e.emit(\"error\",o),r.nextTick(i,o),s=!1),s}(this,s,e,n))&&(s.pendingcb++,o=function(e,t,n,r,i,s){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||\"string\"!=typeof t||(t=h.from(t,n));return t}(t,r,i);r!==o&&(n=!0,i=\"buffer\",r=o)}var a=t.objectMode?1:r.length;t.length+=a;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,a,r,i,s);return l}(this,s,a,e,t,n)),o},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||v(this,e))},g.prototype.setDefaultEncoding=function(e){if(\"string\"==typeof e&&(e=e.toLowerCase()),!([\"hex\",\"utf8\",\"utf-8\",\"ascii\",\"binary\",\"base64\",\"ucs2\",\"ucs-2\",\"utf16le\",\"utf-16le\",\"raw\"].indexOf((e+\"\").toLowerCase())>-1))throw new TypeError(\"Unknown encoding: \"+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,\"writableHighWaterMark\",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,n){n(new Error(\"_write() is not implemented\"))},g.prototype._writev=null,g.prototype.end=function(e,t,n){var i=this._writableState;\"function\"==typeof e?(n=e,e=null,t=null):\"function\"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,n){t.ending=!0,S(e,t),n&&(t.finished?r.nextTick(n):e.once(\"finish\",n));t.ended=!0,e.writable=!1}(this,i,n)},Object.defineProperty(g.prototype,\"destroyed\",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=f.destroy,g.prototype._undestroy=f.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)}},function(e,t,n){\"use strict\";var r=n(4).Buffer,i=r.isEncoding||function(e){switch((e=\"\"+e)&&e.toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":case\"raw\":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return\"utf8\";for(var t;;)switch(e){case\"utf8\":case\"utf-8\":return\"utf8\";case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return\"utf16le\";case\"latin1\":case\"binary\":return\"latin1\";case\"base64\":case\"ascii\":case\"hex\":return e;default:if(t)return;e=(\"\"+e).toLowerCase(),t=!0}}(e);if(\"string\"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error(\"Unknown encoding: \"+e);return t||e}(e),this.encoding){case\"utf16le\":this.text=l,this.end=c,t=4;break;case\"utf8\":this.fillLast=a,t=4;break;case\"base64\":this.text=h,this.end=u,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,\"�\";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,\"�\";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,\"�\"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString(\"utf16le\",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString(\"utf16le\",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):\"\";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString(\"utf16le\",0,n)}return t}function h(e,t){var n=(e.length-t)%3;return 0===n?e.toString(\"base64\",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString(\"base64\",t,e.length-n))}function u(e){var t=e&&e.length?this.write(e):\"\";return this.lastNeed?t+this.lastChar.toString(\"base64\",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):\"\"}t.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return\"\";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return\"\";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||\"\"},s.prototype.end=function(e){var t=e&&e.length?this.write(e):\"\";return this.lastNeed?t+\"�\":t},s.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=o(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=o(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=o(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString(\"utf8\",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString(\"utf8\",t,r)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){\"use strict\";e.exports=o;var r=n(13),i=n(17);function s(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit(\"error\",new Error(\"write callback called multiple times\"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);r.call(this,e),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(\"function\"==typeof e.transform&&(this._transform=e.transform),\"function\"==typeof e.flush&&(this._flush=e.flush)),this.on(\"prefinish\",a)}function a(){var e=this;\"function\"==typeof this._flush?this._flush(function(t,n){l(e,t,n)}):l(this,null,null)}function l(e,t,n){if(t)return e.emit(\"error\",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error(\"Calling transform done when ws.length != 0\");if(e._transformState.transforming)throw new Error(\"Calling transform done when still transforming\");return e.push(null)}i.inherits=n(18),i.inherits(o,r),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error(\"_transform() is not implemented\")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,function(e){t(e),n.emit(\"close\")})}},function(e,t,n){\"use strict\";var r=n(0),i=n(7),s=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";t.encode=function(e){for(var t,n,i,o,a,l,c,h=[],u=0,d=e.length,f=d,p=\"string\"!==r.getTypeOf(e);u<e.length;)f=d-u,p?(t=e[u++],n=u<d?e[u++]:0,i=u<d?e[u++]:0):(t=e.charCodeAt(u++),n=u<d?e.charCodeAt(u++):0,i=u<d?e.charCodeAt(u++):0),o=t>>2,a=(3&t)<<4|n>>4,l=f>1?(15&n)<<2|i>>6:64,c=f>2?63&i:64,h.push(s.charAt(o)+s.charAt(a)+s.charAt(l)+s.charAt(c));return h.join(\"\")},t.decode=function(e){var t,n,r,o,a,l,c=0,h=0;if(\"data:\"===e.substr(0,\"data:\".length))throw new Error(\"Invalid base64 input, it looks like a data url.\");var u,d=3*(e=e.replace(/[^A-Za-z0-9\\+\\/\\=]/g,\"\")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&d--,e.charAt(e.length-2)===s.charAt(64)&&d--,d%1!=0)throw new Error(\"Invalid base64 input, bad content length.\");for(u=i.uint8array?new Uint8Array(0|d):new Array(0|d);c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(o=s.indexOf(e.charAt(c++)))>>4,n=(15&o)<<4|(a=s.indexOf(e.charAt(c++)))>>2,r=(3&a)<<6|(l=s.indexOf(e.charAt(c++))),u[h++]=t,64!==a&&(u[h++]=n),64!==l&&(u[h++]=r);return u}},function(e,t,n){\"use strict\";var r=n(0),i=n(99),s=n(2),o=n(51),a=n(7),l=n(19),c=null;if(a.nodestream)try{c=n(100)}catch(e){}function h(e,t){return new l.Promise(function(n,i){var s=[],a=e._internalType,l=e._outputType,c=e._mimeType;e.on(\"data\",function(e,n){s.push(e),t&&t(n)}).on(\"error\",function(e){s=[],i(e)}).on(\"end\",function(){try{var e=function(e,t,n){switch(e){case\"blob\":return r.newBlob(r.transformTo(\"arraybuffer\",t),n);case\"base64\":return o.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,i=null,s=0;for(n=0;n<t.length;n++)s+=t[n].length;switch(e){case\"string\":return t.join(\"\");case\"array\":return Array.prototype.concat.apply([],t);case\"uint8array\":for(i=new Uint8Array(s),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case\"nodebuffer\":return Buffer.concat(t);default:throw new Error(\"concat : unsupported type '\"+e+\"'\")}}(a,s),c);n(e)}catch(e){i(e)}s=[]}).resume()})}function u(e,t,n){var o=t;switch(t){case\"blob\":case\"arraybuffer\":o=\"uint8array\";break;case\"base64\":o=\"string\"}try{this._internalType=o,this._outputType=t,this._mimeType=n,r.checkSupport(o),this._worker=e.pipe(new i(o)),e.lock()}catch(e){this._worker=new s(\"error\"),this._worker.error(e)}}u.prototype={accumulate:function(e){return h(this,e)},on:function(e,t){var n=this;return\"data\"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,n)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport(\"nodestream\"),\"nodebuffer\"!==this._outputType)throw new Error(this._outputType+\" is not supported by this method\");return new c(this,{objectMode:\"nodebuffer\"!==this._outputType},e)}},e.exports=u},function(e,t,n){\"use strict\";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},function(e,t,n){\"use strict\";var r=n(0),i=n(2);function s(e){i.call(this,\"DataWorker\");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type=\"\",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(s,i),s.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case\"string\":e=this.data.substring(this.index,t);break;case\"uint8array\":e=this.data.subarray(this.index,t);break;case\"array\":case\"nodebuffer\":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},function(e,t,n){\"use strict\";var r=n(0),i=n(2);function s(e){i.call(this,\"DataLengthProbe for \"+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(s,i),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},e.exports=s},function(e,t,n){\"use strict\";var r=n(2),i=n(32);function s(){r.call(this,\"Crc32Probe\"),this.withStreamInfo(\"crc32\",0)}n(0).inherits(s,r),s.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},e.exports=s},function(e,t,n){\"use strict\";var r=n(2);t.STORE={magic:\"\\0\\0\",compressWorker:function(e){return new r(\"STORE compression\")},uncompressWorker:function(){return new r(\"STORE decompression\")}},t.DEFLATE=n(103)},function(e,t,n){\"use strict\";e.exports=function(e,t,n,r){for(var i=65535&e|0,s=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{s=s+(i=i+t[r++]|0)|0}while(--o);i%=65521,s%=65521}return i|s<<16|0}},function(e,t,n){\"use strict\";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,i){var s=r,o=i+n;e^=-1;for(var a=i;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}},function(e,t,n){\"use strict\";var r=n(8),i=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var o=new r.Buf8(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&s||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n=\"\",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,t.string2buf=function(e){var t,n,i,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),o=0,s=0;o<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,r,i,s,a=t||e.length,c=new Array(2*a);for(r=0,n=0;n<a;)if((i=e[n++])<128)c[r++]=i;else if((s=o[i])>4)c[r++]=65533,n+=s-1;else{for(i&=2===s?31:3===s?15:7;s>1&&n<a;)i=i<<6|63&e[n++],s--;s>1?c[r++]=65533:i<65536?c[r++]=i:(i-=65536,c[r++]=55296|i>>10&1023,c[r++]=56320|1023&i)}return l(c,r)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+o[e[n]]>t?n:t}},function(e,t,n){\"use strict\";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\"\",this.state=null,this.data_type=2,this.adler=0}},function(e,t,n){\"use strict\";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,n){\"use strict\";t.LOCAL_FILE_HEADER=\"PK\u0003\u0004\",t.CENTRAL_FILE_HEADER=\"PK\u0001\u0002\",t.CENTRAL_DIRECTORY_END=\"PK\u0005\u0006\",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR=\"PK\u0006\u0007\",t.ZIP64_CENTRAL_DIRECTORY_END=\"PK\u0006\u0006\",t.DATA_DESCRIPTOR=\"PK\u0007\\b\"},function(e,t,n){\"use strict\";var r=n(0),i=n(7),s=n(65),o=n(117),a=n(118),l=n(67);e.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),\"string\"!==t||i.uint8array?\"nodebuffer\"===t?new a(e):i.uint8array?new l(r.transformTo(\"uint8array\",e)):new s(r.transformTo(\"array\",e)):new o(e)}},function(e,t,n){\"use strict\";var r=n(66);function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}n(0).inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===t&&this.data[s+1]===n&&this.data[s+2]===r&&this.data[s+3]===i)return s-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&n===s[1]&&r===s[2]&&i===s[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},function(e,t,n){\"use strict\";var r=n(0);function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error(\"End of data reached (data length = \"+this.length+\", asked index = \"+e+\"). Corrupted zip ?\")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo(\"string\",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},e.exports=i},function(e,t,n){\"use strict\";var r=n(65);function i(e){r.call(this,e)}n(0).inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},function(e,t){e.exports=require(\"assert\")},function(e,t){e.exports=require(\"vm\")},function(e,t,n){\"use strict\";const r=n(30),i=n(21),s=n(43),o=n(22),a=n(16),l=n(27),c=n(121),h=n(71),u=n(28),d=n(72),f=n(74),p=[\"CONNECTING\",\"OPEN\",\"CLOSING\",\"CLOSED\"],m=[8,13],g=3e4;class y extends r{constructor(e,t,n){super(),this.readyState=y.CONNECTING,this.protocol=\"\",this._binaryType=u.BINARY_TYPES[0],this._finalize=this.finalize.bind(this),this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=\"\",this._closeTimer=null,this._finalized=!1,this._closeCode=1006,this._extensions={},this._isServer=!0,this._receiver=null,this._sender=null,this._socket=null,this._error=null,null!==e&&(t?\"string\"==typeof t?t=[t]:Array.isArray(t)||(n=t,t=[]):t=[],function(e,t,n){if(n=Object.assign({protocolVersion:m[1],protocol:t.join(\",\"),perMessageDeflate:!0,handshakeTimeout:null,localAddress:null,headers:null,family:null,origin:null,agent:null,host:null,checkServerIdentity:null,rejectUnauthorized:null,passphrase:null,ciphers:null,ecdhCurve:null,cert:null,key:null,pfx:null,ca:null},n),-1===m.indexOf(n.protocolVersion))throw new RangeError(`Unsupported protocol version: ${n.protocolVersion} `+`(supported versions: ${m.join(\", \")})`);this._isServer=!1,this.url=e;const r=a.parse(e),c=\"ws+unix:\"===r.protocol;if(!(r.host||c&&r.path))throw new Error(`Invalid URL: ${e}`);const d=\"wss:\"===r.protocol||\"https:\"===r.protocol,f=i.randomBytes(16).toString(\"base64\"),p=d?s:o;var g;const _={port:r.port||(d?443:80),host:r.hostname,path:\"/\",headers:{\"Sec-WebSocket-Version\":n.protocolVersion,\"Sec-WebSocket-Key\":f,Connection:\"Upgrade\",Upgrade:\"websocket\"}};n.headers&&Object.assign(_.headers,n.headers);n.perMessageDeflate&&(g=new l(!0!==n.perMessageDeflate?n.perMessageDeflate:{},!1),_.headers[\"Sec-WebSocket-Extensions\"]=h.format({[l.extensionName]:g.offer()}));n.protocol&&(_.headers[\"Sec-WebSocket-Protocol\"]=n.protocol);n.origin&&(n.protocolVersion<13?_.headers[\"Sec-WebSocket-Origin\"]=n.origin:_.headers.Origin=n.origin);n.host&&(_.headers.Host=n.host);r.auth&&(_.auth=r.auth);n.localAddress&&(_.localAddress=n.localAddress);n.family&&(_.family=n.family);if(c){const e=r.path.split(\":\");_.socketPath=e[0],_.path=e[1]}else r.path&&(\"/\"!==r.path.charAt(0)?_.path=`/${r.path}`:_.path=r.path);var v=n.agent;(null!=n.rejectUnauthorized||n.checkServerIdentity||n.passphrase||n.ciphers||n.ecdhCurve||n.cert||n.key||n.pfx||n.ca)&&(n.passphrase&&(_.passphrase=n.passphrase),n.ciphers&&(_.ciphers=n.ciphers),n.ecdhCurve&&(_.ecdhCurve=n.ecdhCurve),n.cert&&(_.cert=n.cert),n.key&&(_.key=n.key),n.pfx&&(_.pfx=n.pfx),n.ca&&(_.ca=n.ca),n.checkServerIdentity&&(_.checkServerIdentity=n.checkServerIdentity),null!=n.rejectUnauthorized&&(_.rejectUnauthorized=n.rejectUnauthorized),v||(v=new p.Agent(_)));v&&(_.agent=v);this._req=p.get(_),n.handshakeTimeout&&this._req.setTimeout(n.handshakeTimeout,()=>{this._req.abort(),this.finalize(new Error(\"Opening handshake has timed out\"))});this._req.on(\"error\",e=>{this._req.aborted||(this._req=null,this.finalize(e))}),this._req.on(\"response\",e=>{this.emit(\"unexpected-response\",this._req,e)||(this._req.abort(),this.finalize(new Error(`Unexpected server response: ${e.statusCode}`)))}),this._req.on(\"upgrade\",(e,t,r)=>{if(this.emit(\"upgrade\",e),this.readyState!==y.CONNECTING)return;this._req=null;const s=i.createHash(\"sha1\").update(f+u.GUID,\"binary\").digest(\"base64\");if(e.headers[\"sec-websocket-accept\"]!==s)return t.destroy(),this.finalize(new Error(\"Invalid Sec-WebSocket-Accept header\"));const o=e.headers[\"sec-websocket-protocol\"],a=(n.protocol||\"\").split(/, */);var c;if(!n.protocol&&o?c=\"Server sent a subprotocol but none was requested\":n.protocol&&!o?c=\"Server sent no subprotocol\":o&&-1===a.indexOf(o)&&(c=\"Server sent an invalid subprotocol\"),c)return t.destroy(),this.finalize(new Error(c));if(o&&(this.protocol=o),g)try{const n=h.parse(e.headers[\"sec-websocket-extensions\"]);n[l.extensionName]&&(g.accept(n[l.extensionName]),this._extensions[l.extensionName]=g)}catch(e){return t.destroy(),void this.finalize(new Error(\"Invalid Sec-WebSocket-Extensions header\"))}this.setSocket(t,r,0)})}.call(this,e,t,n))}get CONNECTING(){return y.CONNECTING}get CLOSING(){return y.CLOSING}get CLOSED(){return y.CLOSED}get OPEN(){return y.OPEN}get binaryType(){return this._binaryType}set binaryType(e){u.BINARY_TYPES.indexOf(e)<0||(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?(this._socket.bufferSize||0)+this._sender._bufferedBytes:0}get extensions(){return Object.keys(this._extensions).join()}setSocket(e,t,n){e.setTimeout(0),e.setNoDelay(),e.on(\"close\",this._finalize),e.on(\"error\",this._finalize),e.on(\"end\",this._finalize),this._receiver=new d(this._extensions,n,this.binaryType),this._sender=new f(e,this._extensions),this._socket=e,t.length>0&&e.unshift(t),e.on(\"data\",this._receiver.add),this._receiver.onmessage=(e=>this.emit(\"message\",e)),this._receiver.onping=(e=>{this.pong(e,!this._isServer,u.NOOP),this.emit(\"ping\",e)}),this._receiver.onpong=(e=>this.emit(\"pong\",e)),this._receiver.onclose=((e,t)=>{this._socket.removeListener(\"data\",this._receiver.add),this._closeFrameReceived=!0,this._closeMessage=t,this._closeCode=e,1005===e?this.close():this.close(e,t)}),this._receiver.onerror=((e,t)=>{this._error||(this._closeCode=t,this._finalized?this.emit(\"error\",e):this.finalize(e))}),this.readyState=y.OPEN,this.emit(\"open\")}finalize(e){if(!this._finalized){if(this.readyState=y.CLOSING,this._finalized=!0,!this._socket)return this.emit(\"error\",e),this.readyState=y.CLOSED,void this.emit(\"close\",this._closeCode,this._closeMessage);clearTimeout(this._closeTimer),this._socket.removeListener(\"data\",this._receiver.add),this._socket.removeListener(\"close\",this._finalize),this._socket.removeListener(\"error\",this._finalize),this._socket.removeListener(\"end\",this._finalize),this._socket.on(\"error\",u.NOOP),e?(!0!==e&&(this._error=e),this._socket.destroy()):this._socket.end(),this._receiver.cleanup(()=>{const e=this._error;e&&(this._error=null,this.emit(\"error\",e)),this.readyState=y.CLOSED,this._extensions[l.extensionName]&&this._extensions[l.extensionName].cleanup(),this.emit(\"close\",this._closeCode,this._closeMessage)})}}close(e,t){if(this.readyState!==y.CLOSED)return this.readyState===y.CONNECTING?(this._req.abort(),void this.finalize(new Error(\"WebSocket was closed before the connection was established\"))):void(this.readyState!==y.CLOSING?(this.readyState=y.CLOSING,this._sender.close(e,t,!this._isServer,e=>{e||(this._closeFrameSent=!0,this._finalized||(this._closeFrameReceived&&this._socket.end(),this._closeTimer=setTimeout(this._finalize,g,!0)))})):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end())}ping(e,t,n){if(\"function\"==typeof e?(n=e,e=t=void 0):\"function\"==typeof t&&(n=t,t=void 0),this.readyState!==y.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${p[this.readyState]})`);if(n)return n(e);throw e}\"number\"==typeof e&&(e=e.toString()),void 0===t&&(t=!this._isServer),this._sender.ping(e||u.EMPTY_BUFFER,t,n)}pong(e,t,n){if(\"function\"==typeof e?(n=e,e=t=void 0):\"function\"==typeof t&&(n=t,t=void 0),this.readyState!==y.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${p[this.readyState]})`);if(n)return n(e);throw e}\"number\"==typeof e&&(e=e.toString()),void 0===t&&(t=!this._isServer),this._sender.pong(e||u.EMPTY_BUFFER,t,n)}send(e,t,n){if(\"function\"==typeof t&&(n=t,t={}),this.readyState!==y.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${p[this.readyState]})`);if(n)return n(e);throw e}\"number\"==typeof e&&(e=e.toString());const r=Object.assign({binary:\"string\"!=typeof e,mask:!this._isServer,compress:!0,fin:!0},t);this._extensions[l.extensionName]||(r.compress=!1),this._sender.send(e||u.EMPTY_BUFFER,r,n)}terminate(){if(this.readyState!==y.CLOSED)return this.readyState===y.CONNECTING?(this._req.abort(),void this.finalize(new Error(\"WebSocket was closed before the connection was established\"))):void this.finalize(!0)}}p.forEach((e,t)=>{y[p[t]]=t}),[\"open\",\"error\",\"close\",\"message\"].forEach(e=>{Object.defineProperty(y.prototype,`on${e}`,{get(){const t=this.listeners(e);for(var n=0;n<t.length;n++)if(t[n]._listener)return t[n]._listener},set(t){const n=this.listeners(e);for(var r=0;r<n.length;r++)n[r]._listener&&this.removeListener(e,n[r]);this.addEventListener(e,t)}})}),y.prototype.addEventListener=c.addEventListener,y.prototype.removeEventListener=c.removeEventListener,e.exports=y},function(e,t,n){\"use strict\";const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function i(e,t,n){Object.prototype.hasOwnProperty.call(e,t)?e[t].push(n):e[t]=[n]}e.exports={format:function(e){return Object.keys(e).map(t=>{var n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>[t].concat(Object.keys(e).map(t=>{var n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>!0===e?t:`${t}=${e}`).join(\"; \")})).join(\"; \")).join(\", \")}).join(\", \")},parse:function(e){const t={};if(void 0===e||\"\"===e)return t;for(var n,s,o={},a=!1,l=!1,c=!1,h=-1,u=-1,d=0;d<e.length;d++){const p=e.charCodeAt(d);if(void 0===n)if(-1===u&&1===r[p])-1===h&&(h=d);else if(32===p||9===p)-1===u&&-1!==h&&(u=d);else{if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===h)throw new SyntaxError(`Unexpected character at index ${d}`);-1===u&&(u=d);const r=e.slice(h,u);44===p?(i(t,r,o),o={}):n=r,h=u=-1}}else if(void 0===s)if(-1===u&&1===r[p])-1===h&&(h=d);else if(32===p||9===p)-1===u&&-1!==h&&(u=d);else if(59===p||44===p){if(-1===h)throw new SyntaxError(`Unexpected character at index ${d}`);-1===u&&(u=d),i(o,e.slice(h,u),!0),44===p&&(i(t,n,o),o={},n=void 0),h=u=-1}else{if(61!==p||-1===h||-1!==u)throw new SyntaxError(`Unexpected character at index ${d}`);s=e.slice(h,d),h=u=-1}else if(l){if(1!==r[p])throw new SyntaxError(`Unexpected character at index ${d}`);-1===h?h=d:a||(a=!0),l=!1}else if(c)if(1===r[p])-1===h&&(h=d);else if(34===p&&-1!==h)c=!1,u=d;else{if(92!==p)throw new SyntaxError(`Unexpected character at index ${d}`);l=!0}else if(34===p&&61===e.charCodeAt(d-1))c=!0;else if(-1===u&&1===r[p])-1===h&&(h=d);else if(-1===h||32!==p&&9!==p){if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${d}`);if(-1===h)throw new SyntaxError(`Unexpected character at index ${d}`);-1===u&&(u=d);var f=e.slice(h,u);a&&(f=f.replace(/\\\\/g,\"\"),a=!1),i(o,s,f),44===p&&(i(t,n,o),o={},n=void 0),s=void 0,h=u=-1}else-1===u&&(u=d)}if(-1===h||c)throw new SyntaxError(\"Unexpected end of input\");-1===u&&(u=d);const p=e.slice(h,u);return void 0===n?i(t,p,{}):(void 0===s?i(o,p,!0):i(o,s,a?p.replace(/\\\\/g,\"\"):p),i(t,n,o)),t}}},function(e,t,n){\"use strict\";const r=n(4),i=n(27),s=n(34),o=n(73),a=n(28),l=r.Buffer,c=0,h=1,u=2,d=3,f=4,p=5;function m(e,t){return 1===e.length?e[0]:e.length>1?s.concat(e,t):a.EMPTY_BUFFER}e.exports=class{constructor(e,t,n){this._binaryType=n||a.BINARY_TYPES[0],this._extensions=e||{},this._maxPayload=0|t,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._fragmented=0,this._masked=!1,this._fin=!1,this._mask=null,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._cleanupCallback=null,this._isCleaningUp=!1,this._hadError=!1,this._loop=!1,this.add=this.add.bind(this),this.onmessage=null,this.onclose=null,this.onerror=null,this.onping=null,this.onpong=null,this._state=c}consume(e){if(this._bufferedBytes<e)return this._loop=!1,this._isCleaningUp&&this.cleanup(this._cleanupCallback),null;if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=l.allocUnsafe(e);do{const n=this._buffers[0];e>=n.length?this._buffers.shift().copy(t,t.length-e):(n.copy(t,t.length-e,0,e),this._buffers[0]=n.slice(e)),e-=n.length}while(e>0);return t}add(e){this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop()}startLoop(){this._loop=!0;do{switch(this._state){case c:this.getInfo();break;case h:this.getPayloadLength16();break;case u:this.getPayloadLength64();break;case d:this.getMask();break;case f:this.getData();break;default:this._loop=!1}}while(this._loop)}getInfo(){const e=this.consume(2);if(null===e)return;if(0!=(48&e[0]))return void this.error(new RangeError(\"Invalid WebSocket frame: RSV2 and RSV3 must be clear\"),1002);const t=64==(64&e[0]);if(!t||this._extensions[i.extensionName]){if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return void this.error(new RangeError(\"Invalid WebSocket frame: RSV1 must be clear\"),1002);if(!this._fragmented)return void this.error(new RangeError(\"Invalid WebSocket frame: invalid opcode 0\"),1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void this.error(new RangeError(`Invalid WebSocket frame: invalid opcode ${this._opcode}`),1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return void this.error(new RangeError(`Invalid WebSocket frame: invalid opcode ${this._opcode}`),1002);if(!this._fin)return void this.error(new RangeError(\"Invalid WebSocket frame: FIN must be set\"),1002);if(t)return void this.error(new RangeError(\"Invalid WebSocket frame: RSV1 must be clear\"),1002);if(this._payloadLength>125)return void this.error(new RangeError(\"Invalid WebSocket frame: invalid payload length \"+`${this._payloadLength}`),1002)}this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),126===this._payloadLength?this._state=h:127===this._payloadLength?this._state=u:this.haveLength()}else this.error(new RangeError(\"Invalid WebSocket frame: RSV1 must be clear\"),1002)}getPayloadLength16(){const e=this.consume(2);null!==e&&(this._payloadLength=e.readUInt16BE(0,!0),this.haveLength())}getPayloadLength64(){const e=this.consume(8);if(null===e)return;const t=e.readUInt32BE(0,!0);t>Math.pow(2,21)-1?this.error(new RangeError(\"Unsupported WebSocket frame: payload length > 2^53 - 1\"),1009):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4,!0),this.haveLength())}haveLength(){this._opcode<8&&this.maxPayloadExceeded(this._payloadLength)||(this._masked?this._state=d:this._state=f)}getMask(){this._mask=this.consume(4),null!==this._mask&&(this._state=f)}getData(){var e=a.EMPTY_BUFFER;if(this._payloadLength){if(null===(e=this.consume(this._payloadLength)))return;this._masked&&s.unmask(e,this._mask)}this._opcode>7?this.controlMessage(e):this._compressed?(this._state=p,this.decompress(e)):this.pushFragment(e)&&this.dataMessage()}decompress(e){this._extensions[i.extensionName].decompress(e,this._fin,(e,t)=>{e?this.error(e,1009===e.closeCode?1009:1007):(this.pushFragment(t)&&this.dataMessage(),this.startLoop())})}dataMessage(){if(this._fin){const n=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){var e;e=\"nodebuffer\"===this._binaryType?m(r,n):\"arraybuffer\"===this._binaryType?0===(t=m(r,n)).byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength):r,this.onmessage(e)}else{const e=m(r,n);if(!o.isValidUTF8(e))return void this.error(new Error(\"Invalid WebSocket frame: invalid UTF-8 sequence\"),1007);this.onmessage(e.toString())}}var t;this._state=c}controlMessage(e){if(8!==this._opcode)9===this._opcode?this.onping(e):this.onpong(e),this._state=c;else if(0===e.length)this._loop=!1,this.onclose(1005,\"\"),this.cleanup(this._cleanupCallback);else if(1===e.length)this.error(new RangeError(\"Invalid WebSocket frame: invalid payload length 1\"),1002);else{const t=e.readUInt16BE(0,!0);if(!o.isValidStatusCode(t))return void this.error(new RangeError(`Invalid WebSocket frame: invalid status code ${t}`),1002);const n=e.slice(2);if(!o.isValidUTF8(n))return void this.error(new Error(\"Invalid WebSocket frame: invalid UTF-8 sequence\"),1007);this._loop=!1,this.onclose(t,n.toString()),this.cleanup(this._cleanupCallback)}}error(e,t){this._hadError=!0,this._loop=!1,this.onerror(e,t),this.cleanup(this._cleanupCallback)}maxPayloadExceeded(e){if(0===e||this._maxPayload<1)return!1;const t=this._totalPayloadLength+e;return t<=this._maxPayload?(this._totalPayloadLength=t,!1):(this.error(new RangeError(\"Max payload size exceeded\"),1009),!0)}pushFragment(e){if(0===e.length)return!0;const t=this._messageLength+e.length;return this._maxPayload<1||t<=this._maxPayload?(this._messageLength=t,this._fragments.push(e),!0):(this.error(new RangeError(\"Max payload size exceeded\"),1009),!1)}cleanup(e){if(null!==this._extensions){if(!this._hadError&&(this._loop||this._state===p))return this._cleanupCallback=e,void(this._isCleaningUp=!0);this._extensions=null,this._fragments=null,this._buffers=null,this._mask=null,this._cleanupCallback=null,this.onmessage=null,this.onclose=null,this.onerror=null,this.onping=null,this.onpong=null,e&&e()}else e&&e()}}},function(e,t,n){\"use strict\";try{const e=n(!function(){var e=new Error(\"Cannot find module 'utf-8-validate'\");throw e.code=\"MODULE_NOT_FOUND\",e}());t.isValidUTF8=\"object\"==typeof e?e.Validation.isValidUTF8:e}catch(e){t.isValidUTF8=(()=>!0)}t.isValidStatusCode=(e=>e>=1e3&&e<=1013&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999)},function(e,t,n){\"use strict\";const r=n(4),i=n(21),s=n(27),o=n(34),a=n(73),l=n(28),c=r.Buffer;class h{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const n=e.length<1024||t.mask&&t.readOnly;var r=t.mask?6:2,s=e.length;e.length>=65536?(r+=8,s=127):e.length>125&&(r+=2,s=126);const a=c.allocUnsafe(n?e.length+r:r);if(a[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(a[0]|=64),126===s?a.writeUInt16BE(e.length,2,!0):127===s&&(a.writeUInt32BE(0,2,!0),a.writeUInt32BE(e.length,6,!0)),!t.mask)return a[1]=s,n?(e.copy(a,r),[a]):[a,e];const l=i.randomBytes(4);return a[1]=128|s,a[r-4]=l[0],a[r-3]=l[1],a[r-2]=l[2],a[r-1]=l[3],n?(o.mask(e,l,a,r,e.length),[a]):(o.mask(e,l,e,0,e.length),[a,e])}close(e,t,n,r){var i;if(void 0===e)i=l.EMPTY_BUFFER;else{if(\"number\"!=typeof e||!a.isValidStatusCode(e))throw new TypeError(\"First argument must be a valid error code number\");void 0===t||\"\"===t?(i=c.allocUnsafe(2)).writeUInt16BE(e,0,!0):((i=c.allocUnsafe(2+c.byteLength(t))).writeUInt16BE(e,0,!0),i.write(t,2))}this._deflating?this.enqueue([this.doClose,i,n,r]):this.doClose(i,n,r)}doClose(e,t,n){this.sendFrame(h.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),n)}ping(e,t,n){var r=!0;c.isBuffer(e)||(e instanceof ArrayBuffer?e=c.from(e):ArrayBuffer.isView(e)?e=u(e):(e=c.from(e),r=!1)),this._deflating?this.enqueue([this.doPing,e,t,r,n]):this.doPing(e,t,r,n)}doPing(e,t,n,r){this.sendFrame(h.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:n}),r)}pong(e,t,n){var r=!0;c.isBuffer(e)||(e instanceof ArrayBuffer?e=c.from(e):ArrayBuffer.isView(e)?e=u(e):(e=c.from(e),r=!1)),this._deflating?this.enqueue([this.doPong,e,t,r,n]):this.doPong(e,t,r,n)}doPong(e,t,n,r){this.sendFrame(h.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:n}),r)}send(e,t,n){var r=t.binary?2:1,i=t.compress,o=!0;c.isBuffer(e)||(e instanceof ArrayBuffer?e=c.from(e):ArrayBuffer.isView(e)?e=u(e):(e=c.from(e),o=!1));const a=this._extensions[s.extensionName];if(this._firstFragment?(this._firstFragment=!1,i&&a&&(i=e.length>=a._threshold),this._compress=i):(i=!1,r=0),t.fin&&(this._firstFragment=!0),a){const s={fin:t.fin,rsv1:i,opcode:r,mask:t.mask,readOnly:o};this._deflating?this.enqueue([this.dispatch,e,this._compress,s,n]):this.dispatch(e,this._compress,s,n)}else this.sendFrame(h.frame(e,{fin:t.fin,rsv1:!1,opcode:r,mask:t.mask,readOnly:o}),n)}dispatch(e,t,n,r){if(!t)return void this.sendFrame(h.frame(e,n),r);const i=this._extensions[s.extensionName];this._deflating=!0,i.compress(e,n.fin,(e,t)=>{n.readOnly=!1,this.sendFrame(h.frame(t,n),r),this._deflating=!1,this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,e[0].apply(this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.write(e[0]),this._socket.write(e[1],t)):this._socket.write(e[0],t)}}function u(e){const t=c.from(e.buffer);return e.byteLength!==e.buffer.byteLength?t.slice(e.byteOffset,e.byteOffset+e.byteLength):t}e.exports=h},function(e,t,n){\"use strict\";e.exports=n(123)},function(e,t,n){\"use strict\";e.exports=function(e,t){var n=new Array(arguments.length-1),r=0,i=2,s=!0;for(;i<arguments.length;)n[r++]=arguments[i++];return new Promise(function(i,o){n[r]=function(e){if(s)if(s=!1,e)o(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){s&&(s=!1,o(e))}})}},function(module,exports,__webpack_require__){\"use strict\";function inquire(moduleName){try{var mod=eval(\"quire\".replace(/^/,\"re\"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){\"use strict\";t.Service=n(134)},function(e,t,n){\"use strict\";e.exports={}},function(e,t,n){\"use strict\";e.exports=function(e){for(var t,n=s.codegen([\"m\",\"w\"],e.name+\"$encode\")(\"if(!w)\")(\"w=Writer.create()\"),a=e.fieldsArray.slice().sort(s.compareFieldsById),l=0;l<a.length;++l){var c=a[l].resolve(),h=e._fieldsArray.indexOf(c),u=c.resolvedType instanceof r?\"int32\":c.type,d=i.basic[u];t=\"m\"+s.safeProp(c.name),c.map?(n(\"if(%s!=null&&m.hasOwnProperty(%j)){\",t,c.name)(\"for(var ks=Object.keys(%s),i=0;i<ks.length;++i){\",t)(\"w.uint32(%i).fork().uint32(%i).%s(ks[i])\",(c.id<<3|2)>>>0,8|i.mapKey[c.keyType],c.keyType),void 0===d?n(\"types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()\",h,t):n(\".uint32(%i).%s(%s[ks[i]]).ldelim()\",16|d,u,t),n(\"}\")(\"}\")):c.repeated?(n(\"if(%s!=null&&%s.length){\",t,t),c.packed&&void 0!==i.packed[u]?n(\"w.uint32(%i).fork()\",(c.id<<3|2)>>>0)(\"for(var i=0;i<%s.length;++i)\",t)(\"w.%s(%s[i])\",u,t)(\"w.ldelim()\"):(n(\"for(var i=0;i<%s.length;++i)\",t),void 0===d?o(n,c,h,t+\"[i]\"):n(\"w.uint32(%i).%s(%s[i])\",(c.id<<3|d)>>>0,u,t)),n(\"}\")):(c.optional&&n(\"if(%s!=null&&m.hasOwnProperty(%j))\",t,c.name),void 0===d?o(n,c,h,t):n(\"w.uint32(%i).%s(%s)\",(c.id<<3|d)>>>0,u,t))}return n(\"return w\")};var r=n(5),i=n(15),s=n(1);function o(e,t,n,r){return t.resolvedType.group?e(\"types[%i].encode(%s,w.uint32(%i)).uint32(%i)\",n,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e(\"types[%i].encode(%s,w.uint32(%i).fork()).ldelim()\",n,r,(t.id<<3|2)>>>0)}},function(e,t,n){\"use strict\";e.exports=function(e){var t=s.codegen([\"r\",\"l\"],e.name+\"$decode\")(\"if(!(r instanceof Reader))\")(\"r=Reader.create(r)\")(\"var c=l===undefined?r.len:r.pos+l,m=new this.ctor\"+(e.fieldsArray.filter(function(e){return e.map}).length?\",k\":\"\"))(\"while(r.pos<c){\")(\"var t=r.uint32()\");e.group&&t(\"if((t&7)===4)\")(\"break\");t(\"switch(t>>>3){\");for(var n=0;n<e.fieldsArray.length;++n){var a=e._fieldsArray[n].resolve(),l=a.resolvedType instanceof r?\"int32\":a.type,c=\"m\"+s.safeProp(a.name);t(\"case %i:\",a.id),a.map?(t(\"r.skip().pos++\")(\"if(%s===util.emptyObject)\",c)(\"%s={}\",c)(\"k=r.%s()\",a.keyType)(\"r.pos++\"),void 0!==i.long[a.keyType]?void 0===i.basic[l]?t('%s[typeof k===\"object\"?util.longToHash(k):k]=types[%i].decode(r,r.uint32())',c,n):t('%s[typeof k===\"object\"?util.longToHash(k):k]=r.%s()',c,l):void 0===i.basic[l]?t(\"%s[k]=types[%i].decode(r,r.uint32())\",c,n):t(\"%s[k]=r.%s()\",c,l)):a.repeated?(t(\"if(!(%s&&%s.length))\",c,c)(\"%s=[]\",c),void 0!==i.packed[l]&&t(\"if((t&7)===2){\")(\"var c2=r.uint32()+r.pos\")(\"while(r.pos<c2)\")(\"%s.push(r.%s())\",c,l)(\"}else\"),void 0===i.basic[l]?t(a.resolvedType.group?\"%s.push(types[%i].decode(r))\":\"%s.push(types[%i].decode(r,r.uint32()))\",c,n):t(\"%s.push(r.%s())\",c,l)):void 0===i.basic[l]?t(a.resolvedType.group?\"%s=types[%i].decode(r)\":\"%s=types[%i].decode(r,r.uint32())\",c,n):t(\"%s=r.%s()\",c,l),t(\"break\")}for(t(\"default:\")(\"r.skipType(t&7)\")(\"break\")(\"}\")(\"}\"),n=0;n<e._fieldsArray.length;++n){var h=e._fieldsArray[n];h.required&&t(\"if(!m.hasOwnProperty(%j))\",h.name)(\"throw util.ProtocolError(%j,{instance:m})\",o(h))}return t(\"return m\")};var r=n(5),i=n(15),s=n(1);function o(e){return\"missing required '\"+e.name+\"'\"}},function(e,t,n){\"use strict\";e.exports=function(e){var t=i.codegen([\"m\"],e.name+\"$verify\")('if(typeof m!==\"object\"||m===null)')(\"return%j\",\"object expected\"),n=e.oneofsArray,r={};n.length&&t(\"var p={}\");for(var l=0;l<e.fieldsArray.length;++l){var c=e._fieldsArray[l].resolve(),h=\"m\"+i.safeProp(c.name);if(c.optional&&t(\"if(%s!=null&&m.hasOwnProperty(%j)){\",h,c.name),c.map)t(\"if(!util.isObject(%s))\",h)(\"return%j\",s(c,\"object\"))(\"var k=Object.keys(%s)\",h)(\"for(var i=0;i<k.length;++i){\"),a(t,c,\"k[i]\"),o(t,c,l,h+\"[k[i]]\")(\"}\");else if(c.repeated)t(\"if(!Array.isArray(%s))\",h)(\"return%j\",s(c,\"array\"))(\"for(var i=0;i<%s.length;++i){\",h),o(t,c,l,h+\"[i]\")(\"}\");else{if(c.partOf){var u=i.safeProp(c.partOf.name);1===r[c.partOf.name]&&t(\"if(p%s===1)\",u)(\"return%j\",c.partOf.name+\": multiple values\"),r[c.partOf.name]=1,t(\"p%s=1\",u)}o(t,c,l,h)}c.optional&&t(\"}\")}return t(\"return null\")};var r=n(5),i=n(1);function s(e,t){return e.name+\": \"+t+(e.repeated&&\"array\"!==t?\"[]\":e.map&&\"object\"!==t?\"{k:\"+e.keyType+\"}\":\"\")+\" expected\"}function o(e,t,n,i){if(t.resolvedType)if(t.resolvedType instanceof r){e(\"switch(%s){\",i)(\"default:\")(\"return%j\",s(t,\"enum value\"));for(var o=Object.keys(t.resolvedType.values),a=0;a<o.length;++a)e(\"case %i:\",t.resolvedType.values[o[a]]);e(\"break\")(\"}\")}else e(\"{\")(\"var e=types[%i].verify(%s);\",n,i)(\"if(e)\")(\"return%j+e\",t.name+\".\")(\"}\");else switch(t.type){case\"int32\":case\"uint32\":case\"sint32\":case\"fixed32\":case\"sfixed32\":e(\"if(!util.isInteger(%s))\",i)(\"return%j\",s(t,\"integer\"));break;case\"int64\":case\"uint64\":case\"sint64\":case\"fixed64\":case\"sfixed64\":e(\"if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))\",i,i,i,i)(\"return%j\",s(t,\"integer|Long\"));break;case\"float\":case\"double\":e('if(typeof %s!==\"number\")',i)(\"return%j\",s(t,\"number\"));break;case\"bool\":e('if(typeof %s!==\"boolean\")',i)(\"return%j\",s(t,\"boolean\"));break;case\"string\":e(\"if(!util.isString(%s))\",i)(\"return%j\",s(t,\"string\"));break;case\"bytes\":e('if(!(%s&&typeof %s.length===\"number\"||util.isString(%s)))',i,i,i)(\"return%j\",s(t,\"buffer\"))}return e}function a(e,t,n){switch(t.keyType){case\"int32\":case\"uint32\":case\"sint32\":case\"fixed32\":case\"sfixed32\":e(\"if(!util.key32Re.test(%s))\",n)(\"return%j\",s(t,\"integer key\"));break;case\"int64\":case\"uint64\":case\"sint64\":case\"fixed64\":case\"sfixed64\":e(\"if(!util.key64Re.test(%s))\",n)(\"return%j\",s(t,\"integer|Long key\"));break;case\"bool\":e(\"if(!util.key2Re.test(%s))\",n)(\"return%j\",s(t,\"boolean key\"))}return e}},function(e,t,n){\"use strict\";var r=t,i=n(5),s=n(1);function o(e,t,n,r){if(t.resolvedType)if(t.resolvedType instanceof i){e(\"switch(d%s){\",r);for(var s=t.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)t.repeated&&s[o[a]]===t.typeDefault&&e(\"default:\"),e(\"case%j:\",o[a])(\"case %i:\",s[o[a]])(\"m%s=%j\",r,s[o[a]])(\"break\");e(\"}\")}else e('if(typeof d%s!==\"object\")',r)(\"throw TypeError(%j)\",t.fullName+\": object expected\")(\"m%s=types[%i].fromObject(d%s)\",r,n,r);else{var l=!1;switch(t.type){case\"double\":case\"float\":e(\"m%s=Number(d%s)\",r,r);break;case\"uint32\":case\"fixed32\":e(\"m%s=d%s>>>0\",r,r);break;case\"int32\":case\"sint32\":case\"sfixed32\":e(\"m%s=d%s|0\",r,r);break;case\"uint64\":l=!0;case\"int64\":case\"sint64\":case\"fixed64\":case\"sfixed64\":e(\"if(util.Long)\")(\"(m%s=util.Long.fromValue(d%s)).unsigned=%j\",r,r,l)('else if(typeof d%s===\"string\")',r)(\"m%s=parseInt(d%s,10)\",r,r)('else if(typeof d%s===\"number\")',r)(\"m%s=d%s\",r,r)('else if(typeof d%s===\"object\")',r)(\"m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)\",r,r,r,l?\"true\":\"\");break;case\"bytes\":e('if(typeof d%s===\"string\")',r)(\"util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)\",r,r,r)(\"else if(d%s.length)\",r)(\"m%s=d%s\",r,r);break;case\"string\":e(\"m%s=String(d%s)\",r,r);break;case\"bool\":e(\"m%s=Boolean(d%s)\",r,r)}}return e}function a(e,t,n,r){if(t.resolvedType)t.resolvedType instanceof i?e(\"d%s=o.enums===String?types[%i].values[m%s]:m%s\",r,n,r,r):e(\"d%s=types[%i].toObject(m%s,o)\",r,n,r);else{var s=!1;switch(t.type){case\"double\":case\"float\":e(\"d%s=o.json&&!isFinite(m%s)?String(m%s):m%s\",r,r,r,r);break;case\"uint64\":s=!0;case\"int64\":case\"sint64\":case\"fixed64\":case\"sfixed64\":e('if(typeof m%s===\"number\")',r)(\"d%s=o.longs===String?String(m%s):m%s\",r,r,r)(\"else\")(\"d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s\",r,r,r,r,s?\"true\":\"\",r);break;case\"bytes\":e(\"d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s\",r,r,r,r,r);break;default:e(\"d%s=m%s\",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,n=s.codegen([\"d\"],e.name+\"$fromObject\")(\"if(d instanceof this.ctor)\")(\"return d\");if(!t.length)return n(\"return new this.ctor\");n(\"var m=new this.ctor\");for(var r=0;r<t.length;++r){var a=t[r].resolve(),l=s.safeProp(a.name);a.map?(n(\"if(d%s){\",l)('if(typeof d%s!==\"object\")',l)(\"throw TypeError(%j)\",a.fullName+\": object expected\")(\"m%s={}\",l)(\"for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){\",l),o(n,a,r,l+\"[ks[i]]\")(\"}\")(\"}\")):a.repeated?(n(\"if(d%s){\",l)(\"if(!Array.isArray(d%s))\",l)(\"throw TypeError(%j)\",a.fullName+\": array expected\")(\"m%s=[]\",l)(\"for(var i=0;i<d%s.length;++i){\",l),o(n,a,r,l+\"[i]\")(\"}\")(\"}\")):(a.resolvedType instanceof i||n(\"if(d%s!=null){\",l),o(n,a,r,l),a.resolvedType instanceof i||n(\"}\"))}return n(\"return m\")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(s.compareFieldsById);if(!t.length)return s.codegen()(\"return {}\");for(var n=s.codegen([\"m\",\"o\"],e.name+\"$toObject\")(\"if(!o)\")(\"o={}\")(\"var d={}\"),r=[],o=[],l=[],c=0;c<t.length;++c)t[c].partOf||(t[c].resolve().repeated?r:t[c].map?o:l).push(t[c]);if(r.length){for(n(\"if(o.arrays||o.defaults){\"),c=0;c<r.length;++c)n(\"d%s=[]\",s.safeProp(r[c].name));n(\"}\")}if(o.length){for(n(\"if(o.objects||o.defaults){\"),c=0;c<o.length;++c)n(\"d%s={}\",s.safeProp(o[c].name));n(\"}\")}if(l.length){for(n(\"if(o.defaults){\"),c=0;c<l.length;++c){var h=l[c],u=s.safeProp(h.name);if(h.resolvedType instanceof i)n(\"d%s=o.enums===String?%j:%j\",u,h.resolvedType.valuesById[h.typeDefault],h.typeDefault);else if(h.long)n(\"if(util.Long){\")(\"var n=new util.Long(%i,%i,%j)\",h.typeDefault.low,h.typeDefault.high,h.typeDefault.unsigned)(\"d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n\",u)(\"}else\")(\"d%s=o.longs===String?%j:%i\",u,h.typeDefault.toString(),h.typeDefault.toNumber());else if(h.bytes){var d=\"[\"+Array.prototype.slice.call(h.typeDefault).join(\",\")+\"]\";n(\"if(o.bytes===String)d%s=%j\",u,String.fromCharCode.apply(String,h.typeDefault))(\"else{\")(\"d%s=%s\",u,d)(\"if(o.bytes!==Array)d%s=util.newBuffer(d%s)\",u,u)(\"}\")}else n(\"d%s=%j\",u,h.typeDefault)}n(\"}\")}var f=!1;for(c=0;c<t.length;++c){h=t[c];var p=e._fieldsArray.indexOf(h);u=s.safeProp(h.name);h.map?(f||(f=!0,n(\"var ks2\")),n(\"if(m%s&&(ks2=Object.keys(m%s)).length){\",u,u)(\"d%s={}\",u)(\"for(var j=0;j<ks2.length;++j){\"),a(n,h,p,u+\"[ks2[j]]\")(\"}\")):h.repeated?(n(\"if(m%s&&m%s.length){\",u,u)(\"d%s=[]\",u)(\"for(var j=0;j<m%s.length;++j){\",u),a(n,h,p,u+\"[j]\")(\"}\")):(n(\"if(m%s!=null&&m.hasOwnProperty(%j)){\",u,h.name),a(n,h,p,u),h.partOf&&n(\"if(o.oneofs)\")(\"d%s=%j\",s.safeProp(h.partOf.name),h.name)),n(\"}\")}return n(\"return d\")}},function(e,t,n){\"use strict\";var r=t,i=n(41);r[\".google.protobuf.Any\"]={fromObject:function(e){if(e&&e[\"@type\"]){var t=this.lookup(e[\"@type\"]);if(t){var n=\".\"===e[\"@type\"].charAt(0)?e[\"@type\"].substr(1):e[\"@type\"];return this.create({type_url:\"/\"+n,value:t.encode(t.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){if(t&&t.json&&e.type_url&&e.value){var n=e.type_url.substring(e.type_url.lastIndexOf(\"/\")+1),r=this.lookup(n);r&&(e=r.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var s=e.$type.toObject(e,t);return s[\"@type\"]=e.$type.fullName,s}return this.toObject(e,t)}}},function(e,t,n){\"use strict\";e.exports=f;var r=/[\\s{}=;:[\\],'\"()<>]/g,i=/(?:\"([^\"\\\\]*(?:\\\\.[^\"\\\\]*)*)\")/g,s=/(?:'([^'\\\\]*(?:\\\\.[^'\\\\]*)*)')/g,o=/^ *[*\\/]+ */,a=/^\\s*\\*?\\/*/,l=/\\n/g,c=/\\s/,h=/\\\\(.?)/g,u={0:\"\\0\",r:\"\\r\",n:\"\\n\",t:\"\\t\"};function d(e){return e.replace(h,function(e,t){switch(t){case\"\\\\\":case\"\":return t;default:return u[t]||\"\"}})}function f(e,t){e=e.toString();var n=0,h=e.length,u=1,f=null,p=null,m=0,g=!1,y=[],_=null;function v(e){return Error(\"illegal \"+e+\" (line \"+u+\")\")}function b(t){return e.charAt(t)}function w(n,r){f=e.charAt(n++),m=u,g=!1;var i,s=n-(t?2:3);do{if(--s<0||\"\\n\"===(i=e.charAt(s))){g=!0;break}}while(\" \"===i||\"\\t\"===i);for(var c=e.substring(n,r).split(l),h=0;h<c.length;++h)c[h]=c[h].replace(t?a:o,\"\").trim();p=c.join(\"\\n\").trim()}function S(t){var n=k(t),r=e.substring(t,n);return/^\\s*\\/{1,2}/.test(r)}function k(e){for(var t=e;t<h&&\"\\n\"!==b(t);)t++;return t}function C(){if(y.length>0)return y.shift();if(_)return function(){var t=\"'\"===_?s:i;t.lastIndex=n-1;var r=t.exec(e);if(!r)throw v(\"string\");return n=t.lastIndex,x(_),_=null,d(r[1])}();var o,a,l,f,p;do{if(n===h)return null;for(o=!1;c.test(l=b(n));)if(\"\\n\"===l&&++u,++n===h)return null;if(\"/\"===b(n)){if(++n===h)throw v(\"comment\");if(\"/\"===b(n))if(t){if(f=n,p=!1,S(n)){p=!0;do{if((n=k(n))===h)break;n++}while(S(n))}else n=Math.min(h,k(n)+1);p&&w(f,n),u++,o=!0}else{for(p=\"/\"===b(f=n+1);\"\\n\"!==b(++n);)if(n===h)return null;++n,p&&w(f,n-1),++u,o=!0}else{if(\"*\"!==(l=b(n)))return\"/\";f=n+1,p=t||\"*\"===b(f);do{if(\"\\n\"===l&&++u,++n===h)throw v(\"comment\");a=l,l=b(n)}while(\"*\"!==a||\"/\"!==l);++n,p&&w(f,n-2),o=!0}}}while(o);var m=n;if(r.lastIndex=0,!r.test(b(m++)))for(;m<h&&!r.test(b(m));)++m;var g=e.substring(n,n=m);return'\"'!==g&&\"'\"!==g||(_=g),g}function x(e){y.push(e)}function T(){if(!y.length){var e=C();if(null===e)return null;x(e)}return y[0]}return Object.defineProperty({next:C,peek:T,push:x,skip:function(e,t){var n=T();if(n===e)return C(),!0;if(!t)throw v(\"token '\"+n+\"', '\"+e+\"' expected\");return!1},cmnt:function(e){var n=null;return void 0===e?m===u-1&&(t||\"*\"===f||g)&&(n=p):(m<e&&T(),m!==e||g||!t&&\"/\"!==f||(n=p)),n}},\"line\",{get:function(){return u}})}f.unescape=d},function(e,t){function n(e){return\"number\"==typeof e||(!!/^0x[0-9a-f]+$/i.test(e)||/^[-+]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(e[-+]?\\d+)?$/.test(e))}e.exports=function(e,t){t||(t={});var r={bools:{},strings:{},unknownFn:null};\"function\"==typeof t.unknown&&(r.unknownFn=t.unknown),\"boolean\"==typeof t.boolean&&t.boolean?r.allBools=!0:[].concat(t.boolean).filter(Boolean).forEach(function(e){r.bools[e]=!0});var i={};Object.keys(t.alias||{}).forEach(function(e){i[e]=[].concat(t.alias[e]),i[e].forEach(function(t){i[t]=[e].concat(i[e].filter(function(e){return t!==e}))})}),[].concat(t.string).filter(Boolean).forEach(function(e){r.strings[e]=!0,i[e]&&(r.strings[i[e]]=!0)});var s=t.default||{},o={_:[]};Object.keys(r.bools).forEach(function(e){l(e,void 0!==s[e]&&s[e])});var a=[];function l(e,t,s){if(!s||!r.unknownFn||function(e,t){return r.allBools&&/^--[^=]+$/.test(t)||r.strings[e]||r.bools[e]||i[e]}(e,s)||!1!==r.unknownFn(s)){var a=!r.strings[e]&&n(t)?Number(t):t;c(o,e.split(\".\"),a),(i[e]||[]).forEach(function(e){c(o,e.split(\".\"),a)})}}function c(e,t,n){var i=e;t.slice(0,-1).forEach(function(e){void 0===i[e]&&(i[e]={}),i=i[e]});var s=t[t.length-1];void 0===i[s]||r.bools[s]||\"boolean\"==typeof i[s]?i[s]=n:Array.isArray(i[s])?i[s].push(n):i[s]=[i[s],n]}function h(e){return i[e].some(function(e){return r.bools[e]})}-1!==e.indexOf(\"--\")&&(a=e.slice(e.indexOf(\"--\")+1),e=e.slice(0,e.indexOf(\"--\")));for(var u=0;u<e.length;u++){var d=e[u];if(/^--.+=/.test(d)){var f=d.match(/^--([^=]+)=([\\s\\S]*)$/),p=f[1],m=f[2];r.bools[p]&&(m=\"false\"!==m),l(p,m,d)}else if(/^--no-.+/.test(d)){l(p=d.match(/^--no-(.+)/)[1],!1,d)}else if(/^--.+/.test(d)){p=d.match(/^--(.+)/)[1];void 0===(v=e[u+1])||/^-/.test(v)||r.bools[p]||r.allBools||i[p]&&h(p)?/^(true|false)$/.test(v)?(l(p,\"true\"===v,d),u++):l(p,!r.strings[p]||\"\",d):(l(p,v,d),u++)}else if(/^-[^-]+/.test(d)){for(var g=d.slice(1,-1).split(\"\"),y=!1,_=0;_<g.length;_++){var v;if(\"-\"!==(v=d.slice(_+2))){if(/[A-Za-z]/.test(g[_])&&/=/.test(v)){l(g[_],v.split(\"=\")[1],d),y=!0;break}if(/[A-Za-z]/.test(g[_])&&/-?\\d+(\\.\\d*)?(e-?\\d+)?$/.test(v)){l(g[_],v,d),y=!0;break}if(g[_+1]&&g[_+1].match(/\\W/)){l(g[_],d.slice(_+2),d),y=!0;break}l(g[_],!r.strings[g[_]]||\"\",d)}else l(g[_],v,d)}p=d.slice(-1)[0];y||\"-\"===p||(!e[u+1]||/^(-|--)[^-]/.test(e[u+1])||r.bools[p]||i[p]&&h(p)?e[u+1]&&/true|false/.test(e[u+1])?(l(p,\"true\"===e[u+1],d),u++):l(p,!r.strings[p]||\"\",d):(l(p,e[u+1],d),u++))}else if(r.unknownFn&&!1===r.unknownFn(d)||o._.push(r.strings._||!n(d)?d:Number(d)),t.stopEarly){o._.push.apply(o._,e.slice(u+1));break}}return Object.keys(s).forEach(function(e){var t,n,r;t=o,n=e.split(\".\"),r=t,n.slice(0,-1).forEach(function(e){r=r[e]||{}}),n[n.length-1]in r||(c(o,e.split(\".\"),s[e]),(i[e]||[]).forEach(function(t){c(o,t.split(\".\"),s[e])}))}),t[\"--\"]?(o[\"--\"]=new Array,a.forEach(function(e){o[\"--\"].push(e)})):a.forEach(function(e){o._.push(e)}),o}},function(e,t,n){\"use strict\";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error(\"The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.\");this.files={},this.comment=null,this.root=\"\",this.clone=function(){var e=new r;for(var t in this)\"function\"!=typeof this[t]&&(e[t]=this[t]);return e}}r.prototype=n(89),r.prototype.loadAsync=n(115),r.support=n(7),r.defaults=n(53),r.version=\"3.2.0\",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=n(19),e.exports=r},function(e,t,n){\"use strict\";const r=n(70);r.Server=n(122),r.Receiver=n(72),r.Sender=n(74),e.exports=r},function(e,t,n){\"use strict\";var r=n(12),i=n(0),s=n(2),o=n(52),a=n(53),l=n(31),c=n(101),h=n(102),u=n(26),d=n(114),f=function(e,t,n){var r,o=i.getTypeOf(t),h=i.extend(n||{},a);h.date=h.date||new Date,null!==h.compression&&(h.compression=h.compression.toUpperCase()),\"string\"==typeof h.unixPermissions&&(h.unixPermissions=parseInt(h.unixPermissions,8)),h.unixPermissions&&16384&h.unixPermissions&&(h.dir=!0),h.dosPermissions&&16&h.dosPermissions&&(h.dir=!0),h.dir&&(e=m(e)),h.createFolders&&(r=p(e))&&g.call(this,r,!0);var f=\"string\"===o&&!1===h.binary&&!1===h.base64;n&&void 0!==n.binary||(h.binary=!f),(t instanceof l&&0===t.uncompressedSize||h.dir||!t||0===t.length)&&(h.base64=!1,h.binary=!0,t=\"\",h.compression=\"STORE\",o=\"string\");var y=null;y=t instanceof l||t instanceof s?t:u.isNode&&u.isStream(t)?new d(e,t):i.prepareContent(e,t,h.binary,h.optimizedBinaryString,h.base64);var _=new c(e,y,h);this.files[e]=_},p=function(e){\"/\"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf(\"/\");return t>0?e.substring(0,t):\"\"},m=function(e){return\"/\"!==e.slice(-1)&&(e+=\"/\"),e},g=function(e,t){return t=void 0!==t?t:a.createFolders,e=m(e),this.files[e]||f.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)}var _={load:function(){throw new Error(\"This method has been removed in JSZip 3.0, please check the upgrade guide.\")},forEach:function(e){var t,n,r;for(t in this.files)this.files.hasOwnProperty(t)&&(r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r))},filter:function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(r)}),t},file:function(e,t,n){if(1===arguments.length){if(y(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}var i=this.files[this.root+e];return i&&!i.dir?i:null}return e=this.root+e,f.call(this,e,t,n),this},folder:function(e){if(!e)return this;if(y(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||(\"/\"!==e.slice(-1)&&(e+=\"/\"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(e){throw new Error(\"This method has been removed in JSZip 3.0, please check the upgrade guide.\")},generateInternalStream:function(e){var t,n={};try{if((n=i.extend(e||{},{streamFiles:!1,compression:\"STORE\",compressionOptions:null,type:\"\",platform:\"DOS\",comment:null,mimeType:\"application/zip\",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),\"binarystring\"===n.type&&(n.type=\"string\"),!n.type)throw new Error(\"No output type specified.\");i.checkSupport(n.type),\"darwin\"!==n.platform&&\"freebsd\"!==n.platform&&\"linux\"!==n.platform&&\"sunos\"!==n.platform||(n.platform=\"UNIX\"),\"win32\"===n.platform&&(n.platform=\"DOS\");var a=n.comment||this.comment||\"\";t=h.generateWorker(this,n,a)}catch(e){(t=new s(\"error\")).error(e)}return new o(t,n.type||\"string\",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type=\"nodebuffer\"),this.generateInternalStream(e).toNodejsStream(t)}};e.exports=_},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return\"[object Array]\"==n.call(e)}},function(e,t){e.exports=require(\"buffer\")},function(e,t){\"function\"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){\"use strict\";var r=n(4).Buffer,i=n(25);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return\"\";for(var t=this.head,n=\"\"+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t,n,i,s=r.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,n=s,i=a,t.copy(n,i),a+=o.data.length,o=o.next;return s},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+\" \"+e})},function(e,t,n){e.exports=n(25).deprecate},function(e,t,n){\"use strict\";e.exports=s;var r=n(50),i=n(17);function s(e){if(!(this instanceof s))return new s(e);r.call(this,e)}i.inherits=n(18),i.inherits(s,r),s.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){\"use strict\";e.exports=\"function\"==typeof setImmediate?setImmediate:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},function(e,t,n){\"use strict\";var r=n(98);function i(){}var s={},o=[\"REJECTED\"],a=[\"FULFILLED\"],l=[\"PENDING\"];if(!process.browser)var c=[\"UNHANDLED\"];function h(e){if(\"function\"!=typeof e)throw new TypeError(\"resolver must be a function\");this.state=l,this.queue=[],this.outcome=void 0,process.browser||(this.handled=c),e!==i&&p(this,e)}function u(e,t,n){this.promise=e,\"function\"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),\"function\"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r(function(){var r;try{r=t(n)}catch(t){return s.reject(e,t)}r===e?s.reject(e,new TypeError(\"Cannot resolve promise with itself\")):s.resolve(e,r)})}function f(e){var t=e&&e.then;if(e&&(\"object\"==typeof e||\"function\"==typeof e)&&\"function\"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,s.reject(e,t))}function i(t){n||(n=!0,s.resolve(e,t))}var o=m(function(){t(i,r)});\"error\"===o.status&&r(o.value)}function m(e,t){var n={};try{n.value=e(t),n.status=\"success\"}catch(e){n.status=\"error\",n.value=e}return n}e.exports=h,h.prototype.finally=function(e){if(\"function\"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},h.prototype.catch=function(e){return this.then(null,e)},h.prototype.then=function(e,t){if(\"function\"!=typeof e&&this.state===a||\"function\"!=typeof t&&this.state===o)return this;var n=new this.constructor(i);(process.browser||this.handled===c&&(this.handled=null),this.state!==l)?d(n,this.state===a?e:t,this.outcome):this.queue.push(new u(n,e,t));return n},u.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){s.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},s.resolve=function(e,t){var n=m(f,t);if(\"error\"===n.status)return s.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=a,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},s.reject=function(e,t){e.state=o,e.outcome=t,process.browser||e.handled===c&&r(function(){e.handled===c&&process.emit(\"unhandledRejection\",t,e)});for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},h.resolve=function(e){if(e instanceof this)return e;return s.resolve(new this(i),e)},h.reject=function(e){var t=new this(i);return s.reject(t,e)},h.all=function(e){var t=this;if(\"[object Array]\"!==Object.prototype.toString.call(e))return this.reject(new TypeError(\"must be an array\"));var n=e.length,r=!1;if(!n)return this.resolve([]);var o=new Array(n),a=0,l=-1,c=new this(i);for(;++l<n;)h(e[l],l);return c;function h(e,i){t.resolve(e).then(function(e){o[i]=e,++a!==n||r||(r=!0,s.resolve(c,o))},function(e){r||(r=!0,s.reject(c,e))})}},h.race=function(e){var t=this;if(\"[object Array]\"!==Object.prototype.toString.call(e))return this.reject(new TypeError(\"must be an array\"));var n=e.length,r=!1;if(!n)return this.resolve([]);var o=-1,a=new this(i);for(;++o<n;)l=e[o],t.resolve(l).then(function(e){r||(r=!0,s.resolve(a,e))},function(e){r||(r=!0,s.reject(a,e))});var l;return a}},function(e,t,n){\"use strict\";var r,i,s=global.MutationObserver||global.WebKitMutationObserver;if(process.browser)if(s){var o=0,a=new s(u),l=global.document.createTextNode(\"\");a.observe(l,{characterData:!0}),r=function(){l.data=o=++o%2}}else if(global.setImmediate||void 0===global.MessageChannel)r=\"document\"in global&&\"onreadystatechange\"in global.document.createElement(\"script\")?function(){var e=global.document.createElement(\"script\");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var c=new global.MessageChannel;c.port1.onmessage=u,r=function(){c.port2.postMessage(0)}}else r=function(){process.nextTick(u)};var h=[];function u(){var e,t;i=!0;for(var n=h.length;n;){for(t=h,h=[],e=-1;++e<n;)t[e]();n=h.length}i=!1}e.exports=function(e){1!==h.push(e)||i||r()}},function(e,t,n){\"use strict\";var r=n(2),i=n(0);function s(e){r.call(this,\"ConvertWorker to \"+e),this.destType=e}i.inherits(s,r),s.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},e.exports=s},function(e,t,n){\"use strict\";var r=n(44).Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on(\"data\",function(e,t){i.push(e)||i._helper.pause(),n&&n(t)}).on(\"error\",function(e){i.emit(\"error\",e)}).on(\"end\",function(){i.push(null)})}n(0).inherits(i,r),i.prototype._read=function(){this._helper.resume()},e.exports=i},function(e,t,n){\"use strict\";var r=n(52),i=n(54),s=n(12),o=n(31),a=n(2),l=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};l.prototype={internalStream:function(e){var t=null,n=\"string\";try{if(!e)throw new Error(\"No output type specified.\");var i=\"string\"===(n=e.toLowerCase())||\"text\"===n;\"binarystring\"!==n&&\"text\"!==n||(n=\"string\"),t=this._decompressWorker();var o=!this._dataBinary;o&&!i&&(t=t.pipe(new s.Utf8EncodeWorker)),!o&&i&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new a(\"error\")).error(e)}return new r(t,n,\"\")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||\"nodebuffer\").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),o.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof a?this._data:new i(this._data)}};for(var c=[\"asText\",\"asBinary\",\"asNodeBuffer\",\"asUint8Array\",\"asArrayBuffer\"],h=function(){throw new Error(\"This method has been removed in JSZip 3.0, please check the upgrade guide.\")},u=0;u<c.length;u++)l.prototype[c[u]]=h;e.exports=l},function(e,t,n){\"use strict\";var r=n(57),i=n(113);t.generateWorker=function(e,t,n){var s=new i(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+\" is not a valid compression method !\");return i}(n.options.compression,t.compression),a=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(i,a).withStreamInfo(\"file\",{name:e,dir:l,date:c,comment:n.comment||\"\",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(s)}),s.entriesCount=o}catch(e){s.error(e)}return s}},function(e,t,n){\"use strict\";var r=\"undefined\"!=typeof Uint8Array&&\"undefined\"!=typeof Uint16Array&&\"undefined\"!=typeof Uint32Array,i=n(104),s=n(0),o=n(2),a=r?\"uint8array\":\"array\";function l(e,t){o.call(this,\"FlateWorker/\"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}t.magic=\"\\b\\0\",s.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(a,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},t.compressWorker=function(e){return new l(\"Deflate\",e)},t.uncompressWorker=function(){return new l(\"Inflate\",{})}},function(e,t,n){\"use strict\";var r={};(0,n(8).assign)(r,n(105),n(108),n(62)),e.exports=r},function(e,t,n){\"use strict\";var r=n(106),i=n(8),s=n(60),o=n(33),a=n(61),l=Object.prototype.toString,c=0,h=-1,u=0,d=8;function f(e){if(!(this instanceof f))return new f(e);this.options=i.assign({level:h,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:\"\"},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var p;if(p=\"string\"==typeof t.dictionary?s.string2buf(t.dictionary):\"[object ArrayBuffer]\"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,p))!==c)throw new Error(o[n]);this._dict_set=!0}}function p(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}f.prototype.push=function(e,t){var n,o,a=this.strm,h=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,\"string\"==typeof e?a.input=s.string2buf(e):\"[object ArrayBuffer]\"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new i.Buf8(h),a.next_out=0,a.avail_out=h),1!==(n=r.deflate(a,o))&&n!==c)return this.onEnd(n),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==o&&2!==o)||(\"string\"===this.options.to?this.onData(s.buf2binstring(i.shrinkBuf(a.output,a.next_out))):this.onData(i.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==o||(this.onEnd(c),a.avail_out=0,!0)},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===c&&(\"string\"===this.options.to?this.result=this.chunks.join(\"\"):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=f,t.deflate=p,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,p(e,t)}},function(e,t,n){\"use strict\";var r,i=n(8),s=n(107),o=n(58),a=n(59),l=n(33),c=0,h=1,u=3,d=4,f=5,p=0,m=1,g=-2,y=-3,_=-5,v=-1,b=1,w=2,S=3,k=4,C=0,x=2,T=8,E=9,A=15,O=8,I=286,R=30,N=19,$=2*I+1,P=15,j=3,B=258,M=B+j+1,D=32,z=42,F=69,L=73,U=91,H=103,q=113,W=666,V=1,K=2,Z=3,J=4,G=3;function Y(e,t){return e.msg=l[t],t}function X(e){return(e<<1)-(e>4?9:0)}function Q(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function te(e,t){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function ne(e,t){e.pending_buf[e.pending++]=t}function re(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function ie(e,t){var n,r,i=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-M?e.strstart-(e.w_size-M):0,c=e.window,h=e.w_mask,u=e.prev,d=e.strstart+B,f=c[s+o-1],p=c[s+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(c[(n=t)+o]===p&&c[n+o-1]===f&&c[n]===c[s]&&c[++n]===c[s+1]){s+=2,n++;do{}while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<d);if(r=B-(d-s),s=d-B,r>o){if(e.match_start=t,o=r,r>=a)break;f=c[s+o-1],p=c[s+o]}}}while((t=u[t&h])>l&&0!=--i);return o<=e.lookahead?o:e.lookahead}function se(e){var t,n,r,s,l,c,h,u,d,f,p=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-M)){i.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=p?r-p:0}while(--n);t=n=p;do{r=e.prev[--t],e.prev[t]=r>=p?r-p:0}while(--n);s+=p}if(0===e.strm.avail_in)break;if(c=e.strm,h=e.window,u=e.strstart+e.lookahead,d=s,f=void 0,(f=c.avail_in)>d&&(f=d),n=0===f?0:(c.avail_in-=f,i.arraySet(h,c.input,c.next_in,f,u),1===c.state.wrap?c.adler=o(c.adler,h,f,u):2===c.state.wrap&&(c.adler=a(c.adler,h,f,u)),c.next_in+=f,c.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=j)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+j-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<j)););}while(e.lookahead<M&&0!==e.strm.avail_in)}function oe(e,t){for(var n,r;;){if(e.lookahead<M){if(se(e),e.lookahead<M&&t===c)return V;if(0===e.lookahead)break}if(n=0,e.lookahead>=j&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-M&&(e.match_length=ie(e,n)),e.match_length>=j)if(r=s._tr_tally(e,e.strstart-e.match_start,e.match_length-j),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=j){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(te(e,!1),0===e.strm.avail_out))return V}return e.insert=e.strstart<j-1?e.strstart:j-1,t===d?(te(e,!0),0===e.strm.avail_out?Z:J):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?V:K}function ae(e,t){for(var n,r,i;;){if(e.lookahead<M){if(se(e),e.lookahead<M&&t===c)return V;if(0===e.lookahead)break}if(n=0,e.lookahead>=j&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=j-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-M&&(e.match_length=ie(e,n),e.match_length<=5&&(e.strategy===b||e.match_length===j&&e.strstart-e.match_start>4096)&&(e.match_length=j-1)),e.prev_length>=j&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-j,r=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-j),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+j-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=j-1,e.strstart++,r&&(te(e,!1),0===e.strm.avail_out))return V}else if(e.match_available){if((r=s._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return V}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<j-1?e.strstart:j-1,t===d?(te(e,!0),0===e.strm.avail_out?Z:J):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?V:K}function le(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function ce(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*$),this.dyn_dtree=new i.Buf16(2*(2*R+1)),this.bl_tree=new i.Buf16(2*(2*N+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(P+1),this.heap=new i.Buf16(2*I+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*I+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function he(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=x,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?z:q,e.adler=2===t.wrap?0:1,t.last_flush=c,s._tr_init(t),p):Y(e,g)}function ue(e){var t,n=he(e);return n===p&&((t=e.state).window_size=2*t.w_size,Q(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=j-1,t.match_available=0,t.ins_h=0),n}function de(e,t,n,r,s,o){if(!e)return g;var a=1;if(t===v&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),s<1||s>E||n!==T||r<8||r>15||t<0||t>9||o<0||o>k)return Y(e,g);8===r&&(r=9);var l=new ce;return e.state=l,l.strm=e,l.wrap=a,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+j-1)/j),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,ue(e)}r=[new le(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(se(e),0===e.lookahead&&t===c)return V;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,te(e,!1),0===e.strm.avail_out))return V;if(e.strstart-e.block_start>=e.w_size-M&&(te(e,!1),0===e.strm.avail_out))return V}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?Z:J):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),V)}),new le(4,4,8,4,oe),new le(4,5,16,8,oe),new le(4,6,32,32,oe),new le(4,4,16,16,ae),new le(8,16,32,32,ae),new le(8,16,128,128,ae),new le(8,32,128,256,ae),new le(32,128,258,1024,ae),new le(32,258,258,4096,ae)],t.deflateInit=function(e,t){return de(e,t,T,A,O,C)},t.deflateInit2=de,t.deflateReset=ue,t.deflateResetKeep=he,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?g:(e.state.gzhead=t,p):g},t.deflate=function(e,t){var n,i,o,l;if(!e||!e.state||t>f||t<0)return e?Y(e,g):g;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===W&&t!==d)return Y(e,0===e.avail_out?_:g);if(i.strm=e,n=i.last_flush,i.last_flush=t,i.status===z)if(2===i.wrap)e.adler=0,ne(i,31),ne(i,139),ne(i,8),i.gzhead?(ne(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ne(i,255&i.gzhead.time),ne(i,i.gzhead.time>>8&255),ne(i,i.gzhead.time>>16&255),ne(i,i.gzhead.time>>24&255),ne(i,9===i.level?2:i.strategy>=w||i.level<2?4:0),ne(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(ne(i,255&i.gzhead.extra.length),ne(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=a(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=F):(ne(i,0),ne(i,0),ne(i,0),ne(i,0),ne(i,0),ne(i,9===i.level?2:i.strategy>=w||i.level<2?4:0),ne(i,G),i.status=q);else{var y=T+(i.w_bits-8<<4)<<8;y|=(i.strategy>=w||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(y|=D),y+=31-y%31,i.status=q,re(i,y),0!==i.strstart&&(re(i,e.adler>>>16),re(i,65535&e.adler)),e.adler=1}if(i.status===F)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=a(e.adler,i.pending_buf,i.pending-o,o)),ee(e),o=i.pending,i.pending!==i.pending_buf_size));)ne(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=a(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=L)}else i.status=L;if(i.status===L)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=a(e.adler,i.pending_buf,i.pending-o,o)),ee(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,ne(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=a(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.gzindex=0,i.status=U)}else i.status=U;if(i.status===U)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=a(e.adler,i.pending_buf,i.pending-o,o)),ee(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,ne(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=a(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.status=H)}else i.status=H;if(i.status===H&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&ee(e),i.pending+2<=i.pending_buf_size&&(ne(i,255&e.adler),ne(i,e.adler>>8&255),e.adler=0,i.status=q)):i.status=q),0!==i.pending){if(ee(e),0===e.avail_out)return i.last_flush=-1,p}else if(0===e.avail_in&&X(t)<=X(n)&&t!==d)return Y(e,_);if(i.status===W&&0!==e.avail_in)return Y(e,_);if(0!==e.avail_in||0!==i.lookahead||t!==c&&i.status!==W){var v=i.strategy===w?function(e,t){for(var n;;){if(0===e.lookahead&&(se(e),0===e.lookahead)){if(t===c)return V;break}if(e.match_length=0,n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(te(e,!1),0===e.strm.avail_out))return V}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?Z:J):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?V:K}(i,t):i.strategy===S?function(e,t){for(var n,r,i,o,a=e.window;;){if(e.lookahead<=B){if(se(e),e.lookahead<=B&&t===c)return V;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=j&&e.strstart>0&&(r=a[i=e.strstart-1])===a[++i]&&r===a[++i]&&r===a[++i]){o=e.strstart+B;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<o);e.match_length=B-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=j?(n=s._tr_tally(e,1,e.match_length-j),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(te(e,!1),0===e.strm.avail_out))return V}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?Z:J):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?V:K}(i,t):r[i.level].func(i,t);if(v!==Z&&v!==J||(i.status=W),v===V||v===Z)return 0===e.avail_out&&(i.last_flush=-1),p;if(v===K&&(t===h?s._tr_align(i):t!==f&&(s._tr_stored_block(i,0,0,!1),t===u&&(Q(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),ee(e),0===e.avail_out))return i.last_flush=-1,p}return t!==d?p:i.wrap<=0?m:(2===i.wrap?(ne(i,255&e.adler),ne(i,e.adler>>8&255),ne(i,e.adler>>16&255),ne(i,e.adler>>24&255),ne(i,255&e.total_in),ne(i,e.total_in>>8&255),ne(i,e.total_in>>16&255),ne(i,e.total_in>>24&255)):(re(i,e.adler>>>16),re(i,65535&e.adler)),ee(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?p:m)},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==z&&t!==F&&t!==L&&t!==U&&t!==H&&t!==q&&t!==W?Y(e,g):(e.state=null,t===q?Y(e,y):p):g},t.deflateSetDictionary=function(e,t){var n,r,s,a,l,c,h,u,d=t.length;if(!e||!e.state)return g;if(2===(a=(n=e.state).wrap)||1===a&&n.status!==z||n.lookahead)return g;for(1===a&&(e.adler=o(e.adler,t,d,0)),n.wrap=0,d>=n.w_size&&(0===a&&(Q(n.head),n.strstart=0,n.block_start=0,n.insert=0),u=new i.Buf8(n.w_size),i.arraySet(u,t,d-n.w_size,n.w_size,0),t=u,d=n.w_size),l=e.avail_in,c=e.next_in,h=e.input,e.avail_in=d,e.next_in=0,e.input=t,se(n);n.lookahead>=j;){r=n.strstart,s=n.lookahead-(j-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+j-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--s);n.strstart=r,n.lookahead=j-1,se(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=j-1,n.match_available=0,e.next_in=c,e.input=h,e.avail_in=l,n.wrap=a,p},t.deflateInfo=\"pako deflate (from Nodeca project)\"},function(e,t,n){\"use strict\";var r=n(8),i=4,s=0,o=1,a=2;function l(e){for(var t=e.length;--t>=0;)e[t]=0}var c=0,h=1,u=2,d=29,f=256,p=f+1+d,m=30,g=19,y=2*p+1,_=15,v=16,b=7,w=256,S=16,k=17,C=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=new Array(2*(p+2));l(O);var I=new Array(2*m);l(I);var R=new Array(512);l(R);var N=new Array(256);l(N);var $=new Array(d);l($);var P,j,B,M=new Array(m);function D(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function z(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function F(e){return e<256?R[e]:R[256+(e>>>7)]}function L(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function U(e,t,n){e.bi_valid>v-n?(e.bi_buf|=t<<e.bi_valid&65535,L(e,e.bi_buf),e.bi_buf=t>>v-e.bi_valid,e.bi_valid+=n-v):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function H(e,t,n){U(e,n[2*t],n[2*t+1])}function q(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function W(e,t,n){var r,i,s=new Array(_+1),o=0;for(r=1;r<=_;r++)s[r]=o=o+n[r-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=q(s[a]++,a))}}function V(e){var t;for(t=0;t<p;t++)e.dyn_ltree[2*t]=0;for(t=0;t<m;t++)e.dyn_dtree[2*t]=0;for(t=0;t<g;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*w]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function K(e){e.bi_valid>8?L(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Z(e,t,n,r){var i=2*t,s=2*n;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]}function J(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&Z(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Z(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function G(e,t,n){var r,i,s,o,a=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],i=e.pending_buf[e.l_buf+a],a++,0===r?H(e,i,t):(H(e,(s=N[i])+f+1,t),0!==(o=x[s])&&U(e,i-=$[s],o),H(e,s=F(--r),n),0!==(o=T[s])&&U(e,r-=M[s],o))}while(a<e.last_lit);H(e,w,t)}function Y(e,t){var n,r,i,s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=y,n=0;n<l;n++)0!==s[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):s[2*n+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=o[2*i+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)J(e,s,n);i=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],J(e,s,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,s[2*i]=s[2*n]+s[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,s[2*n+1]=s[2*r+1]=i,e.heap[1]=i++,J(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,s,o,a,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,u=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(s=0;s<=_;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<y;n++)(s=l[2*l[2*(r=e.heap[n])+1]+1]+1)>p&&(s=p,m++),l[2*r+1]=s,r>c||(e.bl_count[s]++,o=0,r>=f&&(o=d[r-f]),a=l[2*r],e.opt_len+=a*(s+o),u&&(e.static_len+=a*(h[2*r+1]+o)));if(0!==m){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(s=p;0!==s;s--)for(r=e.bl_count[s];0!==r;)(i=e.heap[--n])>c||(l[2*i+1]!==s&&(e.opt_len+=(s-l[2*i+1])*l[2*i],l[2*i+1]=s),r--)}}(e,t),W(s,c,e.bl_count)}function X(e,t,n){var r,i,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++a<l&&i===o||(a<c?e.bl_tree[2*i]+=a:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[2*S]++):a<=10?e.bl_tree[2*k]++:e.bl_tree[2*C]++,a=0,s=i,0===o?(l=138,c=3):i===o?(l=6,c=3):(l=7,c=4))}function Q(e,t,n){var r,i,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++a<l&&i===o)){if(a<c)do{H(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==s&&(H(e,i,e.bl_tree),a--),H(e,S,e.bl_tree),U(e,a-3,2)):a<=10?(H(e,k,e.bl_tree),U(e,a-3,3)):(H(e,C,e.bl_tree),U(e,a-11,7));a=0,s=i,0===o?(l=138,c=3):i===o?(l=6,c=3):(l=7,c=4)}}l(M);var ee=!1;function te(e,t,n,i){U(e,(c<<1)+(i?1:0),3),function(e,t,n,i){K(e),i&&(L(e,n),L(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){ee||(function(){var e,t,n,r,i,s=new Array(_+1);for(n=0,r=0;r<d-1;r++)for($[r]=n,e=0;e<1<<x[r];e++)N[n++]=r;for(N[n-1]=r,i=0,r=0;r<16;r++)for(M[r]=i,e=0;e<1<<T[r];e++)R[i++]=r;for(i>>=7;r<m;r++)for(M[r]=i<<7,e=0;e<1<<T[r]-7;e++)R[256+i++]=r;for(t=0;t<=_;t++)s[t]=0;for(e=0;e<=143;)O[2*e+1]=8,e++,s[8]++;for(;e<=255;)O[2*e+1]=9,e++,s[9]++;for(;e<=279;)O[2*e+1]=7,e++,s[7]++;for(;e<=287;)O[2*e+1]=8,e++,s[8]++;for(W(O,p+1,s),e=0;e<m;e++)I[2*e+1]=5,I[2*e]=q(e,5);P=new D(O,x,f+1,p,_),j=new D(I,T,0,m,_),B=new D(new Array(0),E,0,g,b)}(),ee=!0),e.l_desc=new z(e.dyn_ltree,P),e.d_desc=new z(e.dyn_dtree,j),e.bl_desc=new z(e.bl_tree,B),e.bi_buf=0,e.bi_valid=0,V(e)},t._tr_stored_block=te,t._tr_flush_block=function(e,t,n,r){var l,c,d=0;e.level>0?(e.strm.data_type===a&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return s;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<f;t++)if(0!==e.dyn_ltree[2*t])return o;return s}(e)),Y(e,e.l_desc),Y(e,e.d_desc),d=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),Y(e,e.bl_desc),t=g-1;t>=3&&0===e.bl_tree[2*A[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),l=e.opt_len+3+7>>>3,(c=e.static_len+3+7>>>3)<=l&&(l=c)):l=c=n+5,n+4<=l&&-1!==t?te(e,t,n,r):e.strategy===i||c===l?(U(e,(h<<1)+(r?1:0),3),G(e,O,I)):(U(e,(u<<1)+(r?1:0),3),function(e,t,n,r){var i;for(U(e,t-257,5),U(e,n-1,5),U(e,r-4,4),i=0;i<r;i++)U(e,e.bl_tree[2*A[i]+1],3);Q(e,e.dyn_ltree,t-1),Q(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,d+1),G(e,e.dyn_ltree,e.dyn_dtree)),V(e),r&&K(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(N[n]+f+1)]++,e.dyn_dtree[2*F(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){U(e,h<<1,3),H(e,w,O),function(e){16===e.bi_valid?(L(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,n){\"use strict\";var r=n(109),i=n(8),s=n(60),o=n(62),a=n(33),l=n(61),c=n(112),h=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:\"\"},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(a[n]);if(this.header=new c,r.inflateGetHeader(this.strm,this.header),t.dictionary&&(\"string\"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):\"[object ArrayBuffer]\"===h.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary))!==o.Z_OK))throw new Error(a[n])}function d(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}u.prototype.push=function(e,t){var n,a,l,c,u,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,\"string\"==typeof e?d.input=s.binstring2buf(e):\"[object ArrayBuffer]\"===h.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(f),d.next_out=0,d.avail_out=f),(n=r.inflate(d,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&p&&(n=r.inflateSetDictionary(this.strm,p)),n===o.Z_BUF_ERROR&&!0===m&&(n=o.Z_OK,m=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&n!==o.Z_STREAM_END&&(0!==d.avail_in||a!==o.Z_FINISH&&a!==o.Z_SYNC_FLUSH)||(\"string\"===this.options.to?(l=s.utf8border(d.output,d.next_out),c=d.next_out-l,u=s.buf2string(d.output,l),d.next_out=c,d.avail_out=f-c,c&&i.arraySet(d.output,d.output,l,c,0),this.onData(u)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(a=o.Z_FINISH),a===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):a!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),d.avail_out=0,!0)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===o.Z_OK&&(\"string\"===this.options.to?this.result=this.chunks.join(\"\"):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=u,t.inflate=d,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},t.ungzip=d},function(e,t,n){\"use strict\";var r=n(8),i=n(58),s=n(59),o=n(110),a=n(111),l=0,c=1,h=2,u=4,d=5,f=6,p=0,m=1,g=2,y=-2,_=-3,v=-4,b=-5,w=8,S=1,k=2,C=3,x=4,T=5,E=6,A=7,O=8,I=9,R=10,N=11,$=12,P=13,j=14,B=15,M=16,D=17,z=18,F=19,L=20,U=21,H=22,q=23,W=24,V=25,K=26,Z=27,J=28,G=29,Y=30,X=31,Q=32,ee=852,te=592,ne=15;function re(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function ie(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function se(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=\"\",t.wrap&&(e.adler=1&t.wrap),t.mode=S,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(ee),t.distcode=t.distdyn=new r.Buf32(te),t.sane=1,t.back=-1,p):y}function oe(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,se(e)):y}function ae(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?y:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,oe(e))):y}function le(e,t){var n,r;return e?(r=new ie,e.state=r,r.window=null,(n=ae(e,t))!==p&&(e.state=null),n):y}var ce,he,ue=!0;function de(e){if(ue){var t;for(ce=new r.Buf32(512),he=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(c,e.lens,0,288,ce,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(h,e.lens,0,32,he,0,e.work,{bits:5}),ue=!1}e.lencode=ce,e.lenbits=9,e.distcode=he,e.distbits=5}function fe(e,t,n,i){var s,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((s=o.wsize-o.wnext)>i&&(s=i),r.arraySet(o.window,t,n-i,s,o.wnext),(i-=s)?(r.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}t.inflateReset=oe,t.inflateReset2=ae,t.inflateResetKeep=se,t.inflateInit=function(e){return le(e,ne)},t.inflateInit2=le,t.inflate=function(e,t){var n,ee,te,ne,ie,se,oe,ae,le,ce,he,ue,pe,me,ge,ye,_e,ve,be,we,Se,ke,Ce,xe,Te=0,Ee=new r.Buf8(4),Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return y;(n=e.state).mode===$&&(n.mode=P),ie=e.next_out,te=e.output,oe=e.avail_out,ne=e.next_in,ee=e.input,se=e.avail_in,ae=n.hold,le=n.bits,ce=se,he=oe,ke=p;e:for(;;)switch(n.mode){case S:if(0===n.wrap){n.mode=P;break}for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(2&n.wrap&&35615===ae){n.check=0,Ee[0]=255&ae,Ee[1]=ae>>>8&255,n.check=s(n.check,Ee,2,0),ae=0,le=0,n.mode=k;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&ae)<<8)+(ae>>8))%31){e.msg=\"incorrect header check\",n.mode=Y;break}if((15&ae)!==w){e.msg=\"unknown compression method\",n.mode=Y;break}if(le-=4,Se=8+(15&(ae>>>=4)),0===n.wbits)n.wbits=Se;else if(Se>n.wbits){e.msg=\"invalid window size\",n.mode=Y;break}n.dmax=1<<Se,e.adler=n.check=1,n.mode=512&ae?R:$,ae=0,le=0;break;case k:for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(n.flags=ae,(255&n.flags)!==w){e.msg=\"unknown compression method\",n.mode=Y;break}if(57344&n.flags){e.msg=\"unknown header flags set\",n.mode=Y;break}n.head&&(n.head.text=ae>>8&1),512&n.flags&&(Ee[0]=255&ae,Ee[1]=ae>>>8&255,n.check=s(n.check,Ee,2,0)),ae=0,le=0,n.mode=C;case C:for(;le<32;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.head&&(n.head.time=ae),512&n.flags&&(Ee[0]=255&ae,Ee[1]=ae>>>8&255,Ee[2]=ae>>>16&255,Ee[3]=ae>>>24&255,n.check=s(n.check,Ee,4,0)),ae=0,le=0,n.mode=x;case x:for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.head&&(n.head.xflags=255&ae,n.head.os=ae>>8),512&n.flags&&(Ee[0]=255&ae,Ee[1]=ae>>>8&255,n.check=s(n.check,Ee,2,0)),ae=0,le=0,n.mode=T;case T:if(1024&n.flags){for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.length=ae,n.head&&(n.head.extra_len=ae),512&n.flags&&(Ee[0]=255&ae,Ee[1]=ae>>>8&255,n.check=s(n.check,Ee,2,0)),ae=0,le=0}else n.head&&(n.head.extra=null);n.mode=E;case E:if(1024&n.flags&&((ue=n.length)>se&&(ue=se),ue&&(n.head&&(Se=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,ee,ne,ue,Se)),512&n.flags&&(n.check=s(n.check,ee,ue,ne)),se-=ue,ne+=ue,n.length-=ue),n.length))break e;n.length=0,n.mode=A;case A:if(2048&n.flags){if(0===se)break e;ue=0;do{Se=ee[ne+ue++],n.head&&Se&&n.length<65536&&(n.head.name+=String.fromCharCode(Se))}while(Se&&ue<se);if(512&n.flags&&(n.check=s(n.check,ee,ue,ne)),se-=ue,ne+=ue,Se)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=O;case O:if(4096&n.flags){if(0===se)break e;ue=0;do{Se=ee[ne+ue++],n.head&&Se&&n.length<65536&&(n.head.comment+=String.fromCharCode(Se))}while(Se&&ue<se);if(512&n.flags&&(n.check=s(n.check,ee,ue,ne)),se-=ue,ne+=ue,Se)break e}else n.head&&(n.head.comment=null);n.mode=I;case I:if(512&n.flags){for(;le<16;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(ae!==(65535&n.check)){e.msg=\"header crc mismatch\",n.mode=Y;break}ae=0,le=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=$;break;case R:for(;le<32;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}e.adler=n.check=re(ae),ae=0,le=0,n.mode=N;case N:if(0===n.havedict)return e.next_out=ie,e.avail_out=oe,e.next_in=ne,e.avail_in=se,n.hold=ae,n.bits=le,g;e.adler=n.check=1,n.mode=$;case $:if(t===d||t===f)break e;case P:if(n.last){ae>>>=7&le,le-=7&le,n.mode=Z;break}for(;le<3;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}switch(n.last=1&ae,le-=1,3&(ae>>>=1)){case 0:n.mode=j;break;case 1:if(de(n),n.mode=L,t===f){ae>>>=2,le-=2;break e}break;case 2:n.mode=D;break;case 3:e.msg=\"invalid block type\",n.mode=Y}ae>>>=2,le-=2;break;case j:for(ae>>>=7&le,le-=7&le;le<32;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if((65535&ae)!=(ae>>>16^65535)){e.msg=\"invalid stored block lengths\",n.mode=Y;break}if(n.length=65535&ae,ae=0,le=0,n.mode=B,t===f)break e;case B:n.mode=M;case M:if(ue=n.length){if(ue>se&&(ue=se),ue>oe&&(ue=oe),0===ue)break e;r.arraySet(te,ee,ne,ue,ie),se-=ue,ne+=ue,oe-=ue,ie+=ue,n.length-=ue;break}n.mode=$;break;case D:for(;le<14;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(n.nlen=257+(31&ae),ae>>>=5,le-=5,n.ndist=1+(31&ae),ae>>>=5,le-=5,n.ncode=4+(15&ae),ae>>>=4,le-=4,n.nlen>286||n.ndist>30){e.msg=\"too many length or distance symbols\",n.mode=Y;break}n.have=0,n.mode=z;case z:for(;n.have<n.ncode;){for(;le<3;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.lens[Ae[n.have++]]=7&ae,ae>>>=3,le-=3}for(;n.have<19;)n.lens[Ae[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Ce={bits:n.lenbits},ke=a(l,n.lens,0,19,n.lencode,0,n.work,Ce),n.lenbits=Ce.bits,ke){e.msg=\"invalid code lengths set\",n.mode=Y;break}n.have=0,n.mode=F;case F:for(;n.have<n.nlen+n.ndist;){for(;ye=(Te=n.lencode[ae&(1<<n.lenbits)-1])>>>16&255,_e=65535&Te,!((ge=Te>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(_e<16)ae>>>=ge,le-=ge,n.lens[n.have++]=_e;else{if(16===_e){for(xe=ge+2;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(ae>>>=ge,le-=ge,0===n.have){e.msg=\"invalid bit length repeat\",n.mode=Y;break}Se=n.lens[n.have-1],ue=3+(3&ae),ae>>>=2,le-=2}else if(17===_e){for(xe=ge+3;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}le-=ge,Se=0,ue=3+(7&(ae>>>=ge)),ae>>>=3,le-=3}else{for(xe=ge+7;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}le-=ge,Se=0,ue=11+(127&(ae>>>=ge)),ae>>>=7,le-=7}if(n.have+ue>n.nlen+n.ndist){e.msg=\"invalid bit length repeat\",n.mode=Y;break}for(;ue--;)n.lens[n.have++]=Se}}if(n.mode===Y)break;if(0===n.lens[256]){e.msg=\"invalid code -- missing end-of-block\",n.mode=Y;break}if(n.lenbits=9,Ce={bits:n.lenbits},ke=a(c,n.lens,0,n.nlen,n.lencode,0,n.work,Ce),n.lenbits=Ce.bits,ke){e.msg=\"invalid literal/lengths set\",n.mode=Y;break}if(n.distbits=6,n.distcode=n.distdyn,Ce={bits:n.distbits},ke=a(h,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Ce),n.distbits=Ce.bits,ke){e.msg=\"invalid distances set\",n.mode=Y;break}if(n.mode=L,t===f)break e;case L:n.mode=U;case U:if(se>=6&&oe>=258){e.next_out=ie,e.avail_out=oe,e.next_in=ne,e.avail_in=se,n.hold=ae,n.bits=le,o(e,he),ie=e.next_out,te=e.output,oe=e.avail_out,ne=e.next_in,ee=e.input,se=e.avail_in,ae=n.hold,le=n.bits,n.mode===$&&(n.back=-1);break}for(n.back=0;ye=(Te=n.lencode[ae&(1<<n.lenbits)-1])>>>16&255,_e=65535&Te,!((ge=Te>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(ye&&0==(240&ye)){for(ve=ge,be=ye,we=_e;ye=(Te=n.lencode[we+((ae&(1<<ve+be)-1)>>ve)])>>>16&255,_e=65535&Te,!(ve+(ge=Te>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}ae>>>=ve,le-=ve,n.back+=ve}if(ae>>>=ge,le-=ge,n.back+=ge,n.length=_e,0===ye){n.mode=K;break}if(32&ye){n.back=-1,n.mode=$;break}if(64&ye){e.msg=\"invalid literal/length code\",n.mode=Y;break}n.extra=15&ye,n.mode=H;case H:if(n.extra){for(xe=n.extra;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.length+=ae&(1<<n.extra)-1,ae>>>=n.extra,le-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=q;case q:for(;ye=(Te=n.distcode[ae&(1<<n.distbits)-1])>>>16&255,_e=65535&Te,!((ge=Te>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(0==(240&ye)){for(ve=ge,be=ye,we=_e;ye=(Te=n.distcode[we+((ae&(1<<ve+be)-1)>>ve)])>>>16&255,_e=65535&Te,!(ve+(ge=Te>>>24)<=le);){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}ae>>>=ve,le-=ve,n.back+=ve}if(ae>>>=ge,le-=ge,n.back+=ge,64&ye){e.msg=\"invalid distance code\",n.mode=Y;break}n.offset=_e,n.extra=15&ye,n.mode=W;case W:if(n.extra){for(xe=n.extra;le<xe;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}n.offset+=ae&(1<<n.extra)-1,ae>>>=n.extra,le-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg=\"invalid distance too far back\",n.mode=Y;break}n.mode=V;case V:if(0===oe)break e;if(ue=he-oe,n.offset>ue){if((ue=n.offset-ue)>n.whave&&n.sane){e.msg=\"invalid distance too far back\",n.mode=Y;break}ue>n.wnext?(ue-=n.wnext,pe=n.wsize-ue):pe=n.wnext-ue,ue>n.length&&(ue=n.length),me=n.window}else me=te,pe=ie-n.offset,ue=n.length;ue>oe&&(ue=oe),oe-=ue,n.length-=ue;do{te[ie++]=me[pe++]}while(--ue);0===n.length&&(n.mode=U);break;case K:if(0===oe)break e;te[ie++]=n.length,oe--,n.mode=U;break;case Z:if(n.wrap){for(;le<32;){if(0===se)break e;se--,ae|=ee[ne++]<<le,le+=8}if(he-=oe,e.total_out+=he,n.total+=he,he&&(e.adler=n.check=n.flags?s(n.check,te,he,ie-he):i(n.check,te,he,ie-he)),he=oe,(n.flags?ae:re(ae))!==n.check){e.msg=\"incorrect data check\",n.mode=Y;break}ae=0,le=0}n.mode=J;case J:if(n.wrap&&n.flags){for(;le<32;){if(0===se)break e;se--,ae+=ee[ne++]<<le,le+=8}if(ae!==(4294967295&n.total)){e.msg=\"incorrect length check\",n.mode=Y;break}ae=0,le=0}n.mode=G;case G:ke=m;break e;case Y:ke=_;break e;case X:return v;case Q:default:return y}return e.next_out=ie,e.avail_out=oe,e.next_in=ne,e.avail_in=se,n.hold=ae,n.bits=le,(n.wsize||he!==e.avail_out&&n.mode<Y&&(n.mode<Z||t!==u))&&fe(e,e.output,e.next_out,he-e.avail_out)?(n.mode=X,v):(ce-=e.avail_in,he-=e.avail_out,e.total_in+=ce,e.total_out+=he,n.total+=he,n.wrap&&he&&(e.adler=n.check=n.flags?s(n.check,te,he,e.next_out-he):i(n.check,te,he,e.next_out-he)),e.data_type=n.bits+(n.last?64:0)+(n.mode===$?128:0)+(n.mode===L||n.mode===B?256:0),(0===ce&&0===he||t===u)&&ke===p&&(ke=b),ke)},t.inflateEnd=function(e){if(!e||!e.state)return y;var t=e.state;return t.window&&(t.window=null),e.state=null,p},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?y:(n.head=t,t.done=!1,p):y},t.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&n.mode!==N?y:n.mode===N&&i(1,t,r,0)!==n.check?_:fe(e,t,r,r)?(n.mode=X,v):(n.havedict=1,p):y},t.inflateInfo=\"pako inflate (from Nodeca project)\"},function(e,t,n){\"use strict\";e.exports=function(e,t){var n,r,i,s,o,a,l,c,h,u,d,f,p,m,g,y,_,v,b,w,S,k,C,x,T;n=e.state,r=e.next_in,x=e.input,i=r+(e.avail_in-5),s=e.next_out,T=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=n.dmax,c=n.wsize,h=n.whave,u=n.wnext,d=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,y=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;e:do{p<15&&(f+=x[r++]<<p,p+=8,f+=x[r++]<<p,p+=8),v=m[f&y];t:for(;;){if(f>>>=b=v>>>24,p-=b,0===(b=v>>>16&255))T[s++]=65535&v;else{if(!(16&b)){if(0==(64&b)){v=m[(65535&v)+(f&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg=\"invalid literal/length code\",n.mode=30;break e}w=65535&v,(b&=15)&&(p<b&&(f+=x[r++]<<p,p+=8),w+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=x[r++]<<p,p+=8,f+=x[r++]<<p,p+=8),v=g[f&_];n:for(;;){if(f>>>=b=v>>>24,p-=b,!(16&(b=v>>>16&255))){if(0==(64&b)){v=g[(65535&v)+(f&(1<<b)-1)];continue n}e.msg=\"invalid distance code\",n.mode=30;break e}if(S=65535&v,p<(b&=15)&&(f+=x[r++]<<p,(p+=8)<b&&(f+=x[r++]<<p,p+=8)),(S+=f&(1<<b)-1)>l){e.msg=\"invalid distance too far back\",n.mode=30;break e}if(f>>>=b,p-=b,S>(b=s-o)){if((b=S-b)>h&&n.sane){e.msg=\"invalid distance too far back\",n.mode=30;break e}if(k=0,C=d,0===u){if(k+=c-b,b<w){w-=b;do{T[s++]=d[k++]}while(--b);k=s-S,C=T}}else if(u<b){if(k+=c+u-b,(b-=u)<w){w-=b;do{T[s++]=d[k++]}while(--b);if(k=0,u<w){w-=b=u;do{T[s++]=d[k++]}while(--b);k=s-S,C=T}}}else if(k+=u-b,b<w){w-=b;do{T[s++]=d[k++]}while(--b);k=s-S,C=T}for(;w>2;)T[s++]=C[k++],T[s++]=C[k++],T[s++]=C[k++],w-=3;w&&(T[s++]=C[k++],w>1&&(T[s++]=C[k++]))}else{k=s-S;do{T[s++]=T[k++],T[s++]=T[k++],T[s++]=T[k++],w-=3}while(w>2);w&&(T[s++]=T[k++],w>1&&(T[s++]=T[k++]))}break}}break}}while(r<i&&s<a);r-=w=p>>3,f&=(1<<(p-=w<<3))-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=s<a?a-s+257:257-(s-a),n.hold=f,n.bits=p}},function(e,t,n){\"use strict\";var r=n(8),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,l,c,h,u,d){var f,p,m,g,y,_,v,b,w,S=d.bits,k=0,C=0,x=0,T=0,E=0,A=0,O=0,I=0,R=0,N=0,$=null,P=0,j=new r.Buf16(16),B=new r.Buf16(16),M=null,D=0;for(k=0;k<=15;k++)j[k]=0;for(C=0;C<l;C++)j[t[n+C]]++;for(E=S,T=15;T>=1&&0===j[T];T--);if(E>T&&(E=T),0===T)return c[h++]=20971520,c[h++]=20971520,d.bits=1,0;for(x=1;x<T&&0===j[x];x++);for(E<x&&(E=x),I=1,k=1;k<=15;k++)if(I<<=1,(I-=j[k])<0)return-1;if(I>0&&(0===e||1!==T))return-1;for(B[1]=0,k=1;k<15;k++)B[k+1]=B[k]+j[k];for(C=0;C<l;C++)0!==t[n+C]&&(u[B[t[n+C]]++]=C);if(0===e?($=M=u,_=19):1===e?($=i,P-=257,M=s,D-=257,_=256):($=o,M=a,_=-1),N=0,C=0,k=x,y=h,A=E,O=0,m=-1,g=(R=1<<E)-1,1===e&&R>852||2===e&&R>592)return 1;for(;;){v=k-O,u[C]<_?(b=0,w=u[C]):u[C]>_?(b=M[D+u[C]],w=$[P+u[C]]):(b=96,w=0),f=1<<k-O,x=p=1<<A;do{c[y+(N>>O)+(p-=f)]=v<<24|b<<16|w|0}while(0!==p);for(f=1<<k-1;N&f;)f>>=1;if(0!==f?(N&=f-1,N+=f):N=0,C++,0==--j[k]){if(k===T)break;k=t[n+u[C]]}if(k>E&&(N&g)!==m){for(0===O&&(O=E),y+=x,I=1<<(A=k-O);A+O<T&&!((I-=j[A+O])<=0);)A++,I<<=1;if(R+=1<<A,1===e&&R>852||2===e&&R>592)return 1;c[m=N&g]=E<<24|A<<16|y-h|0}}return 0!==N&&(c[y+N]=k-O<<24|64<<16|0),d.bits=E,0}},function(e,t,n){\"use strict\";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=\"\",this.comment=\"\",this.hcrc=0,this.done=!1}},function(e,t,n){\"use strict\";var r=n(0),i=n(2),s=n(12),o=n(32),a=n(63),l=function(e,t){var n,r=\"\";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r},c=function(e,t,n,i,c,h){var u,d,f=e.file,p=e.compression,m=h!==s.utf8encode,g=r.transformTo(\"string\",h(f.name)),y=r.transformTo(\"string\",s.utf8encode(f.name)),_=f.comment,v=r.transformTo(\"string\",h(_)),b=r.transformTo(\"string\",s.utf8encode(_)),w=y.length!==f.name.length,S=b.length!==_.length,k=\"\",C=\"\",x=\"\",T=f.dir,E=f.date,A={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(A.crc32=e.crc32,A.compressedSize=e.compressedSize,A.uncompressedSize=e.uncompressedSize);var O=0;t&&(O|=8),m||!w&&!S||(O|=2048);var I,R,N,$=0,P=0;T&&($|=16),\"UNIX\"===c?(P=798,$|=(I=f.unixPermissions,R=T,N=I,I||(N=R?16893:33204),(65535&N)<<16)):(P=20,$|=63&(f.dosPermissions||0)),u=E.getUTCHours(),u<<=6,u|=E.getUTCMinutes(),u<<=5,u|=E.getUTCSeconds()/2,d=E.getUTCFullYear()-1980,d<<=4,d|=E.getUTCMonth()+1,d<<=5,d|=E.getUTCDate(),w&&(C=l(1,1)+l(o(g),4)+y,k+=\"up\"+l(C.length,2)+C),S&&(x=l(1,1)+l(o(v),4)+b,k+=\"uc\"+l(x.length,2)+x);var j=\"\";return j+=\"\\n\\0\",j+=l(O,2),j+=p.magic,j+=l(u,2),j+=l(d,2),j+=l(A.crc32,4),j+=l(A.compressedSize,4),j+=l(A.uncompressedSize,4),j+=l(g.length,2),j+=l(k.length,2),{fileRecord:a.LOCAL_FILE_HEADER+j+g+k,dirRecord:a.CENTRAL_FILE_HEADER+l(P,2)+j+l(v.length,2)+\"\\0\\0\\0\\0\"+l($,4)+l(i,4)+g+k+v}},h=function(e){return a.DATA_DESCRIPTOR+l(e.crc32,4)+l(e.compressedSize,4)+l(e.uncompressedSize,4)};function u(e,t,n,r){i.call(this,\"ZipFileWorker\"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(u,i),u.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=c(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=c(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:h(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,s){var o=r.transformTo(\"string\",s(i));return a.CENTRAL_DIRECTORY_END+\"\\0\\0\\0\\0\"+l(e,2)+l(e,2)+l(t,4)+l(n,4)+l(o.length,2)+o}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on(\"data\",function(e){t.processChunk(e)}),e.on(\"end\",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on(\"error\",function(e){t.error(e)}),this},u.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},u.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},e.exports=u},function(e,t,n){\"use strict\";var r=n(0),i=n(2);function s(e,t){i.call(this,\"Nodejs stream input adapter for \"+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(s,i),s.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on(\"data\",function(e){t.push({data:e,meta:{percent:0}})}).on(\"error\",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on(\"end\",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},s.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},function(e,t,n){\"use strict\";var r=n(0),i=n(19),s=n(12),o=(r=n(0),n(116)),a=n(56),l=n(26);function c(e){return new i.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new a);r.on(\"error\",function(e){n(e)}).on(\"end\",function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error(\"Corrupted zip : CRC32 mismatch\")):t()}).resume()})}e.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error(\"JSZip can't accept a stream when loading a zip file.\")):r.prepareContent(\"the loaded zip file\",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var s=0;s<r.length;s++)n.push(c(r[s]));return i.Promise.all(n)}).then(function(e){for(var r=e.shift(),i=r.files,s=0;s<i.length;s++){var o=i[s];n.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders})}return r.zipComment.length&&(n.comment=r.zipComment),n})}},function(e,t,n){\"use strict\";var r=n(64),i=n(0),s=n(63),o=n(119),a=(n(12),n(7));function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error(\"Corrupted zip or bug: unexpected signature (\"+i.pretty(t)+\", expected \"+i.pretty(e)+\")\")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.uint8array?\"uint8array\":\"array\",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error(\"Multi-volumes zip are not supported\")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error(\"Corrupted zip or bug: expected \"+this.centralDirRecords+\" records in central dir, got \"+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error(\"Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html\"):new Error(\"Corrupted zip: can't find end of central directory\");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error(\"Corrupted zip: can't find the ZIP64 end of central directory locator\");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error(\"Corrupted zip: can't find the ZIP64 end of central directory\");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(r>0)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error(\"Corrupted zip: missing \"+Math.abs(r)+\" bytes.\")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},function(e,t,n){\"use strict\";var r=n(66);function i(e){r.call(this,e)}n(0).inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},function(e,t,n){\"use strict\";var r=n(67);function i(e){r.call(this,e)}n(0).inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=i},function(e,t,n){\"use strict\";var r=n(64),i=n(0),s=n(31),o=n(32),a=n(12),l=n(57),c=n(7);function h(e,t){this.options=e,this.loadOptions=t}h.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error(\"Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)\");if(null===(t=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error(\"Corrupted zip : compression \"+i.pretty(this.compressionMethod)+\" unknown (inner file : \"+i.transformTo(\"string\",this.fileName)+\")\");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error(\"Encrypted zip are not supported\");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||\"/\"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r}},handleUTF8:function(){var e=c.uint8array?\"uint8array\":\"array\";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var s=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)?null:o(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)?null:o(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null}},e.exports=h},function(e,t,n){\"use strict\";function r(e){if(!(this instanceof r))return new r(e);e=e||{},this.concurrency=e.concurrency||1/0,this.pending=0,this.jobs=[],this.cbs=[],this._done=function(){this.pending--,this._run()}.bind(this)}[\"push\",\"unshift\",\"splice\"].forEach(function(e){r.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this._run(),t}}),Object.defineProperty(r.prototype,\"length\",{get:function(){return this.pending+this.jobs.length}}),r.prototype._run=function(){if(this.pending!==this.concurrency){if(this.jobs.length){var e=this.jobs.shift();this.pending++,e(this._done),this._run()}if(0===this.pending)for(;0!==this.cbs.length;){var t=this.cbs.pop();process.nextTick(t)}}},r.prototype.onDone=function(e){\"function\"==typeof e&&(this.cbs.push(e),this._run())},e.exports=r},function(e,t,n){\"use strict\";class r{constructor(e,t){this.target=t,this.type=e}}class i extends r{constructor(e,t){super(\"message\",t),this.data=e}}class s extends r{constructor(e,t,n){super(\"close\",n),this.wasClean=n._closeFrameReceived&&n._closeFrameSent,this.reason=t,this.code=e}}class o extends r{constructor(e){super(\"open\",e)}}class a extends r{constructor(e,t){super(\"error\",t),this.message=e.message,this.error=e}}const l={addEventListener(e,t){function n(e){t.call(this,new i(e,this))}function r(e,n){t.call(this,new s(e,n,this))}function l(e){t.call(this,new a(e,this))}function c(){t.call(this,new o(this))}\"function\"==typeof t&&(\"message\"===e?(n._listener=t,this.on(e,n)):\"close\"===e?(r._listener=t,this.on(e,r)):\"error\"===e?(l._listener=t,this.on(e,l)):\"open\"===e?(c._listener=t,this.on(e,c)):this.on(e,t))},removeEventListener(e,t){const n=this.listeners(e);for(var r=0;r<n.length;r++)n[r]!==t&&n[r]._listener!==t||this.removeListener(e,n[r])}};e.exports=l},function(e,t,n){\"use strict\";const r=n(4),i=n(30),s=n(21),o=n(22),a=n(16),l=n(27),c=n(71),h=n(28),u=n(70),d=r.Buffer;function f(){this.destroy()}function p(e,t,n){e.writable&&(n=n||o.STATUS_CODES[t],e.write(`HTTP/1.1 ${t} ${o.STATUS_CODES[t]}\\r\\n`+\"Connection: close\\r\\nContent-type: text/html\\r\\n\"+`Content-Length: ${d.byteLength(n)}\\r\\n`+\"\\r\\n\"+n)),e.removeListener(\"error\",f),e.destroy()}e.exports=class extends i{constructor(e,t){if(super(),null==(e=Object.assign({maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null},e)).port&&!e.server&&!e.noServer)throw new TypeError('One of the \"port\", \"server\", or \"noServer\" options must be specified');null!=e.port?(this._server=o.createServer((e,t)=>{const n=o.STATUS_CODES[426];t.writeHead(426,{\"Content-Length\":n.length,\"Content-Type\":\"text/plain\"}),t.end(n)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server&&(this._removeListeners=function(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,\"listening\"),error:this.emit.bind(this,\"error\"),upgrade:(e,t,n)=>{this.handleUpgrade(e,t,n,t=>{this.emit(\"connection\",t,e)})}})),!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e}address(){if(this.options.noServer)throw new Error('The server is operating in \"noServer\" mode');return this._server?this._server.address():null}close(e){if(this.clients)for(const e of this.clients)e.terminate();const t=this._server;if(t&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port))return t.close(e);e&&e()}shouldHandle(e){return!this.options.path||a.parse(e.url).pathname===this.options.path}handleUpgrade(e,t,n,r){t.on(\"error\",f);const i=+e.headers[\"sec-websocket-version\"],s={};if(\"GET\"!==e.method||\"websocket\"!==e.headers.upgrade.toLowerCase()||!e.headers[\"sec-websocket-key\"]||8!==i&&13!==i||!this.shouldHandle(e))return p(t,400);if(this.options.perMessageDeflate){const n=new l(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const r=c.parse(e.headers[\"sec-websocket-extensions\"]);r[l.extensionName]&&(n.accept(r[l.extensionName]),s[l.extensionName]=n)}catch(e){return p(t,400)}}var o=(e.headers[\"sec-websocket-protocol\"]||\"\").split(/, */);if(this.options.handleProtocols){if(!1===(o=this.options.handleProtocols(o,e)))return p(t,401)}else o=o[0];if(this.options.verifyClient){const a={origin:e.headers[`${8===i?\"sec-websocket-origin\":\"origin\"}`],secure:!(!e.connection.authorized&&!e.connection.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(a,(i,a,l)=>{if(!i)return p(t,a||401,l);this.completeUpgrade(o,s,e,t,n,r)});if(!this.options.verifyClient(a))return p(t,401)}this.completeUpgrade(o,s,e,t,n,r)}completeUpgrade(e,t,n,r,i,o){if(!r.readable||!r.writable)return r.destroy();const a=[\"HTTP/1.1 101 Switching Protocols\",\"Upgrade: websocket\",\"Connection: Upgrade\",`Sec-WebSocket-Accept: ${s.createHash(\"sha1\").update(n.headers[\"sec-websocket-key\"]+h.GUID,\"binary\").digest(\"base64\")}`],d=new u(null);if(e&&(a.push(`Sec-WebSocket-Protocol: ${e}`),d.protocol=e),t[l.extensionName]){const e=t[l.extensionName].params,n=c.format({[l.extensionName]:[e]});a.push(`Sec-WebSocket-Extensions: ${n}`),d._extensions=t}this.emit(\"headers\",a,n),r.write(a.concat(\"\\r\\n\").join(\"\\r\\n\")),r.removeListener(\"error\",f),d.setSocket(r,i,this.options.maxPayload),this.clients&&(this.clients.add(d),d.on(\"close\",()=>this.clients.delete(d))),o(d)}}},function(e,t,n){\"use strict\";var r=e.exports=n(124);r.build=\"full\",r.tokenize=n(85),r.parse=n(138),r.common=n(139),r.Root._configure(r.Type,r.parse,r.common)},function(e,t,n){\"use strict\";var r=e.exports=n(125);r.build=\"light\",r.load=function(e,t,n){return\"function\"==typeof t?(n=t,t=new r.Root):t||(t=new r.Root),t.load(e,n)},r.loadSync=function(e,t){return t||(t=new r.Root),t.loadSync(e)},r.encoder=n(80),r.decoder=n(81),r.verifier=n(82),r.converter=n(83),r.ReflectionObject=n(14),r.Namespace=n(20),r.Root=n(42),r.Enum=n(5),r.Type=n(37),r.Field=n(9),r.OneOf=n(29),r.MapField=n(38),r.Service=n(39),r.Method=n(40),r.Message=n(41),r.wrappers=n(84),r.types=n(15),r.util=n(1),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},function(e,t,n){\"use strict\";var r=t;function i(){r.Reader._configure(r.BufferReader),r.util._configure()}r.build=\"minimal\",r.Writer=n(35),r.BufferWriter=n(132),r.Reader=n(36),r.BufferReader=n(133),r.util=n(6),r.rpc=n(78),r.roots=n(79),r.configure=i,r.Writer._configure(r.BufferWriter),i()},function(e,t,n){\"use strict\";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&\"=\"===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),s=new Array(123),o=0;o<64;)s[i[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,n){for(var r,s=null,o=[],a=0,l=0;t<n;){var c=e[t++];switch(l){case 0:o[a++]=i[c>>2],r=(3&c)<<4,l=1;break;case 1:o[a++]=i[r|c>>4],r=(15&c)<<2,l=2;break;case 2:o[a++]=i[r|c>>6],o[a++]=i[63&c],l=0}a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0)}return l&&(o[a++]=i[r],o[a++]=61,1===l&&(o[a++]=61)),s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join(\"\")):String.fromCharCode.apply(String,o.slice(0,a))};r.decode=function(e,t,n){for(var r,i=n,o=0,a=0;a<e.length;){var l=e.charCodeAt(a++);if(61===l&&o>1)break;if(void 0===(l=s[l]))throw Error(\"invalid encoding\");switch(o){case 0:r=l,o=1;break;case 1:t[n++]=r<<2|(48&l)>>4,r=l,o=2;break;case 2:t[n++]=(15&r)<<4|(60&l)>>2,r=l,o=3;break;case 3:t[n++]=(3&r)<<6|l,o=0}}if(1===o)throw Error(\"invalid encoding\");return n-i},r.test=function(e){return/^(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?$/.test(e)}},function(e,t,n){\"use strict\";function r(){this._listeners={}}e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t,n){\"use strict\";function r(e){return\"undefined\"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function s(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function a(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:s,e.writeFloatBE=r?s:i,e.readFloatLE=r?o:a,e.readFloatBE=r?a:o}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>3.4028234663852886e38)e((i<<31|2139095040)>>>0,n,r);else if(t<1.1754943508222875e-38)e((i<<31|Math.round(t/1.401298464324817e-45))>>>0,n,r);else{var s=Math.floor(Math.log(t)/Math.LN2);e((i<<31|s+127<<23|8388607&Math.round(t*Math.pow(2,-s)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,s=r>>>23&255,o=8388607&r;return 255===s?o?NaN:i*(1/0):0===s?1.401298464324817e-45*i*o:i*Math.pow(2,s-150)*(o+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,s),e.readFloatLE=n.bind(null,o),e.readFloatBE=n.bind(null,a)}(),\"undefined\"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function s(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function a(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:s,e.writeDoubleBE=r?s:i,e.readDoubleLE=r?o:a,e.readDoubleBE=r?a:o}():function(){function t(e,t,n,r,i,s){var o=r<0?1:0;if(o&&(r=-r),0===r)e(0,i,s+t),e(1/r>0?0:2147483648,i,s+n);else if(isNaN(r))e(0,i,s+t),e(2146959360,i,s+n);else if(r>1.7976931348623157e308)e(0,i,s+t),e((o<<31|2146435072)>>>0,i,s+n);else{var a;if(r<2.2250738585072014e-308)e((a=r/5e-324)>>>0,i,s+t),e((o<<31|a/4294967296)>>>0,i,s+n);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(a=r*Math.pow(2,-l))>>>0,i,s+t),e((o<<31|l+1023<<20|1048576*a&1048575)>>>0,i,s+n)}}}function n(e,t,n,r,i){var s=e(r,i+t),o=e(r,i+n),a=2*(o>>31)+1,l=o>>>20&2047,c=4294967296*(1048575&o)+s;return 2047===l?c?NaN:a*(1/0):0===l?5e-324*a*c:a*Math.pow(2,l-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,s,4,0),e.readDoubleLE=n.bind(null,o,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function i(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function s(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=r(r)},function(e,t,n){\"use strict\";var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return\"\";for(var r,i=null,s=[],o=0;t<n;)(r=e[t++])<128?s[o++]=r:r>191&&r<224?s[o++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[o++]=55296+(r>>10),s[o++]=56320+(1023&r)):s[o++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0);return i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join(\"\")):String.fromCharCode.apply(String,s.slice(0,o))},r.write=function(e,t,n){for(var r,i,s=n,o=0;o<e.length;++o)(r=e.charCodeAt(o))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(o+1)))?(r=65536+((1023&r)<<10)+(1023&i),++o,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-s}},function(e,t,n){\"use strict\";e.exports=function(e,t,n){var r=n||8192,i=r>>>1,s=null,o=r;return function(n){if(n<1||n>i)return e(n);o+n>r&&(s=e(r),o=0);var a=t.call(s,o,o+=n);return 7&o&&(o=1+(7|o)),a}}},function(e,t,n){\"use strict\";e.exports=i;var r=n(6);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=i.zero=new i(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=i.zeroHash=\"\\0\\0\\0\\0\\0\\0\\0\\0\";i.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if(\"number\"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):s},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===o?s:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){\"use strict\";e.exports=o;var r=n(35);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(6),s=i.Buffer;function o(){r.call(this)}o.alloc=function(e){return(o.alloc=i._Buffer_allocUnsafe)(e)};var a=s&&s.prototype instanceof Uint8Array&&\"set\"===s.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]};function l(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write(e,n)}o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,\"base64\"));var t=e.length>>>0;return this.uint32(t),t&&this._push(a,t,e),this},o.prototype.string=function(e){var t=s.byteLength(e);return this.uint32(t),t&&this._push(l,t,e),this}},function(e,t,n){\"use strict\";e.exports=s;var r=n(36);(s.prototype=Object.create(r.prototype)).constructor=s;var i=n(6);function s(e){r.call(this,e)}i.Buffer&&(s.prototype._slice=i.Buffer.prototype.slice),s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))}},function(e,t,n){\"use strict\";e.exports=i;var r=n(6);function i(e,t,n){if(\"function\"!=typeof e)throw TypeError(\"rpcImpl must be a function\");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,s,o){if(!s)throw TypeError(\"request must be specified\");var a=this;if(!o)return r.asPromise(e,a,t,n,i,s);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?\"encodeDelimited\":\"encode\"](s).finish(),function(e,n){if(e)return a.emit(\"error\",e,t),o(e);if(null!==n){if(!(n instanceof i))try{n=i[a.responseDelimited?\"decodeDelimited\":\"decode\"](n)}catch(e){return a.emit(\"error\",e,t),o(e)}return a.emit(\"data\",n,t),o(null,n)}a.end(!0)})}catch(e){return a.emit(\"error\",e,t),void setTimeout(function(){o(e)},0)}else setTimeout(function(){o(Error(\"already ended\"))},0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit(\"end\").off()),this}},function(e,t,n){\"use strict\";function r(e,t){\"string\"==typeof e&&(t=e,e=void 0);var n=[];function i(e){if(\"string\"!=typeof e){var t=s();if(r.verbose&&console.log(\"codegen: \"+t),t=\"return \"+t,e){for(var o=Object.keys(e),a=new Array(o.length+1),l=new Array(o.length),c=0;c<o.length;)a[c]=o[c],l[c]=e[o[c++]];return a[c]=t,Function.apply(null,a).apply(null,l)}return Function(t)()}for(var h=new Array(arguments.length-1),u=0;u<h.length;)h[u]=arguments[++u];if(u=0,e=e.replace(/%([%dfijs])/g,function(e,t){var n=h[u++];switch(t){case\"d\":case\"f\":return String(Number(n));case\"i\":return String(Math.floor(n));case\"j\":return JSON.stringify(n);case\"s\":return String(n)}return\"%\"}),u!==h.length)throw Error(\"parameter count mismatch\");return n.push(e),i}function s(r){return\"function \"+(r||t||\"\")+\"(\"+(e&&e.join(\",\")||\"\")+\"){\\n  \"+n.join(\"\\n  \")+\"\\n}\"}return i.toString=s,i}e.exports=r,r.verbose=!1},function(e,t,n){\"use strict\";e.exports=s;var r=n(76),i=n(77)(\"fs\");function s(e,t,n){return\"function\"==typeof t?(n=t,t={}):t||(t={}),n?!t.xhr&&i&&i.readFile?i.readFile(e,function(r,i){return r&&\"undefined\"!=typeof XMLHttpRequest?s.xhr(e,t,n):r?n(r):n(null,t.binary?i:i.toString(\"utf8\"))}):s.xhr(e,t,n):r(s,this,e,t)}s.xhr=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(0!==r.status&&200!==r.status)return n(Error(\"status \"+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var i=0;i<r.responseText.length;++i)e.push(255&r.responseText.charCodeAt(i))}return n(null,\"undefined\"!=typeof Uint8Array?new Uint8Array(e):e)}return n(null,r.responseText)}},t.binary&&(\"overrideMimeType\"in r&&r.overrideMimeType(\"text/plain; charset=x-user-defined\"),r.responseType=\"arraybuffer\"),r.open(\"GET\",e),r.send()}},function(e,t,n){\"use strict\";var r=t,i=r.isAbsolute=function(e){return/^(?:\\/|\\w+:)/.test(e)},s=r.normalize=function(e){var t=(e=e.replace(/\\\\/g,\"/\").replace(/\\/{2,}/g,\"/\")).split(\"/\"),n=i(e),r=\"\";n&&(r=t.shift()+\"/\");for(var s=0;s<t.length;)\"..\"===t[s]?s>0&&\"..\"!==t[s-1]?t.splice(--s,2):n?t.splice(s,1):++s:\".\"===t[s]?t.splice(s,1):++s;return r+t.join(\"/\")};r.resolve=function(e,t,n){return n||(t=s(t)),i(t)?t:(n||(e=s(e)),(e=e.replace(/(?:\\/|^)[^\\/]+$/,\"\")).length?s(e+\"/\"+t):t)}},function(e,t,n){\"use strict\";e.exports=C,C.filename=null,C.defaults={keepCase:!1};var r=n(85),i=n(42),s=n(37),o=n(9),a=n(38),l=n(29),c=n(5),h=n(39),u=n(40),d=n(15),f=n(1),p=/^[1-9][0-9]*$/,m=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,y=/^-?0[x][0-9a-fA-F]+$/,_=/^0[0-7]+$/,v=/^-?0[0-7]+$/,b=/^(?![eE])[0-9]*(?:\\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,w=/^[a-zA-Z_][a-zA-Z_0-9]*$/,S=/^(?:\\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,k=/^(?:\\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function C(e,t,n){t instanceof i||(n=t,t=new i),n||(n=C.defaults);var x,T,E,A,O,I=r(e,n.alternateCommentMode||!1),R=I.next,N=I.push,$=I.peek,P=I.skip,j=I.cmnt,B=!0,M=!1,D=t,z=n.keepCase?function(e){return e}:f.camelCase;function F(e,t,n){var r=C.filename;return n||(C.filename=null),Error(\"illegal \"+(t||\"token\")+\" '\"+e+\"' (\"+(r?r+\", \":\"\")+\"line \"+I.line+\")\")}function L(){var e,t=[];do{if('\"'!==(e=R())&&\"'\"!==e)throw F(e);t.push(R()),P(e),e=$()}while('\"'===e||\"'\"===e);return t.join(\"\")}function U(e){var t=R();switch(t){case\"'\":case'\"':return N(t),L();case\"true\":case\"TRUE\":return!0;case\"false\":case\"FALSE\":return!1}try{return function(e,t){var n=1;\"-\"===e.charAt(0)&&(n=-1,e=e.substring(1));switch(e){case\"inf\":case\"INF\":case\"Inf\":return n*(1/0);case\"nan\":case\"NAN\":case\"Nan\":case\"NaN\":return NaN;case\"0\":return 0}if(p.test(e))return n*parseInt(e,10);if(g.test(e))return n*parseInt(e,16);if(_.test(e))return n*parseInt(e,8);if(b.test(e))return n*parseFloat(e);throw F(e,\"number\",t)}(t,!0)}catch(n){if(e&&S.test(t))return t;throw F(t,\"value\")}}function H(e,t){var n,r;do{!t||'\"'!==(n=$())&&\"'\"!==n?e.push([r=q(R()),P(\"to\",!0)?q(R()):r]):e.push(L())}while(P(\",\",!0));P(\";\")}function q(e,t){switch(e){case\"max\":case\"MAX\":case\"Max\":return 536870911;case\"0\":return 0}if(!t&&\"-\"===e.charAt(0))throw F(e,\"id\");if(m.test(e))return parseInt(e,10);if(y.test(e))return parseInt(e,16);if(v.test(e))return parseInt(e,8);throw F(e,\"id\")}function W(){if(void 0!==x)throw F(\"package\");if(x=R(),!S.test(x))throw F(x,\"name\");D=D.define(x),P(\";\")}function V(){var e,t=$();switch(t){case\"weak\":e=E||(E=[]),R();break;case\"public\":R();default:e=T||(T=[])}t=L(),P(\";\"),e.push(t)}function K(){if(P(\"=\"),A=L(),!(M=\"proto3\"===A)&&\"proto2\"!==A)throw F(A,\"syntax\");P(\";\")}function Z(e,t){switch(t){case\"option\":return Y(e,t),P(\";\"),!0;case\"message\":return function(e,t){if(!w.test(t=R()))throw F(t,\"type name\");var n=new s(t);J(n,function(e){if(!Z(n,e))switch(e){case\"map\":!function(e){P(\"<\");var t=R();if(void 0===d.mapKey[t])throw F(t,\"type\");P(\",\");var n=R();if(!S.test(n))throw F(n,\"type\");P(\">\");var r=R();if(!w.test(r))throw F(r,\"name\");P(\"=\");var i=new a(z(r),q(R()),t,n);J(i,function(e){if(\"option\"!==e)throw F(e);Y(i,e),P(\";\")},function(){ee(i)}),e.add(i)}(n);break;case\"required\":case\"optional\":case\"repeated\":G(n,e);break;case\"oneof\":!function(e,t){if(!w.test(t=R()))throw F(t,\"name\");var n=new l(z(t));J(n,function(e){\"option\"===e?(Y(n,e),P(\";\")):(N(e),G(n,\"optional\"))}),e.add(n)}(n,e);break;case\"extensions\":H(n.extensions||(n.extensions=[]));break;case\"reserved\":H(n.reserved||(n.reserved=[]),!0);break;default:if(!M||!S.test(e))throw F(e);N(e),G(n,\"optional\")}}),e.add(n)}(e,t),!0;case\"enum\":return function(e,t){if(!w.test(t=R()))throw F(t,\"name\");var n=new c(t);J(n,function(e){switch(e){case\"option\":Y(n,e),P(\";\");break;case\"reserved\":H(n.reserved||(n.reserved=[]),!0);break;default:!function(e,t){if(!w.test(t))throw F(t,\"name\");P(\"=\");var n=q(R(),!0),r={};J(r,function(e){if(\"option\"!==e)throw F(e);Y(r,e),P(\";\")},function(){ee(r)}),e.add(t,n,r.comment)}(n,e)}}),e.add(n)}(e,t),!0;case\"service\":return function(e,t){if(!w.test(t=R()))throw F(t,\"service name\");var n=new h(t);J(n,function(e){if(!Z(n,e)){if(\"rpc\"!==e)throw F(e);!function(e,t){var n=t;if(!w.test(t=R()))throw F(t,\"name\");var r,i,s,o,a=t;P(\"(\"),P(\"stream\",!0)&&(i=!0);if(!S.test(t=R()))throw F(t);r=t,P(\")\"),P(\"returns\"),P(\"(\"),P(\"stream\",!0)&&(o=!0);if(!S.test(t=R()))throw F(t);s=t,P(\")\");var l=new u(a,n,r,s,i,o);J(l,function(e){if(\"option\"!==e)throw F(e);Y(l,e),P(\";\")}),e.add(l)}(n,e)}}),e.add(n)}(e,t),!0;case\"extend\":return function(e,t){if(!S.test(t=R()))throw F(t,\"reference\");var n=t;J(null,function(t){switch(t){case\"required\":case\"repeated\":case\"optional\":G(e,t,n);break;default:if(!M||!S.test(t))throw F(t);N(t),G(e,\"optional\",n)}})}(e,t),!0}return!1}function J(e,t,n){var r=I.line;if(e&&(e.comment=j(),e.filename=C.filename),P(\"{\",!0)){for(var i;\"}\"!==(i=R());)t(i);P(\";\",!0)}else n&&n(),P(\";\"),e&&\"string\"!=typeof e.comment&&(e.comment=j(r))}function G(e,t,n){var r=R();if(\"group\"!==r){if(!S.test(r))throw F(r,\"type\");var i=R();if(!w.test(i))throw F(i,\"name\");i=z(i),P(\"=\");var a=new o(i,q(R()),r,t,n);J(a,function(e){if(\"option\"!==e)throw F(e);Y(a,e),P(\";\")},function(){ee(a)}),e.add(a),M||!a.repeated||void 0===d.packed[r]&&void 0!==d.basic[r]||a.setOption(\"packed\",!1,!0)}else!function(e,t){var n=R();if(!w.test(n))throw F(n,\"name\");var r=f.lcFirst(n);n===r&&(n=f.ucFirst(n));P(\"=\");var i=q(R()),a=new s(n);a.group=!0;var l=new o(r,i,n,t);l.filename=C.filename,J(a,function(e){switch(e){case\"option\":Y(a,e),P(\";\");break;case\"required\":case\"optional\":case\"repeated\":G(a,e);break;default:throw F(e)}}),e.add(a).add(l)}(e,t)}function Y(e,t){var n=P(\"(\",!0);if(!S.test(t=R()))throw F(t,\"name\");var r=t;n&&(P(\")\"),r=\"(\"+r+\")\",t=$(),k.test(t)&&(r+=t,R())),P(\"=\"),X(e,r)}function X(e,t){if(P(\"{\",!0))do{if(!w.test(O=R()))throw F(O,\"name\");\"{\"===$()?X(e,t+\".\"+O):(P(\":\"),\"{\"===$()?X(e,t+\".\"+O):Q(e,t+\".\"+O,U(!0))),P(\",\",!0)}while(!P(\"}\",!0));else Q(e,t,U(!0))}function Q(e,t,n){e.setOption&&e.setOption(t,n)}function ee(e){if(P(\"[\",!0)){do{Y(e,\"option\")}while(P(\",\",!0));P(\"]\")}return e}for(;null!==(O=R());)switch(O){case\"package\":if(!B)throw F(O);W();break;case\"import\":if(!B)throw F(O);V();break;case\"syntax\":if(!B)throw F(O);K();break;case\"option\":if(!B)throw F(O);Y(D,O),P(\";\");break;default:if(Z(D,O)){B=!1;continue}throw F(O)}return C.filename=null,{package:x,imports:T,weakImports:E,syntax:A,root:t}}},function(e,t,n){\"use strict\";e.exports=s;var r,i=/\\/|\\./;function s(e,t){i.test(e)||(e=\"google/protobuf/\"+e+\".proto\",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),s[e]=t}s(\"any\",{Any:{fields:{type_url:{type:\"string\",id:1},value:{type:\"bytes\",id:2}}}}),s(\"duration\",{Duration:r={fields:{seconds:{type:\"int64\",id:1},nanos:{type:\"int32\",id:2}}}}),s(\"timestamp\",{Timestamp:r}),s(\"empty\",{Empty:{fields:{}}}),s(\"struct\",{Struct:{fields:{fields:{keyType:\"string\",type:\"Value\",id:1}}},Value:{oneofs:{kind:{oneof:[\"nullValue\",\"numberValue\",\"stringValue\",\"boolValue\",\"structValue\",\"listValue\"]}},fields:{nullValue:{type:\"NullValue\",id:1},numberValue:{type:\"double\",id:2},stringValue:{type:\"string\",id:3},boolValue:{type:\"bool\",id:4},structValue:{type:\"Struct\",id:5},listValue:{type:\"ListValue\",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:\"repeated\",type:\"Value\",id:1}}}}),s(\"wrappers\",{DoubleValue:{fields:{value:{type:\"double\",id:1}}},FloatValue:{fields:{value:{type:\"float\",id:1}}},Int64Value:{fields:{value:{type:\"int64\",id:1}}},UInt64Value:{fields:{value:{type:\"uint64\",id:1}}},Int32Value:{fields:{value:{type:\"int32\",id:1}}},UInt32Value:{fields:{value:{type:\"uint32\",id:1}}},BoolValue:{fields:{value:{type:\"bool\",id:1}}},StringValue:{fields:{value:{type:\"string\",id:1}}},BytesValue:{fields:{value:{type:\"bytes\",id:1}}}}),s(\"field_mask\",{FieldMask:{fields:{paths:{rule:\"repeated\",type:\"string\",id:1}}}}),s.get=function(e){return s[e]||null}},function(e,t,n){\"use strict\";n.r(t);var r=n(86),i=n.n(r),s=n(10),o=n.n(s),a=n(23),l=n.n(a),c=n(87),h=n.n(c),u=n(68),d=n.n(u),f=n(3),p=n(22),m=n(16),g=n(43),y=n(11);const _=Symbol(\"buffer\"),v=Symbol(\"type\");class b{constructor(){this[v]=\"\";const e=arguments[0],t=arguments[1],n=[];if(e){const t=e,r=Number(t.length);for(let e=0;e<r;e++){const r=t[e];let i;i=r instanceof Buffer?r:ArrayBuffer.isView(r)?Buffer.from(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?Buffer.from(r):r instanceof b?r[_]:Buffer.from(\"string\"==typeof r?r:String(r)),n.push(i)}}this[_]=Buffer.concat(n);let r=t&&void 0!==t.type&&String(t.type).toLowerCase();r&&!/[^\\u0020-\\u007E]/.test(r)&&(this[v]=r)}get size(){return this[_].length}get type(){return this[v]}slice(){const e=this.size,t=arguments[0],n=arguments[1];let r,i;r=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),i=void 0===n?e:n<0?Math.max(e+n,0):Math.min(n,e);const s=Math.max(i-r,0),o=this[_].slice(r,r+s),a=new b([],{type:arguments[2]});return a[_]=o,a}}function w(e,t,n){Error.call(this,e),this.message=e,this.type=t,n&&(this.code=this.errno=n.code),Error.captureStackTrace(this,this.constructor)}let S;Object.defineProperties(b.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(b.prototype,Symbol.toStringTag,{value:\"Blob\",writable:!1,enumerable:!1,configurable:!0}),w.prototype=Object.create(Error.prototype),w.prototype.constructor=w,w.prototype.name=\"FetchError\";try{S=require(\"encoding\").convert}catch(e){}const k=Symbol(\"Body internals\"),C=f.PassThrough;function x(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.size;let i=void 0===r?0:r;var s=n.timeout;let o=void 0===s?0:s;null==e?e=null:\"string\"==typeof e||E(e)||e instanceof b||Buffer.isBuffer(e)||\"[object ArrayBuffer]\"===Object.prototype.toString.call(e)||ArrayBuffer.isView(e)||e instanceof f||(e=String(e)),this[k]={body:e,disturbed:!1,error:null},this.size=i,this.timeout=o,e instanceof f&&e.on(\"error\",function(e){const n=\"AbortError\"===e.name?e:new w(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,\"system\",e);t[k].error=n})}function T(){var e=this;if(this[k].disturbed)return x.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[k].disturbed=!0,this[k].error)return x.Promise.reject(this[k].error);if(null===this.body)return x.Promise.resolve(Buffer.alloc(0));if(\"string\"==typeof this.body)return x.Promise.resolve(Buffer.from(this.body));if(this.body instanceof b)return x.Promise.resolve(this.body[_]);if(Buffer.isBuffer(this.body))return x.Promise.resolve(this.body);if(\"[object ArrayBuffer]\"===Object.prototype.toString.call(this.body))return x.Promise.resolve(Buffer.from(this.body));if(ArrayBuffer.isView(this.body))return x.Promise.resolve(Buffer.from(this.body.buffer,this.body.byteOffset,this.body.byteLength));if(!(this.body instanceof f))return x.Promise.resolve(Buffer.alloc(0));let t=[],n=0,r=!1;return new x.Promise(function(i,s){let o;e.timeout&&(o=setTimeout(function(){r=!0,s(new w(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,\"body-timeout\"))},e.timeout)),e.body.on(\"error\",function(t){\"AbortError\"===t.name?(r=!0,s(t)):s(new w(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,\"system\",t))}),e.body.on(\"data\",function(i){if(!r&&null!==i){if(e.size&&n+i.length>e.size)return r=!0,void s(new w(`content size at ${e.url} over limit: ${e.size}`,\"max-size\"));n+=i.length,t.push(i)}}),e.body.on(\"end\",function(){if(!r){clearTimeout(o);try{i(Buffer.concat(t))}catch(t){s(new w(`Could not create Buffer from response body for ${e.url}: ${t.message}`,\"system\",t))}}})})}function E(e){return\"object\"==typeof e&&\"function\"==typeof e.append&&\"function\"==typeof e.delete&&\"function\"==typeof e.get&&\"function\"==typeof e.getAll&&\"function\"==typeof e.has&&\"function\"==typeof e.set&&(\"URLSearchParams\"===e.constructor.name||\"[object URLSearchParams]\"===Object.prototype.toString.call(e)||\"function\"==typeof e.sort)}function A(e){let t,n,r=e.body;if(e.bodyUsed)throw new Error(\"cannot clone body after it is used\");return r instanceof f&&\"function\"!=typeof r.getBoundary&&(t=new C,n=new C,r.pipe(t),r.pipe(n),e[k].body=t,r=n),r}function O(e){const t=e.body;return null===t?0:\"string\"==typeof t?Buffer.byteLength(t):E(t)?Buffer.byteLength(String(t)):t instanceof b?t.size:Buffer.isBuffer(t)?t.length:\"[object ArrayBuffer]\"===Object.prototype.toString.call(t)?t.byteLength:ArrayBuffer.isView(t)?t.byteLength:t&&\"function\"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}x.prototype={get body(){return this[k].body},get bodyUsed(){return this[k].disturbed},arrayBuffer(){return T.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let e=this.headers&&this.headers.get(\"content-type\")||\"\";return T.call(this).then(function(t){return Object.assign(new b([],{type:e.toLowerCase()}),{[_]:t})})},json(){var e=this;return T.call(this).then(function(t){try{return JSON.parse(t.toString())}catch(t){return x.Promise.reject(new w(`invalid json response body at ${e.url} reason: ${t.message}`,\"invalid-json\"))}})},text(){return T.call(this).then(function(e){return e.toString()})},buffer(){return T.call(this)},textConverted(){var e=this;return T.call(this).then(function(t){return function(e,t){if(\"function\"!=typeof S)throw new Error(\"The package `encoding` must be installed to use the textConverted() function\");const n=t.get(\"content-type\");let r,i,s=\"utf-8\";n&&(r=/charset=([^;]*)/i.exec(n));i=e.slice(0,1024).toString(),!r&&i&&(r=/<meta.+?charset=(['\"])(.+?)\\1/i.exec(i));!r&&i&&(r=/<meta[\\s]+?http-equiv=(['\"])content-type\\1[\\s]+?content=(['\"])(.+?)\\2/i.exec(i))&&(r=/charset=(.*)/i.exec(r.pop()));!r&&i&&(r=/<\\?xml.+?encoding=(['\"])(.+?)\\1/i.exec(i));r&&(\"gb2312\"!==(s=r.pop())&&\"gbk\"!==s||(s=\"gb18030\"));return S(e,\"UTF-8\",s).toString()}(t,e.headers)})}},Object.defineProperties(x.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),x.mixIn=function(e){for(const t of Object.getOwnPropertyNames(x.prototype))if(!(t in e)){const n=Object.getOwnPropertyDescriptor(x.prototype,t);Object.defineProperty(e,t,n)}},x.Promise=global.Promise;const I=/[^\\^_`a-zA-Z\\-0-9!#$%&'*+.|~]/,R=/[^\\t\\x20-\\x7e\\x80-\\xff]/;function N(e){if(e=`${e}`,I.test(e))throw new TypeError(`${e} is not a legal HTTP header name`)}function $(e){if(e=`${e}`,R.test(e))throw new TypeError(`${e} is not a legal HTTP header value`)}function P(e,t){t=t.toLowerCase();for(const n in e)if(n.toLowerCase()===t)return n}const j=Symbol(\"map\");class B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[j]=Object.create(null),e instanceof B){const t=e.raw(),n=Object.keys(t);for(const e of n)for(const n of t[e])this.append(e,n)}else if(null==e);else{if(\"object\"!=typeof e)throw new TypeError(\"Provided initializer must be an object\");{const t=e[Symbol.iterator];if(null!=t){if(\"function\"!=typeof t)throw new TypeError(\"Header pairs must be iterable\");const n=[];for(const t of e){if(\"object\"!=typeof t||\"function\"!=typeof t[Symbol.iterator])throw new TypeError(\"Each header pair must be iterable\");n.push(Array.from(t))}for(const e of n){if(2!==e.length)throw new TypeError(\"Each header pair must be a name/value tuple\");this.append(e[0],e[1])}}else for(const t of Object.keys(e)){const n=e[t];this.append(t,n)}}}}get(e){N(e=`${e}`);const t=P(this[j],e);return void 0===t?null:this[j][t].join(\", \")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=M(this),r=0;for(;r<n.length;){var i=n[r];const s=i[0],o=i[1];e.call(t,o,s,this),n=M(this),r++}}set(e,t){t=`${t}`,N(e=`${e}`),$(t);const n=P(this[j],e);this[j][void 0!==n?n:e]=[t]}append(e,t){t=`${t}`,N(e=`${e}`),$(t);const n=P(this[j],e);void 0!==n?this[j][n].push(t):this[j][e]=[t]}has(e){return N(e=`${e}`),void 0!==P(this[j],e)}delete(e){N(e=`${e}`);const t=P(this[j],e);void 0!==t&&delete this[j][t]}raw(){return this[j]}keys(){return z(this,\"key\")}values(){return z(this,\"value\")}[Symbol.iterator](){return z(this,\"key+value\")}}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"key+value\";return Object.keys(e[j]).sort().map(\"key\"===t?function(e){return e.toLowerCase()}:\"value\"===t?function(t){return e[j][t].join(\", \")}:function(t){return[t.toLowerCase(),e[j][t].join(\", \")]})}B.prototype.entries=B.prototype[Symbol.iterator],Object.defineProperty(B.prototype,Symbol.toStringTag,{value:\"Headers\",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(B.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const D=Symbol(\"internal\");function z(e,t){const n=Object.create(F);return n[D]={target:e,kind:t,index:0},n}const F=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==F)throw new TypeError(\"Value of `this` is not a HeadersIterator\");var e=this[D];const t=e.target,n=e.kind,r=e.index,i=M(t,n);return r>=i.length?{value:void 0,done:!0}:(this[D].index=r+1,{value:i[r],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function L(e){const t=Object.assign({__proto__:null},e[j]),n=P(e[j],\"Host\");return void 0!==n&&(t[n]=t[n][0]),t}Object.defineProperty(F,Symbol.toStringTag,{value:\"HeadersIterator\",writable:!1,enumerable:!1,configurable:!0});const U=Symbol(\"Response internals\"),H=p.STATUS_CODES;class q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x.call(this,e,t);const n=t.status||200;this[U]={url:t.url,status:n,statusText:t.statusText||H[n],headers:new B(t.headers)}}get url(){return this[U].url}get status(){return this[U].status}get ok(){return this[U].status>=200&&this[U].status<300}get statusText(){return this[U].statusText}get headers(){return this[U].headers}clone(){return new q(A(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok})}}x.mixIn(q.prototype),Object.defineProperties(q.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(q.prototype,Symbol.toStringTag,{value:\"Response\",writable:!1,enumerable:!1,configurable:!0});const W=Symbol(\"Request internals\"),V=m.parse,K=m.format,Z=\"destroy\"in f.Readable.prototype;function J(e){return\"object\"==typeof e&&\"object\"==typeof e[W]}class G{constructor(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};J(e)?t=V(e.url):(t=e&&e.href?V(e.href):V(`${e}`),e={});let r=n.method||e.method||\"GET\";if(r=r.toUpperCase(),(null!=n.body||J(e)&&null!==e.body)&&(\"GET\"===r||\"HEAD\"===r))throw new TypeError(\"Request with GET/HEAD method cannot have body\");let i=null!=n.body?n.body:J(e)&&null!==e.body?A(e):null;x.call(this,i,{timeout:n.timeout||e.timeout||0,size:n.size||e.size||0});const s=new B(n.headers||e.headers||{});if(null!=n.body){const e=function(e){const t=e.body;return null===t?null:\"string\"==typeof t?\"text/plain;charset=UTF-8\":E(t)?\"application/x-www-form-urlencoded;charset=UTF-8\":t instanceof b?t.type||null:Buffer.isBuffer(t)?null:\"[object ArrayBuffer]\"===Object.prototype.toString.call(t)?null:ArrayBuffer.isView(t)?null:\"function\"==typeof t.getBoundary?`multipart/form-data;boundary=${t.getBoundary()}`:null}(this);null===e||s.has(\"Content-Type\")||s.append(\"Content-Type\",e)}let o=J(e)?e.signal:null;if(\"signal\"in n&&(o=n.signal),null!=o&&!function(e){const t=e&&\"object\"==typeof e&&Object.getPrototypeOf(e);return!(!t||\"AbortSignal\"!==t.constructor.name)}(o))throw new TypeError(\"Expected signal to be an instanceof AbortSignal\");this[W]={method:r,redirect:n.redirect||e.redirect||\"follow\",headers:s,parsedURL:t,signal:o},this.follow=void 0!==n.follow?n.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==n.compress?n.compress:void 0===e.compress||e.compress,this.counter=n.counter||e.counter||0,this.agent=n.agent||e.agent}get method(){return this[W].method}get url(){return K(this[W].parsedURL)}get headers(){return this[W].headers}get redirect(){return this[W].redirect}get signal(){return this[W].signal}clone(){return new G(this)}}function Y(e){Error.call(this,e),this.type=\"aborted\",this.message=e,Error.captureStackTrace(this,this.constructor)}x.mixIn(G.prototype),Object.defineProperty(G.prototype,Symbol.toStringTag,{value:\"Request\",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(G.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),Y.prototype=Object.create(Error.prototype),Y.prototype.constructor=Y,Y.prototype.name=\"AbortError\";const X=f.PassThrough,Q=m.resolve;function ee(e,t){if(!ee.Promise)throw new Error(\"native promise missing, set fetch.Promise to your favorite alternative\");return x.Promise=ee.Promise,new ee.Promise(function(n,r){const i=new G(e,t),s=function(e){const t=e[W].parsedURL,n=new B(e[W].headers);if(n.has(\"Accept\")||n.set(\"Accept\",\"*/*\"),!t.protocol||!t.hostname)throw new TypeError(\"Only absolute URLs are supported\");if(!/^https?:$/.test(t.protocol))throw new TypeError(\"Only HTTP(S) protocols are supported\");if(e.signal&&e.body instanceof f.Readable&&!Z)throw new Error(\"Cancellation of streamed requests with AbortSignal is not supported in node < 8\");let r=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(r=\"0\"),null!=e.body){const t=O(e);\"number\"==typeof t&&(r=String(t))}return r&&n.set(\"Content-Length\",r),n.has(\"User-Agent\")||n.set(\"User-Agent\",\"node-fetch/1.0 (+https://github.com/bitinn/node-fetch)\"),e.compress&&!n.has(\"Accept-Encoding\")&&n.set(\"Accept-Encoding\",\"gzip,deflate\"),n.has(\"Connection\")||e.agent||n.set(\"Connection\",\"close\"),Object.assign({},t,{method:e.method,headers:L(n),agent:e.agent})}(i),o=(\"https:\"===s.protocol?g:p).request,a=i.signal;let l=null;const c=function(){let e=new Y(\"The user aborted a request.\");r(e),i.body&&i.body instanceof f.Readable&&i.body.destroy(e),l&&l.body&&l.body.emit(\"error\",e)};if(a&&a.aborted)return void c();const h=function(){c(),m()},u=o(s);let d;function m(){u.abort(),a&&a.removeEventListener(\"abort\",h),clearTimeout(d)}a&&a.addEventListener(\"abort\",h),i.timeout&&u.once(\"socket\",function(e){d=setTimeout(function(){r(new w(`network timeout at: ${i.url}`,\"request-timeout\")),m()},i.timeout)}),u.on(\"error\",function(e){r(new w(`request to ${i.url} failed, reason: ${e.message}`,\"system\",e)),m()}),u.on(\"response\",function(e){clearTimeout(d);const t=function(e){const t=new B;for(const n of Object.keys(e))if(!I.test(n))if(Array.isArray(e[n]))for(const r of e[n])R.test(r)||(void 0===t[j][n]?t[j][n]=[r]:t[j][n].push(r));else R.test(e[n])||(t[j][n]=[e[n]]);return t}(e.headers);if(ee.isRedirect(e.statusCode)){const s=t.get(\"Location\"),o=null===s?null:Q(i.url,s);switch(i.redirect){case\"error\":return r(new w(`redirect mode is set to error: ${i.url}`,\"no-redirect\")),void m();case\"manual\":if(null!==o)try{t.set(\"Location\",o)}catch(e){r(e)}break;case\"follow\":if(null===o)break;if(i.counter>=i.follow)return r(new w(`maximum redirect reached at: ${i.url}`,\"max-redirect\")),void m();const s={headers:new B(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal};return 303!==e.statusCode&&i.body&&null===O(i)?(r(new w(\"Cannot follow redirect with body being a readable stream\",\"unsupported-redirect\")),void m()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||\"POST\"!==i.method)||(s.method=\"GET\",s.body=void 0,s.headers.delete(\"content-length\")),n(ee(new G(o,s))),void m())}}e.once(\"end\",function(){a&&a.removeEventListener(\"abort\",h)});let s=e.pipe(new X);const o={url:i.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:i.size,timeout:i.timeout},c=t.get(\"Content-Encoding\");if(!i.compress||\"HEAD\"===i.method||null===c||204===e.statusCode||304===e.statusCode)return l=new q(s,o),void n(l);const u={flush:y.Z_SYNC_FLUSH,finishFlush:y.Z_SYNC_FLUSH};if(\"gzip\"==c||\"x-gzip\"==c)return s=s.pipe(y.createGunzip(u)),l=new q(s,o),void n(l);if(\"deflate\"!=c&&\"x-deflate\"!=c)l=new q(s,o),n(l);else{e.pipe(new X).once(\"data\",function(e){s=8==(15&e[0])?s.pipe(y.createInflate()):s.pipe(y.createInflateRaw()),l=new q(s,o),n(l)})}}),function(e,t){const n=t.body;null===n?e.end():\"string\"==typeof n?(e.write(n),e.end()):E(n)?(e.write(Buffer.from(String(n))),e.end()):n instanceof b?(e.write(n[_]),e.end()):Buffer.isBuffer(n)?(e.write(n),e.end()):\"[object ArrayBuffer]\"===Object.prototype.toString.call(n)?(e.write(Buffer.from(n)),e.end()):ArrayBuffer.isView(n)?(e.write(Buffer.from(n.buffer,n.byteOffset,n.byteLength)),e.end()):n.pipe(e)}(u,i)})}ee.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},ee.Promise=global.Promise;var te=ee,ne=n(69),re=n.n(ne);\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst ie=[\"Text\",\"URL\",\"Number\",\"Boolean\"];class se{static convert(e,t){const n=JSON.parse(e),r={},i={};n[\"@graph\"]||(n[\"@graph\"]=[n]);for(const e of n[\"@graph\"])\"rdf:Property\"===e[\"@type\"]?i[e[\"@id\"]]=e:\"rdfs:Class\"===e[\"@type\"]&&(r[e[\"@id\"]]=e,e.subclasses=[],e.superclass=null);for(const e of Object.values(r))if(void 0!==e[\"rdfs:subClassOf\"]){null==e[\"rdfs:subClassOf\"].length&&(e[\"rdfs:subClassOf\"]=[e[\"rdfs:subClassOf\"]]);for(const t of e[\"rdfs:subClassOf\"]){const n=t[\"@id\"];null==e.superclass&&(e.superclass=[]),r[n]?(r[n].subclasses.push(e),e.superclass.push(r[n])):e.superclass.push({\"@id\":n})}}for(const e of Object.values(r))0===e.subclasses.length&&null==t&&(t=e);const s=[];for(const e of Object.values(i)){let n=e[\"schema:domainIncludes\"];if(n||(n={\"@id\":t[\"@id\"]}),n.length||(n=[n]),(n=n.map(e=>e[\"@id\"])).includes(t[\"@id\"])){const t=e[\"@id\"].split(\":\")[1];let n=e[\"schema:rangeIncludes\"];n||console.log(e),n.length||(n=[n]),(n=(n=n.map(e=>e[\"@id\"].split(\":\")[1])).filter(e=>ie.includes(e))).length>0&&s.push({name:t,type:n})}}const o=t[\"@id\"].split(\":\")[1],a=t&&t.superclass?t.superclass.map(e=>e[\"@id\"].split(\":\")[1]):[];let l=\"\";for(const e of a)l+=`import 'https://schema.org/${e}'\\n\\n`;if(l+=`schema ${o}`,a.length>0&&(l+=` extends ${a.join(\", \")}`),s.length>0)for(const e of s){let t;l+=`\\n  ${t=e.type.length>1?\"(\"+e.type.join(\" or \")+\")\":e.type[0]} ${e.name}`}return l+=\"\\n\"}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */const oe=()=>Object.create(null),ae=e=>(class extends e{constructor(){super(),this._pendingProps=oe(),this._props=this._getInitialProps()||oe(),this._lastProps=oe(),this._state=this._getInitialState()||oe(),this._lastState=oe()}_getInitialProps(){}_getInitialState(){}_getProperty(e){return this._pendingProps[e]||this._props[e]}_setProperty(e,t){(this._validator||this._wouldChangeProp(e,t))&&(this._pendingProps[e]=t,this._invalidateProps())}_wouldChangeValue(e,t,n){return e[t]!==n}_wouldChangeProp(e,t){return this._wouldChangeValue(this._props,e,t)}_wouldChangeState(e,t){return this._wouldChangeValue(this._state,e,t)}_setProps(e){Object.assign(this._pendingProps,e),this._invalidateProps()}_invalidateProps(){this._propsInvalid=!0,this._invalidate()}_setImmutableState(e,t){\"object\"==typeof e&&(console.warn(\"Xen:: _setImmutableState takes name and value args for a single property, dictionaries not supported.\"),t=Object.values(e)[0],e=Object.names(e)[0]),\"object\"==typeof t&&(t=Object.assign(Object.create(null),t)),this._state[e]=t,this._invalidate()}_setState(e){let t=!1;const n=this._state;for(const r in e){const i=e[r];this._wouldChangeState(r,i)&&(t=!0,n[r]=i)}if(t)return this._invalidate(),!0}_async(e){return Promise.resolve().then(e.bind(this))}_invalidate(){this._validator||(this._validator=this._async(this._validate))}_getStateArgs(){return[this._props,this._state,this._lastProps,this._lastState]}_validate(){const e=this._getStateArgs();try{Object.assign(this._props,this._pendingProps),this._propsInvalid&&(this._willReceiveProps(...e),this._propsInvalid=!1),this._shouldUpdate(...e)&&(this._ensureMount(),this._doUpdate(...e))}catch(e){console.error(e)}this._validator=null,this._lastProps=Object.assign(oe(),this._props),this._lastState=Object.assign(oe(),this._state)}_doUpdate(...e){this._update(...e),this._didUpdate(...e)}_ensureMount(){}_willReceiveProps(){}_shouldUpdate(){return!0}_update(){}_didUpdate(){}_debounce(e,t,n){e=`_debounce_${e}`,this._state[e]=((e,t,n)=>{if(e&&clearTimeout(e),t&&n)return setTimeout(t,n)})(this._state[e],t,null!=n?n:16)}});class le extends Error{constructor(e,t,n,r){super(),this.cause=e,this.method=t,this.particleId=n,this.particleName=r,this.stack+=`\\nCaused by: ${this.cause.stack}`}toLiteral(){return{exceptionType:this.constructor.name,cause:{name:this.cause.name,message:this.cause.message,stack:this.cause.stack},method:this.method,particleId:this.particleId,particleName:this.particleName,stack:this.stack}}static fromLiteral(e){const t=e.cause;let n;switch(e.exceptionType){case ce.name:n=new ce(t,e.method,e.particleId,e.particleName);break;case he.name:n=new he(t,e.method,e.particleId,e.particleName);break;default:throw new Error(`Unknown exception type: ${e.exceptionType}`)}return n.stack=e.stack,n}}class ce extends le{get message(){const e=this.particleName?this.particleName:this.particleId;return`SystemException: exception ${this.cause.name} raised when invoking system function ${this.method} on behalf of particle ${e}: ${this.cause.message}`}}class he extends le{get message(){const e=this.particleName?this.particleName:this.particleId;return`UserException: exception ${this.cause.name} raised when invoking function ${this.method} on particle ${e}: ${this.cause.message}`}}const ue=[];var de,fe;de=(e=>{throw console.log(e.method,e.particleName),e}),ue.includes(de)||ue.push(de),function(e){e.Dom=\"dom\",e.DomTouch=\"dom-touch\",e.Vr=\"vr\",e.Voice=\"voice\"}(fe||(fe={}));class pe{constructor(e){this.names=e}static create(e){return d()(e.every(e=>pe.all.names.includes(e)),`Unsupported modality in: ${e}`),new pe(e)}intersection(e){return new pe(this.names.filter(t=>e.names.includes(t)))}isResolved(){return this.names.length>0}isCompatible(e){return this.intersection(pe.create(e)).isResolved()}static get Name(){return fe}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nfunction me(e){return Le.fromLiteral(e)}function ge(e){return\"object\"==typeof e?me(e):e}function ye({type:e,name:t,direction:n}){return{type:e?me(e):void 0,name:t?ge(t):void 0,direction:n}}function _e({name:e,direction:t,isRequired:n,isSet:r}){return{name:e?ge(e):void 0,direction:t,isRequired:n,isSet:r}}function ve(e){return e instanceof He?e.toLiteral():e}function be({type:e,name:t,direction:n}){return{type:e?e.toLiteral():void 0,name:t?ve(t):void 0,direction:n}}function we({name:e,direction:t,isRequired:n,isSet:r}){return{name:e?ve(e):void 0,direction:t,isRequired:n,isSet:r}}pe.all=new pe([pe.Name.Dom,pe.Name.DomTouch,pe.Name.Vr,pe.Name.Voice]),pe.dom=new pe([pe.Name.Dom]),pe.domTouch=new pe([pe.Name.DomTouch]),pe.voice=new pe([pe.Name.Voice]),pe.vr=new pe([pe.Name.Vr]);const Se=[\"type\",\"name\",\"direction\"],ke=[\"name\",\"direction\",\"isRequired\",\"isSet\"];class Ce{constructor(e,t,n){d()(e),d()(void 0!==t),d()(void 0!==n),this.name=e,this.handles=t,this.slots=n,this.typeVars=[];for(const e of t)for(const t of Se)Ce.isTypeVar(e[t])&&this.typeVars.push({object:e,field:t});for(const e of n)for(const t of ke)Ce.isTypeVar(e[t])&&this.typeVars.push({object:e,field:t})}toPrettyString(){return\"InterfaceInfo\"}mergeTypeVariablesByName(e){this.typeVars.map(({object:t,field:n})=>t[n]=t[n].mergeTypeVariablesByName(e))}get canReadSubset(){return this._cloneAndUpdate(e=>e.canReadSubset)}get canWriteSuperset(){return this._cloneAndUpdate(e=>e.canWriteSuperset)}isMoreSpecificThan(e){if(this.handles.length!==e.handles.length||this.slots.length!==e.slots.length)return!1;for(let t=0;t<this.typeVars.length;t++){const n=this.typeVars[t],r=e.typeVars[t];if(!n.object[n.field].isMoreSpecificThan(r.object[r.field]))return!1}return!0}_applyExistenceTypeTest(e){for(const t of this.typeVars)if(e(t.object[t.field]))return!0;return!1}_handlesToManifestString(){return this.handles.map(e=>`  ${e.direction?e.direction+\" \":\"\"}${e.type.toString()} ${e.name?e.name:\"*\"}`).join(\"\\n\")}_slotsToManifestString(){return this.slots.map(e=>`  ${e.direction} ${e.isSet?\"set of \":\"\"}${e.name?e.name+\" \":\"\"}`).join(\"\\n\")}toString(){return`interface ${this.name}\\n${this._handlesToManifestString()}\\n${this._slotsToManifestString()}`}static fromLiteral(e){const t=e.handles.map(ye),n=e.slots.map(_e);return new Ce(e.name,t,n)}toLiteral(){const e=this.handles.map(be),t=this.slots.map(we);return{name:this.name,handles:e,slots:t}}clone(e){const t=this.handles.map(({name:t,direction:n,type:r})=>({name:t,direction:n,type:r?r.clone(e):void 0})),n=this.slots.map(({name:e,direction:t,isRequired:n,isSet:r})=>({name:e,direction:t,isRequired:n,isSet:r}));return new Ce(this.name,t,n)}cloneWithResolutions(e){return this._cloneWithResolutions(e)}_cloneWithResolutions(e){const t=this.handles.map(({name:t,direction:n,type:r})=>({name:t,direction:n,type:r?r._cloneWithResolutions(e):void 0})),n=this.slots.map(({name:e,direction:t,isRequired:n,isSet:r})=>({name:e,direction:t,isRequired:n,isSet:r}));return new Ce(this.name,t,n)}canEnsureResolved(){for(const e of this.typeVars)if(!e.object[e.field].canEnsureResolved())return!1;return!0}maybeEnsureResolved(){for(const e of this.typeVars){let t=e.object[e.field];if(!(t=t.clone(new Map)).maybeEnsureResolved())return!1}for(const e of this.typeVars)e.object[e.field].maybeEnsureResolved();return!0}tryMergeTypeVariablesWith(e){if(!this._equalItems(e.slots,this.slots,this._equalSlot))return null;if(e.handles.length!==this.handles.length)return null;const t=new Set(this.handles),n=new Set(e.handles),r=new Map;let i=t.size;for(;t.size>0;){const e=[...t.values()].map(e=>({handle:e,match:[...n.values()].filter(t=>this._equalHandle(e,t))}));for(const i of e){if(0===i.match.length)return null;1===i.match.length&&(r.set(i.handle,i.match[0]),n.delete(i.match[0]),t.delete(i.handle))}if(t.size===i)return null;i=t.size}const s=[];for(const e of this.handles){const t=r.get(e);let n;if(e.type.hasVariable||t.type.hasVariable){if(!(n=Xe._tryMergeTypeVariable(e.type,t.type)))return null}else n=e.type||t.type;s.push({name:e.name||t.name,direction:e.direction||t.direction,type:n})}const o=this.slots.map(({name:e,direction:t,isRequired:n,isSet:r})=>({name:e,direction:t,isRequired:n,isSet:r}));return new Ce(this.name,s,o)}resolvedType(){return this._cloneAndUpdate(e=>e.resolvedType())}equals(e){return this.handles.length===e.handles.length&&(!!this._equalItems(e.handles,this.handles,this._equalHandle)&&!!this._equalItems(e.slots,this.slots,this._equalSlot))}_equalHandle(e,t){return e.name===t.name&&e.direction===t.direction&&Xe.compareTypes({type:e.type},{type:t.type})}_equalSlot(e,t){return e.name===t.name&&e.direction===t.direction&&e.isRequired===t.isRequired&&e.isSet===t.isSet}_equalItems(e,t,n){for(const r of e){let e=!1;for(const i of t)if(n(i,r)){e=!0;break}if(!e)return!1}return!0}_cloneAndUpdate(e){const t=this.clone(new Map);return t.typeVars.forEach(t=>Ce._updateTypeVar(t,e)),t}static _updateTypeVar(e,t){e.object[e.field]=t(e.object[e.field])}static isTypeVar(e){return e instanceof He||e instanceof Le&&e.hasVariable}static mustMatch(e){return!(null==e||Ce.isTypeVar(e))}static handlesMatch(e,t){if(Ce.mustMatch(e.name)&&e.name!==t.name)return!1;if(Ce.mustMatch(e.direction)&&e.direction!==t.direction)return!1;if(null==e.type)return!0;const[n,r]=Le.unwrapPair(e.type,t.type);return n instanceof He?[{var:n,value:r,direction:e.direction}]:Xe.compareTypes({type:n},{type:r})}static slotsMatch(e,t){return(!Ce.mustMatch(e.name)||e.name===t.name)&&((!Ce.mustMatch(e.direction)||e.direction===t.direction)&&((!Ce.mustMatch(e.isRequired)||e.isRequired===t.isRequired)&&(!Ce.mustMatch(e.isSet)||e.isSet===t.isSet)))}particleMatches(e){return!1!==this.cloneWithResolutions(new Map).restrictType(e)}restrictType(e){return this._restrictThis(e)}_restrictThis(e){const t=this.handles.map(t=>e.handleConnections.map(e=>({match:e,result:Ce.handlesMatch(t,e)})).filter(e=>!1!==e.result)),n=[];e.slotConnections.forEach(e=>{n.push({name:e.name,direction:\"consume\",isRequired:e.isRequired,isSet:e.isSet}),e.provideSlotConnections.forEach(e=>{n.push({name:e.name,direction:\"provide\",isRequired:!1,isSet:e.isSet})})});const r=this.slots.map(e=>n.filter(t=>Ce.slotsMatch(e,t))).map(e=>e.map(e=>({match:e,result:!0})));function i(e,t){if(0===e.length)return[];const n=e.pop();for(const r of n){if(t.includes(r.match))continue;const n=t.slice();n.push(r.match);const s=i(e,n);if(!1!==s)return\"boolean\"==typeof r.result?s:s.concat(r.result)}return!1}const s=i(t,[]),o=i(r,[]);if(!1===s||!1===o)return!1;for(const e of s)if(e.var.variable.resolution){if(e.var.variable.resolution instanceof He){if(!Xe.processTypeList(e.var,[{type:e.value,direction:e.direction}]))return!1}else if(!Xe.compareTypes({type:e.var.variable.resolution},{type:e.value}))return!1}else e.var.variable.resolution=e.value;return!0}}\n// @license\nconst xe={identifier:Symbol(\"id\")};\n/** @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */var Te;!function(e){e[e.Unstored=0]=\"Unstored\",e[e.Stored=1]=\"Stored\"}(Te||(Te={}));class Ee{constructor(e,t,n){this.entity=null,this.storageProxy=null,this.handle=null,this.id=e.id,this.storageKey=e.storageKey,this.context=n,this.type=t}async ensureStorageProxy(){null==this.storageProxy&&(this.storageProxy=await this.context.getStorageProxy(this.storageKey,this.type.referredType),this.handle=yt(this.storageProxy,this.context.idGenerator),this.storageKey?d()(this.storageKey===this.storageProxy.storageKey):this.storageKey=this.storageProxy.storageKey)}async dereference(){return d()(this.context,\"Must have context to dereference\"),this.entity?this.entity:(await this.ensureStorageProxy(),this.entity=await this.handle.get(this.id),this.entity)}dataClone(){return{storageKey:this.storageKey,id:this.id}}serialize(){return{id:this.id,rawData:this.dataClone()}}}class Ae extends Ee{constructor(e,t){super({id:e.id,storageKey:null},new Je(e.entityClass.type),t),this.mode=Te.Unstored,this.entity=e,this.stored=new Promise(async(t,n)=>{await this.storeReference(e),t()})}async storeReference(e){await this.ensureStorageProxy(),await this.handle.store(e),this.mode=Te.Stored}async dereference(){return this.mode===Te.Unstored?null:super.dereference()}isIdentified(){return this.entity.isIdentified()}static newClientReference(e){return class extends Ae{constructor(t){super(t,e)}}}}\n// @license\nclass Oe{constructor(e,t,n,r){this._mutable=!0,d()(!r||-1===r.indexOf(\":\"),\"user IDs must not contain the ':' character\"),je(this,void 0),this.userIDComponent=r,this.schema=t,this.context=n,d()(e,\"can't construct entity with null data\"),this.rawData=$e(e,t,n)}get mutable(){return this._mutable}set mutable(e){if(!this.mutable&&e)throw new Error(\"You cannot make an immutable entity mutable again.\");this._mutable=e}mutate(e){if(!this.mutable)throw new Error(\"Entity is immutable.\");let t;\"function\"==typeof e?e(t=this.dataClone()):t=e,this.rawData=$e(t,this.schema,this.context)}getUserID(){return this.userIDComponent}isIdentified(){return void 0!==Pe(this)}get id(){return d()(!!this.isIdentified()),Pe(this)}identify(e){d()(!this.isIdentified()),je(this,e);const t=e.split(\":\"),n=t.lastIndexOf(\"uid\");this.userIDComponent=n>0?t.slice(n+1).join(\":\"):\"\"}createIdentity(e,t){let n;d()(!this.isIdentified()),je(this,n=this.userIDComponent?`${e.toString()}:uid:${this.userIDComponent}`:t.newChildId(e).toString())}toLiteral(){return this.rawData}toJSON(){return this.rawData}dataClone(){const e={},t=this.schema.fields;for(const n of Object.keys(t))void 0!==this.rawData[n]&&(t[n]&&\"schema-reference\"===t[n].kind?this.rawData[n]&&(e[n]=this.rawData[n].dataClone()):t[n]&&\"schema-collection\"===t[n].kind?this.rawData[n]&&(e[n]=[...this.rawData[n]].map(e=>e.dataClone())):e[n]=this.rawData[n]);return e}serialize(){return{id:Pe(this),rawData:this.dataClone()}}static createEntityClass(e,t){const n=class extends Oe{constructor(n,r){super(n,e,t,r)}get entityClass(){return n}static get type(){return new Ue(e)}static get key(){return{tag:\"entity\",schema:e}}static get schema(){return e}};Object.defineProperty(n,\"name\",{value:e.name});for(const t of Object.keys(e.fields))Object.defineProperty(n.prototype,t,{get(){return this.rawData[t]},set(e){this.rawData[t]=e}});return n}}function Ie(e,t){switch(e.type){case\"Text\":case\"URL\":return\"string\";case\"Number\":return\"number\";case\"Boolean\":return\"boolean\";case\"Bytes\":return\"Uint8Array\";case\"Object\":return\"object\";default:throw new Error(`Unknown field type ${e.type} in schema ${t}`)}}function Re({op:e,name:t,value:n,schema:r,fieldType:i}){if(void 0===(i=i||r.fields[t]))throw new Error(`Can't ${e} field ${t}; not in schema ${r.name}`);if(null!=n)switch(i.kind){case\"schema-primitive\":if((\"Uint8Array\"===n.constructor.name?\"Uint8Array\":typeof n)!==Ie(i,r.name))throw new TypeError(`Type mismatch ${e}ting field ${t} (type ${i.type}); `+`value '${n}' is type ${typeof n}`);break;case\"schema-union\":for(const e of i.types)if(typeof n===Ie(e,r.name))return;throw new TypeError(`Type mismatch ${e}ting field ${t} (union [${i.types}]); `+`value '${n}' is type ${typeof n}`);case\"schema-tuple\":if(!Array.isArray(n))throw new TypeError(`Cannot ${e} tuple ${t} with non-array value '${n}'`);if(n.length!==i.types.length)throw new TypeError(`Length mismatch ${e}ting tuple ${t} `+`[${i.types}] with value '${n}'`);i.types.map((s,o)=>{if(void 0!==n[o]&&null!==n[o]&&typeof n[o]!==Ie(s,r.name))throw new TypeError(`Type mismatch ${e}ting field ${t} (tuple [${i.types}]); `+`value '${n}' has type ${typeof n[o]} at index ${o}`)});break;case\"schema-reference\":if(!(n instanceof Ee))throw new TypeError(`Cannot ${e} reference ${t} with non-reference '${n}'`);if(!Xe.compareTypes({type:n.type},{type:new Je(i.schema.model)}))throw new TypeError(`Cannot ${e} reference ${t} with value '${n}' of mismatched type`);break;case\"schema-collection\":if(\"Set\"!==n.constructor.name)throw new TypeError(`Cannot ${e} collection ${t} with non-Set '${n}'`);for(const s of n)Re({op:e,name:t,value:s,schema:r,fieldType:i.schema});break;default:throw new Error(`Unknown kind ${i.kind} in schema ${r.name}`)}}function Ne(e,t,n,r){if(!e)return t;if(\"schema-reference\"===e.kind&&t){if(t instanceof Ee)return t;if(t.id&&t.storageKey)return new Ee(t,new Je(e.schema.model),r);throw new TypeError(`Cannot set reference ${n} with non-reference '${t}'`)}if(\"schema-collection\"===e.kind&&t){if(\"Set\"===t.constructor.name)return t;if(t.length&&t instanceof Object)return new Set(t.map(t=>Ne(e.schema,t,n,r)));throw new TypeError(`Cannot set collection ${n} with non-collection '${t}'`)}return t}function $e(e,t,n){const r=[\"toJSON\",\"prototype\",\"toString\",\"inspect\"],i=function(e,t,n){const r={};for(const[i,s]of Object.entries(e)){const e=Ne(t.fields[i],s,i,n);Re({op:\"set\",name:i,value:e,schema:t}),r[i]=e}return r}(e,t,n);return new Proxy(i,{get:(e,n)=>{if(r.includes(n)||n.constructor===Symbol)return;const i=e[n];return Re({op:\"get\",name:n,value:i,schema:t}),i},set:(e,t,n)=>{throw new Error(`Tried to modify entity field '${t}'. Use the mutate method instead.`)}})}function Pe(e){return e[xe.identifier]}function je(e,t){e[xe.identifier]=t}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class Be{constructor(e,t,n){this.description={},this.names=e,this.fields={};for(const[e,n]of Object.entries(t))this.fields[e]=\"string\"==typeof n?{kind:\"schema-primitive\",type:n}:n;n&&n.description.forEach(e=>this.description[e.name]=e.pattern||e.patterns[0])}toLiteral(){const e={},t=e=>{if(\"schema-reference\"===e.kind){const t=e.schema;return{kind:\"schema-reference\",schema:{kind:t.kind,model:t.model.toLiteral()}}}return\"schema-collection\"===e.kind?{kind:\"schema-collection\",schema:t(e.schema)}:e};for(const n of Object.keys(this.fields))e[n]=t(this.fields[n]);return{names:this.names,fields:e,description:this.description}}static fromLiteral(e={fields:{},names:[],description:{}}){const t={},n=e=>{if(\"schema-reference\"===e.kind){const t=e.schema;return{kind:\"schema-reference\",schema:{kind:t.kind,model:Le.fromLiteral(t.model)}}}return\"schema-collection\"===e.kind?{kind:\"schema-collection\",schema:n(e.schema)}:e};for(const r of Object.keys(e.fields))t[r]=n(e.fields[r]);const r=new Be(e.names,t);return r.description=e.description||{},r}get name(){return this.names[0]}static typesEqual(e,t){return Be._typeString(e)===Be._typeString(t)}static _typeString(e){switch(e.kind){case\"schema-primitive\":return e.type;case\"schema-union\":return`(${e.types.map(e=>e.type).join(\" or \")})`;case\"schema-tuple\":return`(${e.types.map(e=>e.type).join(\", \")})`;case\"schema-reference\":return`Reference<${Be._typeString(e.schema)}>`;case\"type-name\":case\"schema-inline\":return e.model.entitySchema.toInlineSchemaString();case\"schema-collection\":return`[${Be._typeString(e.schema)}]`;default:throw new Error(`Unknown type kind ${e.kind} in schema ${this.name}`)}}static union(e,t){const n=[...new Set([...e.names,...t.names])],r={};for(const[n,i]of[...Object.entries(e.fields),...Object.entries(t.fields)])if(r[n]){if(!Be.typesEqual(r[n],i))return null}else r[n]=i;return new Be(n,r)}static intersect(e,t){const n=[...e.names].filter(e=>t.names.includes(e)),r={};for(const[n,i]of Object.entries(e.fields)){const e=t.fields[n];e&&Be.typesEqual(i,e)&&(r[n]=i)}return new Be(n,r)}equals(e){return this===e||this.name===e.name&&this.isMoreSpecificThan(e)&&e.isMoreSpecificThan(this)}isMoreSpecificThan(e){const t=new Set(this.names);for(const n of e.names)if(!t.has(n))return!1;const n={};for(const[e,t]of Object.entries(this.fields))n[e]=t;for(const[t,r]of Object.entries(e.fields)){if(null==n[t])return!1;if(!Be.typesEqual(n[t],r))return!1}return!0}get type(){return new Ue(this)}entityClass(e=null){return Oe.createEntityClass(this,e)}toInlineSchemaString(e){const t=this.names.join(\" \")||\"*\",n=Object.entries(this.fields).map(([e,t])=>`${Be._typeString(t)} ${e}`).join(\", \");return`${t} {${n.length>0&&e&&e.hideFields?\"...\":n}}`}toManifestString(){const e=[];if(e.push(`schema ${this.names.join(\" \")}`),e.push(...Object.entries(this.fields).map(([e,t])=>`  ${Be._typeString(t)} ${e}`)),Object.keys(this.description).length>0){e.push(`  description \\`${this.description.pattern}\\``);for(const t of Object.keys(this.description))\"pattern\"!==t&&e.push(`    ${t} \\`${this.description[t]}\\``)}return e.join(\"\\n\")}}\n// @license\nclass Me{constructor(e,t){this.formFactor=e,this.handle=t}toLiteral(){return this}static fromLiteral({formFactor:e,handle:t}){return new Me(e,t)}}\n// @license\nclass De{constructor(e,t){this.id=e.toString(),this.serialization=t.replace(/\\bimport .*\\n/g,\"\")}static extractSerialization(e){return e.serialization.replace(/\\bimport .*\\n/g,\"\")}}class ze{constructor(e,t,n,r){this.id=e,this.storageKey=t,this.type=n,this.tags=r}}\n// @license\nclass Fe{constructor(e,t,n){this.name=e,this._canWriteSuperset=t,this._canReadSubset=n,this._resolution=null}maybeMergeConstraints(e){return!!this.maybeMergeCanReadSubset(e.canReadSubset)&&this.maybeMergeCanWriteSuperset(e.canWriteSuperset)}maybeMergeCanReadSubset(e){if(null==e)return!0;if(null==this.canReadSubset)return this.canReadSubset=e,!0;if(this.canReadSubset instanceof Ze&&e instanceof Ze)return!0;if(this.canReadSubset instanceof Ue&&e instanceof Ue){const t=Be.intersect(this.canReadSubset.entitySchema,e.entitySchema);return!!t&&(this.canReadSubset=new Ue(t),!0)}return!1}maybeMergeCanWriteSuperset(e){if(null==e)return!0;if(null==this.canWriteSuperset)return this.canWriteSuperset=e,!0;if(this.canWriteSuperset instanceof Ze&&e instanceof Ze)return!0;if(this.canWriteSuperset instanceof Ue&&e instanceof Ue){const t=Be.union(this.canWriteSuperset.entitySchema,e.entitySchema);return!!t&&(this.canWriteSuperset=new Ue(t),!0)}return!1}isSatisfiedBy(e){const t=this._canWriteSuperset;if(!t)return!0;if(!(t instanceof Ue&&e instanceof Ue))throw new Error(`constraint checking not implemented for ${this} and ${e}`);return e.getEntitySchema().isMoreSpecificThan(t.getEntitySchema())}get resolution(){return this._resolution?this._resolution.resolvedType():null}isValidResolutionCandidate(e){const t=e.resolvedType().getContainedType();return t instanceof He&&t.variable===this?{result:!1,detail:\"variable cannot resolve to collection of itself\"}:{result:!0}}set resolution(e){d()(!this._resolution);const t=this.isValidResolutionCandidate(e);d()(t.result,t.detail);let n=e;for(;n&&n instanceof He;){if(n.variable===this)return;n=n.variable.resolution}this._resolution=e,this._canWriteSuperset=null,this._canReadSubset=null}get canWriteSuperset(){return this._resolution?(d()(!this._canWriteSuperset),this._resolution instanceof He?this._resolution.variable.canWriteSuperset:null):this._canWriteSuperset}set canWriteSuperset(e){d()(!this._resolution),this._canWriteSuperset=e}get canReadSubset(){return this._resolution?(d()(!this._canReadSubset),this._resolution instanceof He?this._resolution.variable.canReadSubset:null):this._canReadSubset}set canReadSubset(e){d()(!this._resolution),this._canReadSubset=e}get hasConstraint(){return null!==this._canReadSubset||null!==this._canWriteSuperset}canEnsureResolved(){return this._resolution?this._resolution.canEnsureResolved():!(!this._canWriteSuperset&&!this._canReadSubset)}maybeEnsureResolved(){return this._resolution?this._resolution.maybeEnsureResolved():this._canWriteSuperset?(this.resolution=this._canWriteSuperset,!0):!!this._canReadSubset&&(this.resolution=this._canReadSubset,!0)}toLiteral(){return d()(null==this.resolution),this.toLiteralIgnoringResolutions()}toLiteralIgnoringResolutions(){return{name:this.name,canWriteSuperset:this._canWriteSuperset&&this._canWriteSuperset.toLiteral(),canReadSubset:this._canReadSubset&&this._canReadSubset.toLiteral()}}static fromLiteral(e){return new Fe(e.name,e.canWriteSuperset?Le.fromLiteral(e.canWriteSuperset):null,e.canReadSubset?Le.fromLiteral(e.canReadSubset):null)}isResolved(){return this._resolution&&this._resolution.isResolved()}}\n// @license\nclass Le{constructor(e){this.tag=e}static fromLiteral(e){switch(e.tag){case\"Entity\":return new Ue(Be.fromLiteral(e.data));case\"TypeVariable\":return new He(Fe.fromLiteral(e.data));case\"Collection\":return new qe(Le.fromLiteral(e.data));case\"BigCollection\":return new We(Le.fromLiteral(e.data));case\"Relation\":return new Ve(e.data.map(e=>Le.fromLiteral(e)));case\"Interface\":return new Ke(Ce.fromLiteral(e.data));case\"Slot\":return new Ze(Me.fromLiteral(e.data));case\"Reference\":return new Je(Le.fromLiteral(e.data));case\"Arc\":return new Ge;case\"Handle\":return new Ye;default:throw new Error(`fromLiteral: unknown type ${e}`)}}static unwrapPair(e,t){if(e.tag===t.tag){const n=e.getContainedType();if(null!==n)return Le.unwrapPair(n,t.getContainedType())}return[e,t]}static canMergeConstraints(e,t){return Le._canMergeCanReadSubset(e,t)&&Le._canMergeCanWriteSuperset(e,t)}static _canMergeCanReadSubset(e,t){if(e.canReadSubset&&t.canReadSubset){if(e.canReadSubset.tag!==t.canReadSubset.tag)return!1;if(e.canReadSubset instanceof Ue)return null!==Be.intersect(e.canReadSubset.entitySchema,t.canReadSubset.entitySchema);throw new Error(`_canMergeCanReadSubset not implemented for types tagged with ${e.canReadSubset.tag}`)}return!0}static _canMergeCanWriteSuperset(e,t){if(e.canWriteSuperset&&t.canWriteSuperset){if(e.canWriteSuperset.tag!==t.canWriteSuperset.tag)return!1;if(e.canWriteSuperset instanceof Ue)return null!==Be.union(e.canWriteSuperset.entitySchema,t.canWriteSuperset.entitySchema)}return!0}isCollectionType(){return this instanceof qe}isBigCollectionType(){return this instanceof We}isResolved(){return!this.hasUnresolvedVariable}mergeTypeVariablesByName(e){return this}_applyExistenceTypeTest(e){return e(this)}get hasVariable(){return this._applyExistenceTypeTest(e=>e instanceof He)}get hasUnresolvedVariable(){return this._applyExistenceTypeTest(e=>e instanceof He&&!e.variable.isResolved())}getContainedType(){return null}isTypeContainer(){return!1}collectionOf(){return new qe(this)}bigCollectionOf(){return new We(this)}resolvedType(){return this}canEnsureResolved(){return this.isResolved()||this._canEnsureResolved()}_canEnsureResolved(){return!0}maybeEnsureResolved(){return!0}get canWriteSuperset(){throw new Error(`canWriteSuperset not implemented for ${this}`)}get canReadSubset(){throw new Error(`canReadSubset not implemented for ${this}`)}isMoreSpecificThan(e){return this.tag===e.tag&&this._isMoreSpecificThan(e)}_isMoreSpecificThan(e){throw new Error(`isMoreSpecificThan not implemented for ${this}`)}clone(e){return this.resolvedType()._clone(e)}_clone(e){return Le.fromLiteral(this.toLiteral())}_cloneWithResolutions(e){return Le.fromLiteral(this.toLiteral())}hasProperty(e){return e(this)||this._hasProperty(e)}_hasProperty(e){return!1}toString(e){return this.tag}getEntitySchema(){return null}toPrettyString(){return null}}class Ue extends Le{constructor(e){super(\"Entity\"),this.entitySchema=e}static make(e,t,n){return new Ue(new Be(e,t,n))}get isEntity(){return!0}get canWriteSuperset(){return this}get canReadSubset(){return this}_isMoreSpecificThan(e){return this.entitySchema.isMoreSpecificThan(e.entitySchema)}toLiteral(){return{tag:this.tag,data:this.entitySchema.toLiteral()}}toString(e){return this.entitySchema.toInlineSchemaString(e)}getEntitySchema(){return this.entitySchema}_cloneWithResolutions(e){if(e.has(this.entitySchema))return e.get(this.entitySchema);const t=new Ue(this.entitySchema);return e.set(this.entitySchema,t),t}toPrettyString(){return this.entitySchema.description.pattern?this.entitySchema.description.pattern:this.entitySchema.name?this.entitySchema.name.replace(/([^A-Z])([A-Z])/g,\"$1 $2\").replace(/([A-Z][^A-Z])/g,\" $1\").replace(/[\\s]+/g,\" \").trim():JSON.stringify(this.entitySchema.toLiteral())}}class He extends Le{constructor(e){super(\"TypeVariable\"),this.variable=e}static make(e,t,n){return new He(new Fe(e,t,n))}get isVariable(){return!0}mergeTypeVariablesByName(e){const t=this.variable.name;let n=e.get(t);if(n){if(n instanceof He&&(n.variable.hasConstraint||this.variable.hasConstraint)){if(!n.variable.maybeMergeConstraints(this.variable))throw new Error(\"could not merge type variables\")}}else n=this,e.set(t,this);return n}resolvedType(){return this.variable.resolution||this}_canEnsureResolved(){return this.variable.canEnsureResolved()}maybeEnsureResolved(){return this.variable.maybeEnsureResolved()}get canWriteSuperset(){return this.variable.canWriteSuperset}get canReadSubset(){return this.variable.canReadSubset}_clone(e){const t=this.variable.name;if(e.has(t))return new He(e.get(t));{const n=Fe.fromLiteral(this.variable.toLiteral());return e.set(t,n),new He(n)}}_cloneWithResolutions(e){if(e.has(this.variable))return new He(e.get(this.variable));{const t=Fe.fromLiteral(this.variable.toLiteralIgnoringResolutions());return this.variable.resolution&&(t._resolution=this.variable._resolution._cloneWithResolutions(e)),this.variable._canReadSubset&&(t.canReadSubset=this.variable.canReadSubset._cloneWithResolutions(e)),this.variable._canWriteSuperset&&(t.canWriteSuperset=this.variable.canWriteSuperset._cloneWithResolutions(e)),e.set(this.variable,t),new He(t)}}toLiteral(){return this.variable.resolution?this.variable.resolution.toLiteral():{tag:this.tag,data:this.variable.toLiteral()}}toString(e){return`~${this.variable.name}`}getEntitySchema(){return this.variable.isResolved()?this.resolvedType().getEntitySchema():null}toPrettyString(){return this.variable.isResolved()?this.resolvedType().toPrettyString():`[~${this.variable.name}]`}}class qe extends Le{constructor(e){super(\"Collection\"),this.collectionType=e}get isCollection(){return!0}mergeTypeVariablesByName(e){const t=this.collectionType,n=t.mergeTypeVariablesByName(e);return n===t?this:n.collectionOf()}_applyExistenceTypeTest(e){return this.collectionType._applyExistenceTypeTest(e)}getContainedType(){return this.collectionType}isTypeContainer(){return!0}resolvedType(){const e=this.collectionType,t=e.resolvedType();return e!==t?t.collectionOf():this}_canEnsureResolved(){return this.collectionType.canEnsureResolved()}maybeEnsureResolved(){return this.collectionType.maybeEnsureResolved()}_clone(e){const t=this.collectionType.clone(e).toLiteral();return Le.fromLiteral({tag:this.tag,data:t})}_cloneWithResolutions(e){return new qe(this.collectionType._cloneWithResolutions(e))}toLiteral(){return{tag:this.tag,data:this.collectionType.toLiteral()}}_hasProperty(e){return this.collectionType.hasProperty(e)}toString(e){return`[${this.collectionType.toString(e)}]`}getEntitySchema(){return this.collectionType.getEntitySchema()}toPrettyString(){const e=this.getEntitySchema();return e&&e.description.plural?e.description.plural:`${this.collectionType.toPrettyString()} List`}}class We extends Le{constructor(e){super(\"BigCollection\"),this.bigCollectionType=e}get isBigCollection(){return!0}mergeTypeVariablesByName(e){const t=this.bigCollectionType,n=t.mergeTypeVariablesByName(e);return n===t?this:n.bigCollectionOf()}_applyExistenceTypeTest(e){return this.bigCollectionType._applyExistenceTypeTest(e)}getContainedType(){return this.bigCollectionType}isTypeContainer(){return!0}resolvedType(){const e=this.bigCollectionType,t=e.resolvedType();return e!==t?t.bigCollectionOf():this}_canEnsureResolved(){return this.bigCollectionType.canEnsureResolved()}maybeEnsureResolved(){return this.bigCollectionType.maybeEnsureResolved()}_clone(e){const t=this.bigCollectionType.clone(e).toLiteral();return Le.fromLiteral({tag:this.tag,data:t})}_cloneWithResolutions(e){return new We(this.bigCollectionType._cloneWithResolutions(e))}toLiteral(){return{tag:this.tag,data:this.bigCollectionType.toLiteral()}}_hasProperty(e){return this.bigCollectionType.hasProperty(e)}toString(e){return`BigCollection<${this.bigCollectionType.toString(e)}>`}getEntitySchema(){return this.bigCollectionType.getEntitySchema()}toPrettyString(){const e=this.getEntitySchema();return e&&e.description.plural?e.description.plural:`Collection of ${this.bigCollectionType.toPrettyString()}`}}class Ve extends Le{constructor(e){super(\"Relation\"),this.relationEntities=e}get isRelation(){return!0}toLiteral(){return{tag:this.tag,data:this.relationEntities.map(e=>e.toLiteral())}}toPrettyString(){return JSON.stringify(this.relationEntities)}}class Ke extends Le{constructor(e){super(\"Interface\"),this.interfaceInfo=e}static make(e,t,n){return new Ke(new Ce(e,t,n))}get isInterface(){return!0}mergeTypeVariablesByName(e){const t=this.interfaceInfo.clone(new Map);return t.mergeTypeVariablesByName(e),new Ke(t)}_applyExistenceTypeTest(e){return this.interfaceInfo._applyExistenceTypeTest(e)}resolvedType(){return new Ke(this.interfaceInfo.resolvedType())}_canEnsureResolved(){return this.interfaceInfo.canEnsureResolved()}maybeEnsureResolved(){return this.interfaceInfo.maybeEnsureResolved()}get canWriteSuperset(){return new Ke(this.interfaceInfo.canWriteSuperset)}get canReadSubset(){return new Ke(this.interfaceInfo.canReadSubset)}_isMoreSpecificThan(e){return this.interfaceInfo.isMoreSpecificThan(e.interfaceInfo)}_clone(e){const t=this.interfaceInfo.clone(e).toLiteral();return Le.fromLiteral({tag:this.tag,data:t})}_cloneWithResolutions(e){return new Ke(this.interfaceInfo._cloneWithResolutions(e))}toLiteral(){return{tag:this.tag,data:this.interfaceInfo.toLiteral()}}toString(e){return this.interfaceInfo.name}toPrettyString(){return this.interfaceInfo.toPrettyString()}}class Ze extends Le{constructor(e){super(\"Slot\"),this.slot=e}static make(e,t){return new Ze(new Me(e,t))}get isSlot(){return!0}get canWriteSuperset(){return this}get canReadSubset(){return this}_isMoreSpecificThan(e){return!0}toLiteral(){return{tag:this.tag,data:this.slot.toLiteral()}}toString(e){const t=[];for(const e of Object.keys(this.slot))void 0!==this.slot[e]&&t.push(`${e}:${this.slot[e]}`);let n=\"\";return 0!==t.length&&(n=` {${t.join(\", \")}}`),`Slot${n}`}toPrettyString(){const e=[];for(const t of Object.keys(this.slot))void 0!==this.slot[t]&&e.push(`${t}:${this.slot[t]}`);let t=\"\";return 0!==e.length&&(t=` {${e.join(\", \")}}`),`Slot${t}`}}class Je extends Le{constructor(e){super(\"Reference\"),this.referredType=e}get isReference(){return!0}getContainedType(){return this.referredType}isTypeContainer(){return!0}resolvedType(){const e=this.referredType,t=e.resolvedType();return e!==t?new Je(t):this}_canEnsureResolved(){return this.referredType.canEnsureResolved()}maybeEnsureResolved(){return this.referredType.maybeEnsureResolved()}get canReadSubset(){return this.referredType.canReadSubset}_clone(e){const t=this.referredType.clone(e).toLiteral();return Le.fromLiteral({tag:this.tag,data:t})}_cloneWithResolutions(e){return new Je(this.referredType._cloneWithResolutions(e))}toLiteral(){return{tag:this.tag,data:this.referredType.toLiteral()}}toString(e){return\"Reference<\"+this.referredType.toString()+\">\"}}class Ge extends Le{constructor(){super(\"Arc\")}get isArc(){return!0}newInstance(e,t){return new De(e,t)}toLiteral(){return{tag:this.tag}}}class Ye extends Le{constructor(){super(\"Handle\")}get isHandle(){return!0}toLiteral(){return{tag:this.tag}}}class Xe{static processTypeList(e,t){const n=He.make(\"\",null,null);e&&(n.variable.resolution=e),e=n;const r=[];for(const n of t)if(n.type.resolvedType().hasVariable){if(null==(e=Xe._tryMergeTypeVariable(e,n.type)))return null}else r.push(n);for(const t of r)if(!Xe._tryMergeConstraints(e,t))return null;const i=e=>e instanceof He?null==e.canReadSubset||null==e.canWriteSuperset?e:e.canReadSubset.isMoreSpecificThan(e.canWriteSuperset)?(e.canWriteSuperset.isMoreSpecificThan(e.canReadSubset)&&(e.variable.resolution=e.canReadSubset),e):null:e,s=e.resolvedType();if(s.isCollectionType()){const e=i(s.collectionType);return null!==e?e.collectionOf():null}if(s.isBigCollectionType()){const e=i(s.bigCollectionType);return null!==e?e.bigCollectionOf():null}return i(s)}static _tryMergeTypeVariable(e,t){const[n,r]=Le.unwrapPair(e.resolvedType(),t.resolvedType());if(n instanceof He){if(r instanceof He){if(!1===n.variable.maybeMergeConstraints(r.variable))return null;r.variable.resolution=n}else{if(!n.variable.isValidResolutionCandidate(r).result)return null;n.variable.resolution=r}return e}if(r instanceof He)return r.variable.isValidResolutionCandidate(n).result?(r.variable.resolution=n,t):null;if(n instanceof Ke&&r instanceof Ke){const e=n.interfaceInfo.tryMergeTypeVariablesWith(r.interfaceInfo);return null==e?null:new Ke(e)}if(n.isTypeContainer()&&n.hasVariable||r.isTypeContainer()&&r.hasVariable)return null;throw new Error(\"tryMergeTypeVariable shouldn't be called on two types without any type variables\")}static _tryMergeConstraints(e,{type:t,direction:n}){let[r,i]=Le.unwrapPair(e.resolvedType(),t.resolvedType());if(r instanceof He){for(;i.isTypeContainer();){if(null!=r.variable.resolution||null!=r.variable.canReadSubset||null!=r.variable.canWriteSuperset)return!1;const e=He.make(\"a\",null,null);r.variable.resolution=i instanceof qe?new qe(e):i instanceof We?new We(e):new Je(e);const t=Le.unwrapPair(r.resolvedType(),i);if([r,i]=t,!(r instanceof He))throw new TypeError(\"unwrapping a wrapped TypeVariable somehow didn't become a TypeVariable\")}if((\"out\"===n||\"inout\"===n||\"`provide\"===n)&&!r.variable.maybeMergeCanReadSubset(i.canWriteSuperset))return!1;if((\"in\"===n||\"inout\"===n||\"`consume\"===n)&&!r.variable.maybeMergeCanWriteSuperset(i.canReadSubset))return!1}else{if(i.tag!==r.tag)return!1;if((\"out\"===n||\"inout\"===n)&&!Xe._writeConstraintsApply(r,i))return!1;if((\"in\"===n||\"inout\"===n)&&!Xe._readConstraintsApply(r,i))return!1}return!0}static _writeConstraintsApply(e,t){const n=t.canWriteSuperset;return null==n||null==e.canReadSubset||!!n.isMoreSpecificThan(e.canReadSubset)}static _readConstraintsApply(e,t){const n=t.canReadSubset;return null==n||null==e.canWriteSuperset||!!e.canWriteSuperset.isMoreSpecificThan(n)}static compareTypes(e,t){const n=e.type.resolvedType(),r=t.type.resolvedType(),[i,s]=Le.unwrapPair(n,r);if(i instanceof He&&s.isTypeContainer())return!(i.variable.canReadSubset||i.variable.canWriteSuperset);if(s instanceof He&&i.isTypeContainer())return!(s.variable.canReadSubset||s.variable.canWriteSuperset);if(i instanceof He||s instanceof He)return Le.canMergeConstraints(i,s);if(void 0===i!=(void 0===s))return!1;if(i===s)return!0;if(i.tag!==s.tag)return!1;if(i instanceof Ze)return!0;if(i instanceof Ke&&s instanceof Ke&&i.interfaceInfo.equals(s.interfaceInfo))return!0;if(!(i instanceof Ue&&s instanceof Ue))return!1;const o=i.entitySchema.isMoreSpecificThan(s.entitySchema),a=s.entitySchema.isMoreSpecificThan(i.entitySchema);if(a&&o)return!0;if(!a&&!o)return!1;const[l,c]=a?[e,t]:[t,e],h=l.direction||(l.connection?l.connection.direction:\"inout\"),u=c.direction||(c.connection?c.connection.direction:\"inout\");return\"in\"===h||\"out\"===u}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */function Qe(e){return e instanceof Le?e:Le.fromLiteral(e)}function et(e){return e instanceof Le?e.toLiteral():e}class tt{constructor(e,t){this.parentConnection=null,this.rawData=e,this.direction=e.direction,this.name=e.name,this.type=Qe(e.type).mergeTypeVariablesByName(t),this.isOptional=e.isOptional,this.tags=e.tags||[],this.dependentConnections=[]}instantiateDependentConnections(e,t){for(const n of this.rawData.dependentConnections){const r=e.createConnection(n,t);r.parentConnection=this,this.dependentConnections.push(r)}}get isInput(){return\"in\"===this.direction||\"inout\"===this.direction||\"host\"===this.direction}get isOutput(){return\"out\"===this.direction||\"inout\"===this.direction}isCompatibleType(e){return Xe.compareTypes({type:e},{type:this.type,direction:this.direction})}}class nt{constructor(e){this.name=e.name,this.isRequired=e.isRequired||!1,this.isSet=e.isSet||!1,this.tags=e.tags||[],this.formFactor=e.formFactor,this.handles=e.handles||[],this.provideSlotConnections=[],e.provideSlotConnections&&e.provideSlotConnections.forEach(e=>{this.provideSlotConnections.push(new rt(e))})}get isOptional(){return!this.isRequired}get direction(){return\"`consume\"}get type(){return Ze.make(this.formFactor,null)}get dependentConnections(){return this.provideSlotConnections}}class rt extends nt{}class it{constructor(e){this.model=e,this.name=e.name,this.verbs=e.verbs;const t=new Map;this.handleConnectionMap=new Map,e.args.forEach(e=>this.createConnection(e,t)),e.description=e.description||{},this.validateDescription(e.description),this.pattern=e.description.pattern,this.handleConnectionMap.forEach((t,n)=>{t.pattern=e.description[n]}),this.implFile=e.implFile,this.implBlobUrl=e.implBlobUrl,this.modality=pe.create(e.modality||[]),this.slotConnections=new Map,e.slotConnections&&e.slotConnections.forEach(e=>this.slotConnections.set(e.name,new nt(e))),this.slotConnections.forEach(e=>{e.provideSlotConnections.forEach(e=>{e.handles.forEach(e=>d()(this.handleConnectionMap.has(e),\"Cannot provide slot for nonexistent handle constraint \"+e))})})}createConnection(e,t){const n=new tt(e,t);return this.handleConnectionMap.set(n.name,n),n.instantiateDependentConnections(this,t),n}get handleConnections(){return this.connections}get connections(){return[...this.handleConnectionMap.values()]}get inputs(){return this.connections.filter(e=>e.isInput)}get outputs(){return this.connections.filter(e=>e.isOutput)}isInput(e){const t=this.handleConnectionMap.get(e);return t&&t.isInput}isOutput(e){const t=this.handleConnectionMap.get(e);return t&&t.isOutput}getConnectionByName(e){return this.handleConnectionMap.get(e)}getSlotSpec(e){return this.slotConnections.get(e)}get primaryVerb(){return this.verbs.length>0?this.verbs[0]:void 0}isCompatible(e){return 0===this.slotConnections.size||this.modality.intersection(e).isResolved()}setImplBlobUrl(e){this.model.implBlobUrl=this.implBlobUrl=e}toLiteral(){const{args:e,name:t,verbs:n,description:r,implFile:i,implBlobUrl:s,modality:o,slotConnections:a}=this.model,l=({type:e,direction:t,name:n,isOptional:r,dependentConnections:i})=>({type:et(e),direction:t,name:n,isOptional:r,dependentConnections:i.map(l)});return{args:e.map(e=>l(e)),name:t,verbs:n,description:r,implFile:i,implBlobUrl:s,modality:o,slotConnections:a}}static fromLiteral(e){let{args:t,name:n,verbs:r,description:i,implFile:s,implBlobUrl:o,modality:a,slotConnections:l}=e;const c=({type:e,direction:t,name:n,isOptional:r,dependentConnections:i})=>({type:Qe(e),direction:t,name:n,isOptional:r,dependentConnections:i?i.map(c):[]});return t=t.map(c),new it({args:t,name:n,verbs:r||[],description:i,implFile:s,implBlobUrl:o,modality:a,slotConnections:l})}clone(){return it.fromLiteral(this.toLiteral())}cloneWithResolutions(e){const t=this.clone();return this.handleConnectionMap.forEach((n,r)=>{t.handleConnectionMap.get(r).type=n.type._cloneWithResolutions(e)}),t}equals(e){return JSON.stringify(this.toLiteral())===JSON.stringify(e.toLiteral())}validateDescription(e){Object.keys(e||[]).forEach(e=>{d()([\"kind\",\"location\",\"pattern\"].includes(e)||this.handleConnectionMap.has(e),`Unexpected description for ${e}`)})}toInterface(){d()(!this.slotConnections.size,\"please implement slots toInterface\");const e=this.model.args.map(({type:e,name:t,direction:n})=>({type:Qe(e),name:t,direction:n}));return Ke.make(this.name,e,[])}toString(){const e=[];let t=\"\";this.verbs.length>0&&(t=\" \"+this.verbs.map(e=>`&${e}`).join(\" \")),e.push(`particle ${this.name}${t} in '${this.implFile}'`.trim());const n=(t,r)=>{const i=t.tags.map(e=>` #${e}`).join(\"\");e.push(`${r}${t.direction}${t.isOptional?\"?\":\"\"} ${t.type.toString()} ${t.name}${i}`);for(const e of t.dependentConnections)n(e,r+\"  \")};for(const e of this.handleConnections)e.parentConnection||n(e,\"  \");return this.modality.names.forEach(t=>e.push(`  modality ${t}`)),this.slotConnections.forEach(t=>{const n=[];t.isRequired&&n.push(\"must\"),n.push(\"consume\"),t.isSet&&n.push(\"set of\"),n.push(t.name),t.tags.length>0&&n.push(t.tags.map(e=>`#${e}`).join(\" \")),e.push(`  ${n.join(\" \")}`),t.formFactor&&e.push(`    formFactor ${t.formFactor}`),t.provideSlotConnections.forEach(t=>{const n=[];t.isRequired&&n.push(\"must\"),n.push(\"provide\"),t.isSet&&n.push(\"set of\"),n.push(t.name),t.tags.length>0&&n.push(t.tags.map(e=>`#${e}`).join(\" \")),e.push(`    ${n.join(\" \")}`),t.formFactor&&e.push(`      formFactor ${t.formFactor}`),t.handles.forEach(t=>e.push(`      handle ${t}`))})}),this.pattern&&(e.push(`  description \\`${this.pattern}\\``),this.handleConnectionMap.forEach(t=>{t.pattern&&e.push(`    ${t.name} \\`${t.pattern}\\``)})),e.join(\"\\n\")}toManifestString(){return this.toString()}}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class st{}const ot=new class extends st{next(){return Math.random()}};class at{static next(){return ot.next()}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class lt{constructor(e){this._nextComponentId=0,this._currentSessionId=e}static newSession(){const e=Math.floor(at.next()*Math.pow(2,50))+\"\";return new lt(e)}static createWithSessionIdForTesting(e){return new lt(e)}newArcId(e){return ht._newArcIdInternal(this._currentSessionId,e)}newChildId(e,t=\"\"){return t+=this._nextComponentId++,ct._newIdInternal(this._currentSessionId,[...e.idTree,t])}get currentSessionIdForTesting(){return this._currentSessionId}}class ct{constructor(e,t=[]){this.idTree=[],this.root=e,this.idTree=t}static _newIdInternal(e,t=[]){return new ct(e,t)}static fromString(e){const t=e.split(\":\");if(t[0].startsWith(\"!\")){const e=t[0].slice(1),n=t.slice(1).filter(e=>e.length>0);return new ct(e,n)}return new ct(\"\",t)}toString(){return`!${this.root}:${this.idTree.join(\":\")}`}idTreeAsString(){return this.idTree.join(\":\")}equal(e){if(e.root!==this.root||e.idTree.length!==this.idTree.length)return!1;for(let t=0;t<e.idTree.length;t++)if(e.idTree[t]!==this.idTree[t])return!1;return!0}}class ht extends ct{static _newArcIdInternal(e,t){return new ht(e,[t])}static newForTest(e){return lt.newSession().newArcId(e)}}\n/** @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */function ut(e,t){d()(t,\"Handles need entity classes for deserialization\");const{id:n,rawData:r}=e,i=new t(r);return e.id&&i.identify(e.id),i}class dt{constructor(e,t,n,r,i,s){d()(!(e instanceof dt)),this.storage=e,this.idGenerator=t,this.name=n||this.storage.name,this.canRead=i,this.canWrite=s,this._particleId=r,this.options={keepSynced:!0,notifySync:!0,notifyUpdate:!0,notifyDesync:!1}}reportUserExceptionInHost(e,t,n){this.storage.reportExceptionInHost(new he(e,n,this._particleId,t.spec.name))}reportSystemExceptionInHost(e,t){this.storage.reportExceptionInHost(new ce(e,t,this._particleId))}configure(e){d()(this.canRead,\"configure can only be called on readable Handles\");try{const t=Object.keys(this.options),n=Object.keys(e).filter(e=>!t.includes(e));if(n.length>0)throw new Error(`Invalid option in Handle.configure(): ${n}`);Object.assign(this.options,e)}catch(e){throw this.reportSystemExceptionInHost(e,\"Handle::configure\"),e}}_serialize(e){return d()(e,\"can't serialize a null entity\"),e instanceof Oe&&(e.isIdentified()||e.createIdentity(ct.fromString(this._id),this.idGenerator)),e.serialize()}get type(){return this.storage.type}get _id(){return this.storage.id}toManifestString(){return`'${this._id}'`}generateKey(){return this.idGenerator.newChildId(ct.fromString(this._id),\"key\").toString()}}class ft extends dt{_notify(e,t,n){switch(d()(this.canRead,\"_notify should not be called for non-readable handles\"),e){case\"sync\":try{t.onHandleSync(this,this._restore(n))}catch(e){this.reportUserExceptionInHost(e,t,\"onHandleSync\")}return;case\"update\":{const e={};return\"add\"in n&&(e.added=this._restore(n.add)),\"remove\"in n&&(e.removed=this._restore(n.remove)),e.originator=n.originatorId===this._particleId,void t.onHandleUpdate(this,e)}case\"desync\":return void t.onHandleDesync(this);default:throw new Error(\"unsupported\")}}async get(e){if(!this.canRead)throw new Error(\"Handle not readable\");return this._restore([await this.storage.get(e)])[0]}async toList(){if(!this.canRead)throw new Error(\"Handle not readable\");return this._restore(await this.storage.toList())}_restore(e){return null!==e?e.map(e=>ut(e,this.entityClass)):null}async store(e){if(!this.canWrite)throw new Error(\"Handle not writeable\");const t=this._serialize(e),n=[this.generateKey()];return this.storage.store(t,n,this._particleId)}async clear(){if(!this.canWrite)throw new Error(\"Handle not writeable\");if(this.storage.clear)return this.storage.clear(this._particleId);throw new Error(\"clear not implemented by storage\")}async remove(e){if(!this.canWrite)throw new Error(\"Handle not writeable\");const t=this._serialize(e);this.storage.remove(t.id,[],this._particleId)}}class pt extends dt{async _notify(e,t,n){switch(d()(this.canRead,\"_notify should not be called for non-readable handles\"),e){case\"sync\":try{await t.onHandleSync(this,this._restore(n))}catch(e){this.reportUserExceptionInHost(e,t,\"onHandleSync\")}return;case\"update\":try{const e=this._restore(n.data),r=this._restore(n.oldData);await t.onHandleUpdate(this,{data:e,oldData:r})}catch(e){this.reportUserExceptionInHost(e,t,\"onHandleUpdate\")}return;case\"desync\":try{await t.onHandleDesync(this)}catch(e){this.reportUserExceptionInHost(e,t,\"onHandleDesync\")}return;default:throw new Error(\"unsupported\")}}async get(){if(!this.canRead)throw new Error(\"Handle not readable\");const e=await this.storage.get();return this._restore(e)}_restore(e){if(null==e)return null;if(this.type instanceof Ue)return ut(e,this.entityClass);if(this.type instanceof Ke)return it.fromLiteral(e);if(this.type instanceof Je)return new Ee(e,this.type,this.storage.pec);throw new Error(`Don't know how to deliver handle data of type ${this.type}`)}async set(e){try{if(!this.canWrite)throw new Error(\"Handle not writeable\");const t=this._serialize(e);return this.storage.set(t,this._particleId)}catch(e){throw this.reportSystemExceptionInHost(e,\"Handle::set\"),e}}async clear(){if(!this.canWrite)throw new Error(\"Handle not writeable\");return this.storage.clear(this._particleId)}}class mt{constructor(e,t){this._parent=e,this._cursorId=t}async next(){const e=await this._parent.storage.cursorNext(this._cursorId);return e.done||(e.value=e.value.map(e=>ut(e,this._parent.entityClass))),e}close(){this._parent.storage.cursorClose(this._cursorId)}}class gt extends dt{configure(e){throw new Error(\"BigCollections do not support sync/update configuration\")}async _notify(e,t,n){d()(this.canRead,\"_notify should not be called for non-readable handles\"),d()(\"sync\"===e,\"BigCollection._notify only supports sync events\"),await t.onHandleSync(this,[])}async store(e){if(!this.canWrite)throw new Error(\"Handle not writeable\");const t=this._serialize(e),n=[this.generateKey()];return this.storage.store(t,n,this._particleId)}async remove(e){if(!this.canWrite)throw new Error(\"Handle not writeable\");const t=this._serialize(e);this.storage.remove(t.id,[],this._particleId)}async stream({pageSize:e,forward:t=!0}){if(!this.canRead)throw new Error(\"Handle not readable\");if(isNaN(e)||e<1)throw new Error(\"Streamed reads require a positive pageSize\");const n=await this.storage.stream(e,t);return new mt(this,n)}}function yt(e,t,n=null,r=\"\",i=!0,s=!0){let o;o=e.type instanceof qe?new ft(e,t,n,r,i,s):e.type instanceof We?new gt(e,t,n,r,i,s):new pt(e,t,n,r,i,s);const a=e.type.getContainedType()||e.type;return a instanceof Ue&&(o.entityClass=a.entitySchema.entityClass(e.pec)),o}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class _t{constructor(){this.relevances=[],this._idle=Promise.resolve(),this._busy=0,this.slotProxiesByName=new Map,this.spec=this.constructor.spec,0===this.spec.inputs.length&&(this.extraData=!0)}setCapabilities(e){if(this.capabilities)throw new Error(\"capabilities should only be set once\");this.capabilities=e||{}}async setHandles(e){}async onHandleSync(e,t){}async onHandleUpdate(e,t){}async onHandleDesync(e){}async constructInnerArc(){if(!this.capabilities.constructInnerArc)throw new Error(\"This particle is not allowed to construct inner arcs\");return this.capabilities.constructInnerArc(this)}get busy(){return this._busy>0}get idle(){return this._idle}set relevance(e){this.relevances.push(e)}startBusy(){0===this._busy&&(this._idle=new Promise(e=>this._idleResolver=e)),this._busy++}doneBusy(){this._busy--,0===this._busy&&this._idleResolver()}inputs(){return this.spec.inputs}outputs(){return this.spec.outputs}hasSlotProxy(e){return this.slotProxiesByName.has(e)}addSlotProxy(e){this.slotProxiesByName.set(e.slotName,e)}removeSlotProxy(e){this.slotProxiesByName.delete(e)}async service(e){return this.capabilities.serviceRequest?new Promise(t=>{this.capabilities.serviceRequest(this,e,e=>t(e))}):(console.warn(`${this.spec.name} has no service support.`),null)}getSlot(e){return this.slotProxiesByName.get(e)}static buildManifest(e,...t){const n=[];for(let r=0;r<t.length;r++){const i=e[r],s=/ *$/.exec(i)[0];let o;o=(o=\"string\"==typeof t[r]?t[r]:t[r].toManifestString()).replace(/(\\n)/g,\"$1\"+s),n.push(i),n.push(o)}return e.length>t.length&&n.push(e[e.length-1]),n.join(\"\")}setParticleDescription(e){return this.setDescriptionPattern(\"pattern\",e)}setDescriptionPattern(e,t){const n=this.handles.get(\"descriptions\");if(n){const r=n.entityClass;return(n instanceof ft||n instanceof gt)&&n.store(new r({key:e,value:t},this.spec.name+\"-\"+e)),!0}throw new Error(\"A particle needs a description handle to set a decription pattern\")}renderSlot(e,t){}renderHostedSlot(e,t,n){}fireEvent(e,t){}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class vt extends _t{get template(){return\"\"}getTemplate(e){return this.template}getTemplateName(e){return\"default\"}shouldRender(e){return!0}render(e){return{}}renderSlot(e,t){const n=this._getStateArgs(),r=this.getSlot(e);if(r){if(this.currentSlotName=e,t.forEach(e=>r.requestedContentTypes.add(e)),this.shouldRender(...n)){const e={};if(r.requestedContentTypes.has(\"template\")&&(e.template=this.getTemplate(r.slotName)),r.requestedContentTypes.has(\"model\")&&(e.model=this.render(...n)),e.templateName=this.getTemplateName(r.slotName),r.providedSlots.size>0&&(e.template&&(\"string\"==typeof e.template?e.template=this.slotNamesToModelReferences(r,e.template):e.template=Object.entries(e.template).reduce((e,[t,n])=>(e[t]=this.slotNamesToModelReferences(r,n),e),{})),e.model)){const t={};r.providedSlots.forEach((e,n)=>t[`$${n}`]=e),e.model=this.enhanceModelWithSlotIDs(e.model,t)}r.render(e)}else r.isRendered&&r.render({});this.currentSlotName=void 0}}slotNamesToModelReferences(e,t){return e.providedSlots.forEach((e,n)=>{t=t.replace(new RegExp(`slotid=\"${n}\"`,\"gi\"),`slotname=\"${n}\" slotid$=\"{{$${n}}}\"`)}),t}enhanceModelWithSlotIDs(e,t,n=!0){n&&(e={...t,...e}),e.hasOwnProperty(\"$template\")&&e.hasOwnProperty(\"models\")&&Array.isArray(e.models)&&(e.models=e.models.map(e=>this.enhanceModelWithSlotIDs(e,t)));for(const[n,r]of Object.entries(e))r&&\"object\"==typeof r&&(e[n]=this.enhanceModelWithSlotIDs(r,t,!1));return e}_getStateArgs(){return[]}forceRenderTemplate(e=\"\"){this.slotProxiesByName.forEach((t,n)=>{e&&n!==e||t.requestedContentTypes.add(\"template\")})}fireEvent(e,{handler:t,data:n}){this[t]&&this[t]({data:n})}setParticleDescription(e){if(\"string\"==typeof e)return super.setParticleDescription(e);if(e.template&&e.model)return super.setDescriptionPattern(\"_template_\",e.template),void super.setDescriptionPattern(\"_model_\",JSON.stringify(e.model));throw new Error(\"Description pattern must either be string or have template and model\")}async clearHandle(e){const t=this.handles.get(e);if(!(t instanceof pt||t instanceof ft))throw new Error(\"Variable/Collection required\");t.clear()}async mergeEntitiesToHandle(e,t){const n={},r=this.handles.get(e);if(!(r instanceof ft))throw new Error(\"Collection required\");(await r.toList()).forEach(e=>n[e.id]=e);for(const e of t)n[e.id]||r.store(e)}async appendEntitiesToHandle(e,t){const n=this.handles.get(e);if(n){if(!(n instanceof ft||n instanceof gt))throw new Error(\"Collection required\");Promise.all(t.map(e=>n.store(e)))}}async appendRawDataToHandle(e,t){const n=this.handles.get(e);if(n&&n.entityClass){if(!(n instanceof ft||n instanceof gt))throw new Error(\"Collection required\");{const e=n.entityClass;Promise.all(t.map(t=>n.store(new e(t))))}}}updateVariable(e,t){const n=this.handles.get(e);if(n&&n.entityClass){if(n instanceof pt){const e=new(0,n.entityClass)(t);return n.set(e),e}throw new Error(\"Variable required\")}}async updateSet(e,t){const n=this.handles.get(e);if(n){if(!(n instanceof ft||n instanceof gt))throw new Error(\"Collection required\");await n.remove(t),await n.store(t)}}boxQuery(e,t){return e&&e.filter(e=>t===e.getUserID().split(\"|\")[0])}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class bt extends(ae(vt)){constructor(){super()}willReceiveProps(...e){}update(...e){}shouldRender(...e){return!0}render(...e){return{}}setState(e){return this._setState(e)}get state(){return this._state}set state(e){this.setState(e)}get props(){return this._props}configureHandles(e){}get config(){return{handleNames:this.spec.inputs.map(e=>e.name),slotNames:[...this.spec.slotConnections.values()].map(e=>e.name)}}_willReceiveProps(...e){this.willReceiveProps(...e)}_update(...e){this.update(...e),this.shouldRender(...e)&&(this.relevance=1),this.config.slotNames.forEach(e=>this.renderSlot(e,[\"model\"]))}get _views(){return console.warn(`Particle ${this.spec.name} uses deprecated _views getter.`),this.handles}async setHandles(e){this.configureHandles(e),this.handles=e,this._handlesToSync=new Set;for(const t of this.config.handleNames){const n=e.get(t);n&&n.options.keepSynced&&n.options.notifySync&&this._handlesToSync.add(t)}this._handlesToSync.size||this._invalidate()}async onHandleSync(e,t){this._handlesToSync.delete(e.name),0===this._handlesToSync.size&&await this._handlesToProps()}async onHandleUpdate(e,t){this._debounce(\"handleUpdateDebounce\",()=>{this._handlesToProps()},300)}async _handlesToProps(){const e=Object.create(null),{handleNames:t}=this.config;await Promise.all(t.map(t=>this._addNamedHandleData(e,t))),this._setProps(e)}async _addNamedHandleData(e,t){const n=this.handles.get(t);n&&(e[t]=await this._getHandleData(n))}async _getHandleData(e){return e instanceof ft?await e.toList():e instanceof pt?await e.get():e}fireEvent(e,{handler:t,data:n}){this[t]&&this[t]({data:n},this._state)}_debounce(e,t,n){const r=`_debounce_${e}`;this._state[r]||this.startBusy();super._debounce(e,()=>{this.doneBusy(),t(),this._state[r]=null},n)}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class wt extends bt{getTemplate(e){return this._state.template}getTemplateName(e){return this._state.templateName}render(e,t){return t.renderModel}shouldRender(e,t){return Boolean((t.template||t.templateName)&&t.renderModel)}renderHostedSlot(e,t,n){this.combineHostedTemplate(e,t,n),this.combineHostedModel(e,t,n)}combineHostedTemplate(e,t,n){}combineHostedModel(e,t,n){}static propsToItems(e){return e?e.map(({rawData:e,id:t})=>({...e,subId:t})):[]}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class St extends wt{constructor(){super(...arguments),this._itemSubIdByHostedSlotId=new Map,this._connByHostedConn=new Map}async _mapParticleConnections(e,t,n,r,i){const s=[],o=[];let a=2;const l=[e,t];for(const[e,t]of r){if(l.includes(e))continue;const r=t.storage;s.push(`use '${await i.mapHandle(r)}' as v${a}`);const c=n.handleConnections.find(e=>e.isCompatibleType(t.type));c&&(o.push(`${c.name} = v${a++}`),this._connByHostedConn.set(c.name,e))}return[s,o]}async setHandles(e){this.handleIds={};const t=await this.constructInnerArc(),n=e.get(\"hostedParticle\");let r=null,i=[],s=[];n&&(r=await n.get())&&([i,s]=await this._mapParticleConnections(\"list\",\"hostedParticle\",r,e,t)),this.setState({arc:t,type:e.get(\"list\").type,hostedParticle:r,otherMappedHandles:i,otherConnections:s}),await super.setHandles(e)}async willReceiveProps({list:e},{arc:t,type:n,hostedParticle:r,otherMappedHandles:i,otherConnections:s}){e.length>0&&(this.relevance=.1);for(const[o,a]of this.getListEntries(e)){let e=r;if(this.handleIds[a.id]){(await this.handleIds[a.id]).set(a);continue}const l=t.createHandle(n.getContainedType(),`item${o}`);this.handleIds[a.id]=l;const c=await l;if(!e){if(!a.renderParticleSpec)continue;e=it.fromLiteral(JSON.parse(a.renderParticleSpec));const n=\"list\",r=\"renderParticle\";[i,s]=await this._mapParticleConnections(n,r,e,this.handles,t)}const h=[...e.slotConnections.keys()][0],u=[...this.spec.slotConnections.values()][0].name,d=await t.createSlot(this,u,c._id);if(d){this._itemSubIdByHostedSlotId.set(d,a.id);try{const n=this.constructInnerRecipe(e,a,c,{name:h,id:d},{connections:s,handles:i});await t.loadRecipe(n),c.set(a)}catch(e){console.log(e)}}}}combineHostedModel(e,t,n){const r=this._itemSubIdByHostedSlotId.get(t);if(!r)return;const i=this._state.renderModel?this._state.renderModel.items:[],s=i.findIndex(e=>e.subId===r),o={...n.model,subId:r};s>=0&&s<i.length?i[s]=o:i.push(o),this._setState({renderModel:{items:i}})}combineHostedTemplate(e,t,n){const r=this._itemSubIdByHostedSlotId.get(t);if(!r)return;d()(n.templateName,`Template name is missing for slot '${e}' (hosted slot ID: '${t}')`);const i={...this._state.templateName,[r]:`${n.templateName}`};if(this._setState({templateName:i}),n.template){let e=n.template;e=e.replace(new RegExp('slotid=\"[a-z]+\"',\"gi\"),'$& subid$=\"{{subId}}\"'),this._connByHostedConn.forEach((t,n)=>{e=e.replace(new RegExp(`{{${n}.description}}`,\"g\"),`{{${t}.description}}`)}),this._setState({template:{...this._state.template,[n.templateName]:e}}),this.forceRenderTemplate()}}getListEntries(e){return e.entries()}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */const kt=(e,...t)=>(e[0]+t.map((t,n)=>t+e[n+1]).join(\"\")).trim();class Ct{path(e){return e.replace(/[\\/][^\\/]+$/,\"/\")}join(e,t){return/^https?:\\/\\//.test(t)?t:\"/\"===t[0]||\":\"===t[1]?t:(e=this.path(e),t=this.normalizeDots(`${e}${t}`))}normalizeDots(e){const t=e=>e.replace(/(?:^|\\/)[^.\\/]*\\/\\.\\./g,\"\");for(let n=t(e=(e=e.replace(/\\\\/g,\"/\")).replace(/\\/\\.\\//g,\"/\"));n!==e;n=t(e=n));return e=e.replace(/([^:])(\\/\\/)/g,\"$1/\")}async loadResource(e){return/^https?:\\/\\//.test(e)?this._loadURL(e):this._loadFile(e,\"utf-8\")}async loadBinary(e){return/^https?:\\/\\//.test(e)?te(e).then(e=>e.arrayBuffer()):this._loadFile(e,null)}async _loadFile(e,t){return new Promise((n,r)=>{o.a.readFile(e,{encoding:t},(e,i)=>{e?r(e):n(t?i:i.buffer)})})}async _loadURL(e){return/\\/\\/schema.org\\//.test(e)?e.endsWith(\"/Thing\")?te(\"https://schema.org/Product.jsonld\").then(e=>e.text()).then(e=>se.convert(e,{\"@id\":\"schema:Thing\"})):te(e+\".jsonld\").then(e=>e.text()).then(e=>se.convert(e)):te(e).then(e=>e.text())}async loadParticleClass(e){const t=await this.requireParticle(e.implFile);return t.spec=e,t}async requireParticle(e){null===e&&(e=\"\");const t=await this.loadResource(e),n=new re.a.Script(t,{filename:e,displayErrors:!0}),r=[],i={defineParticle(e){r.push(e)},console:console,fetch:te,setTimeout:setTimeout,importScripts:e=>null};return n.runInNewContext(i,{filename:e,displayErrors:!0}),d()(r.length>0&&\"function\"==typeof r[0],`Error while instantiating particle implementation from ${e}`),this.unwrapParticle(r[0])}setParticleExecutionContext(e){this.pec=e}unwrapParticle(e){return d()(this.pec),e({Particle:_t,DomParticle:bt,TransformationDomParticle:wt,MultiplexerDomParticle:St,Reference:Ae.newClientReference(this.pec),html:kt})}}class xt extends Error{static buildMessage(e,t){function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\\\/g,\"\\\\\\\\\").replace(/\"/g,'\\\\\"').replace(/\\0/g,\"\\\\0\").replace(/\\t/g,\"\\\\t\").replace(/\\n/g,\"\\\\n\").replace(/\\r/g,\"\\\\r\").replace(/[\\x00-\\x0F]/g,e=>\"\\\\x0\"+n(e)).replace(/[\\x10-\\x1F\\x7F-\\x9F]/g,e=>\"\\\\x\"+n(e))}function i(e){return e.replace(/\\\\/g,\"\\\\\\\\\").replace(/\\]/g,\"\\\\]\").replace(/\\^/g,\"\\\\^\").replace(/-/g,\"\\\\-\").replace(/\\0/g,\"\\\\0\").replace(/\\t/g,\"\\\\t\").replace(/\\n/g,\"\\\\n\").replace(/\\r/g,\"\\\\r\").replace(/[\\x00-\\x0F]/g,e=>\"\\\\x0\"+n(e)).replace(/[\\x10-\\x1F\\x7F-\\x9F]/g,e=>\"\\\\x\"+n(e))}function s(e){switch(e.type){case\"literal\":return'\"'+r(e.text)+'\"';case\"class\":const t=e.parts.map(e=>Array.isArray(e)?i(e[0])+\"-\"+i(e[1]):i(e));return\"[\"+(e.inverted?\"^\":\"\")+t+\"]\";case\"any\":return\"any character\";case\"end\":return\"end of input\";case\"other\":return e.description}}return\"Expected \"+function(e){const t=e.map(s);let n,r;if(t.sort(),t.length>0){for(n=1,r=1;n<t.length;n++)t[n-1]!==t[n]&&(t[r]=t[n],r++);t.length=r}switch(t.length){case 1:return t[0];case 2:return t[0]+\" or \"+t[1];default:return t.slice(0,-1).join(\", \")+\", or \"+t[t.length-1]}}(e)+\" but \"+((o=t)?'\"'+r(o)+'\"':\"end of input\")+\" found.\";var o}constructor(e,t,n,r){super(),this.message=e,this.expected=t,this.found=n,this.location=r,this.name=\"SyntaxError\",\"function\"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,xt)}}const Tt=function(e,t){t=void 0!==t?t:{};const n={},r={Manifest:ss};let i=ss;const s=function(e){const t=e.map(e=>{const t=e[2];return t.annotation=lo(e[0],e=>e[1],null),t});return function e(t){if(![\"string\",\"number\",\"boolean\"].includes(typeof t)&&null!==t){if(void 0===t)throw new xt(\"result was undefined\",[],\"\",Gi());if(Array.isArray(t))for(const n of t)e(n);else{if(t.model)throw new xt(`unexpected 'model' in ${JSON.stringify(t)}`,[],\"\",Gi());if(!t.location)throw new xt(`no 'location' in ${JSON.stringify(t)}`,[],\"\",Gi());if(!t.kind)throw new xt(`no 'kind' in ${JSON.stringify(t)}`,[],\"\",Gi());for(const n of Object.keys(t))[\"location\",\"kind\"].includes(n)||e(t[n])}}}(t),t},o=es(\"an annotation (e.g. @foo)\"),a=\"@\",l=Xi(\"@\",!1),c=function(e){return e},h=\"resource\",u=Xi(\"resource\",!1),d=function(e,t){return{kind:\"resource\",name:e,data:t,location:Gi()}},f=\"start\",p=Xi(\"start\",!1),m=function(){io=ro},g=function(e){return e.map(e=>e[0].substring(io.length)+e[1]).join(\"\")},y=/^[^\\n]/,_=Qi([\"\\n\"],!0,!1),v=function(){return Ji()},b=\"store\",w=Xi(\"store\",!1),S=\"of\",k=Xi(\"of\",!1),C=\"!!\",x=Xi(\"!!\",!1),T=function(e,t,n,r,i,s,o,a){return a=lo(a,ao,[]),{kind:\"store\",location:Gi(),name:e,type:t,id:lo(n,e=>e[1],null),originalId:lo(r,e=>e[1],null),version:lo(i,e=>e[1],null),tags:lo(s,e=>e[1],null),source:o.source,origin:o.origin,description:a.length>0?a[0][2]:null}},E=\"in\",A=Xi(\"in\",!1),O=function(e){return{origin:\"file\",source:e}},I=function(e){return{origin:\"resource\",source:e}},R=\"at\",N=Xi(\"at\",!1),$=function(e){return{origin:\"storage\",source:e}},P=\"description\",j=Xi(\"description\",!1),B=\"import\",M=Xi(\"import\",!1),D=function(e){return{kind:\"import\",location:Gi(),path:e}},z=es(\"an interface\"),F=\"interface\",L=Xi(\"interface\",!1),U=\"<\",H=Xi(\"<\",!1),q=\">\",W=Xi(\">\",!1),V=function(e,t,n){return{kind:\"interface\",location:Gi(),name:e,args:lo(n,ao,[]).filter(e=>\"interface-argument\"===e.kind),slots:lo(n,ao,[]).filter(e=>\"interface-slot\"===e.kind)}},K=\"*\",Z=Xi(\"*\",!1),J=function(e,t,n){return\"host\"===(e=lo(e,e=>e[0],null))&&Yi(\"Interface cannot have arguments with a 'host' direction.\"),{kind:\"interface-argument\",location:Gi(),direction:e,type:lo(t,e=>e[0],null),name:n}},G=\"must\",Y=Xi(\"must\",!1),X=\"consume\",Q=Xi(\"consume\",!1),ee=\"provide\",te=Xi(\"provide\",!1),ne=\"set of\",re=Xi(\"set of\",!1),ie=function(e,t,n,r){return{kind:\"interface-slot\",location:Gi(),name:lo(r,e=>r[1],null),isRequired:lo(e,e=>\"must\"===e[0],!1),direction:t,isSet:!!n}},se=\"meta\",oe=Xi(\"meta\",!1),ae=function(e){return{kind:\"meta\",items:e=e?ao(e):[],location:Gi()}},le=\"name\",ce=Xi(\"name\",!1),he=\":\",ue=Xi(\":\",!1),de=function(e){return{key:\"name\",value:e,location:Gi(),kind:\"name\"}},fe=\"storageKey\",pe=Xi(\"storageKey\",!1),me=function(e){return{key:\"storageKey\",value:e,location:Gi(),kind:\"storageKey\"}},ge=\"particle\",ye=Xi(\"particle\",!1),_e=function(e,t,n,r){let i=[];const s=[],o=[];let a=null,l=!1;return t=lo(t,e=>e[1],[]),(r=lo(r,ao,[])).forEach(n=>{\"particle-interface\"===n.kind?(/[A-Z]/.test(n.verb[0])&&n.verb!==e&&Yi(`Verb ${n.verb} must start with a lower case character or be same as particle name.`),t.push(n.verb),i=n.args,l=!0):\"particle-argument\"===n.kind?i.push(n):\"particle-slot\"===n.kind?o.push(n):\"description\"===n.kind?(a={kind:\"description\",location:Gi()},n.description.forEach(e=>a[e.name]=e.pattern||e.patterns[0])):n.modality?s.push(n.modality):Yi(`Particle ${e} contains an unknown element: ${n.name}`)}),0===s.length&&s.push(\"dom\"),{kind:\"particle\",location:Gi(),name:e,implFile:lo(n,e=>e[3],null),verbs:t,args:i,modality:s,slotConnections:o,description:a,hasParticleArgument:l}},ve=es(\"a particle item\"),be=function(e,t){return e.dependentConnections=lo(t,ao,[]),e},we=\"?\",Se=Xi(\"?\",!1),ke=function(e,t,n,r){return{kind:\"particle-argument\",location:Gi(),direction:e,type:n,isOptional:!!t,dependentConnections:[],name:r.name,tags:r.tags}},Ce=es(\"a direction (e.g. inout, in, out, host, `consume, `provide)\"),xe=\"inout\",Te=Xi(\"inout\",!1),Ee=\"out\",Ae=Xi(\"out\",!1),Oe=\"host\",Ie=Xi(\"host\",!1),Re=\"`consume\",Ne=Xi(\"`consume\",!1),$e=\"`provide\",Pe=Xi(\"`provide\",!1),je=function(){return Ji()},Be=\"[\",Me=Xi(\"[\",!1),De=\"]\",ze=Xi(\"]\",!1),Fe=function(e){return{kind:\"collection-type\",location:Gi(),type:e}},Le=\"BigCollection<\",Ue=Xi(\"BigCollection<\",!1),He=function(e){return{kind:\"big-collection-type\",location:Gi(),type:e}},qe=\"Reference<\",We=Xi(\"Reference<\",!1),Ve=function(e){return{kind:\"reference-type\",location:Gi(),type:e}},Ke=es(\"a type variable (e.g. ~foo)\"),Ze=\"~\",Je=Xi(\"~\",!1),Ge=\"with\",Ye=Xi(\"with\",!1),Xe=function(e,t){return{kind:\"variable-type\",location:Gi(),name:e,constraint:lo(t,e=>e[3],null)}},Qe=\"Slot\",et=Xi(\"Slot\",!1),tt=/^[^a-z0-9_]/i,nt=Qi([[\"a\",\"z\"],[\"0\",\"9\"],\"_\"],!0,!0),rt=\"{\",it=Xi(\"{\",!1),st=\",\",ot=Xi(\",\",!1),at=\"}\",lt=Xi(\"}\",!1),ct=function(e){return e=lo(e,e=>{const t=e[2];return[t[0]].concat(t[1].map(e=>e[2]))},[]),{kind:\"slot-type\",location:Gi(),fields:e}},ht=function(e,t){return{kind:\"slot-field\",location:Gi(),name:e,value:t}},ut=function(e){return{kind:\"type-name\",location:Gi(),name:e}},dt=function(e,t){return[e,...t.map(e=>e[2])]},ft=\"modality\",pt=Xi(\"modality\",!1),mt=function(e){return{kind:\"particle-modality\",location:Gi(),modality:e}},gt=\"dom-touch\",yt=Xi(\"dom-touch\",!1),_t=\"dom\",vt=Xi(\"dom\",!1),bt=\"vr\",wt=Xi(\"vr\",!1),St=\"voice\",kt=Xi(\"voice\",!1),Ct=\"mock-dom-touch\",Tt=Xi(\"mock-dom-touch\",!1),Et=\"mock-dom\",At=Xi(\"mock-dom\",!1),Ot=\"mock-vr\",It=Xi(\"mock-vr\",!1),Rt=\"mock-voice\",Nt=Xi(\"mock-voice\",!1),$t=function(e,t,n,r,i){let s=null;const o=[];return(i=lo(i,ao,[])).forEach(e=>{\"provided-slot\"===e.kind?o.push(e):\"form-factor\"===e.kind?(s&&Yi(\"duplicate form factor for a slot\"),s=e.formFactor):Yi(\"Unsupported particle slot item \",e)}),{kind:\"particle-slot\",location:Gi(),name:n,tags:lo(r,e=>e[1],[]),isRequired:lo(e,e=>\"must\"===e[0],!1),isSet:!!t,formFactor:s,provideSlotConnections:o}},Pt=\"formFactor\",jt=Xi(\"formFactor\",!1),Bt=\"fullscreen\",Mt=Xi(\"fullscreen\",!1),Dt=\"big\",zt=Xi(\"big\",!1),Ft=\"medium\",Lt=Xi(\"medium\",!1),Ut=\"small\",Ht=Xi(\"small\",!1),qt=function(e){return{kind:\"form-factor\",location:Gi(),formFactor:e}},Wt=function(e,t,n,r,i){let s=null;const o=[];return(i=i?ao(i):[]).forEach(e=>{\"form-factor\"===e.kind?(s&&Yi(\"duplicate form factor for a slot\"),s=e.formFactor):o.push(e.handle)}),{kind:\"provided-slot\",location:Gi(),name:n,tags:lo(r,e=>e[1],[]),isRequired:lo(e,e=>\"must\"===e[0],!1),isSet:!!t,formFactor:s,handles:o}},Vt=\"handle\",Kt=Xi(\"handle\",!1),Zt=function(e){return{kind:\"particle-provided-slot-handle\",location:Gi(),handle:e}},Jt=function(e,t){t=lo(t,ao,[]);const n=[];return e&&n.push(e),t.filter(e=>\"pattern\"===e.name).forEach(e=>n.push(e)),t=t.filter(e=>\"pattern\"!==e.name),{kind:\"description\",location:Gi(),description:[{kind:\"default-description?\",location:Gi(),name:\"pattern\",patterns:n},...t]}},Gt=function(e,t){return{kind:\"handle-description\",location:Gi(),name:e,pattern:t}},Yt=\"recipe\",Xt=Xi(\"recipe\",!1),Qt=function(e,t,n){return t=lo(t,e=>e[1],[]),{kind:\"recipe\",location:Gi(),name:lo(e,e=>e[1],null),verbs:t,items:lo(n,ao,[])}},en=\"as\",tn=Xi(\"as\",!1),nn=function(e){return e},rn=function(e,t,n){const r=[],i=[];if(n){n=ao(n);for(const e of n)\"handle-connection\"===e.kind?r.push(e):i.push(e)}return{kind:\"particle\",location:Gi(),name:lo(t,e=>e[1],null),ref:e,connections:r,slotConnections:i}},sn=function(e,t,n,r){return{kind:\"handle-connection\",location:Gi(),param:e,dir:t,target:lo(n,e=>e[1],null),dependentConnections:lo(r,ao,[])}},on=function(e,t){let n=null,r=null;return(e=lo(e,e=>e,null))&&(e[0].toUpperCase()===e[0]?r=e:n=e),{kind:\"handle-connection-components\",location:Gi(),name:n,particle:r,tags:lo(t,e=>e,[])}},an=function(e,t,n,r){return{kind:\"slot-connection\",location:Gi(),direction:e,param:t.param,tags:t.tags,name:lo(n,e=>e[1],null),dependentSlotConnections:lo(r,ao,[])}},ln=function(e,t){return{kind:\"slot-connection-ref\",location:Gi(),param:e,tags:t}},cn=function(e,t,n){return{kind:\"connection\",location:Gi(),direction:t,from:e,to:n}},hn=\"search\",un=Xi(\"search\",!1),dn=\"tokens\",fn=Xi(\"tokens\",!1),pn=function(e,t){return{kind:\"search\",location:Gi(),phrase:e,tokens:lo(t,e=>e[1][2].map(e=>e[1]),null)}},mn=\"<-\",gn=Xi(\"<-\",!1),yn=\"->\",_n=Xi(\"->\",!1),vn=\"=\",bn=Xi(\"=\",!1),wn=function(e,t){const{param:n,tags:r}=lo(t,e=>e,{param:null,tags:[]});return{kind:\"connection-target\",location:Gi(),targetType:\"verb\",verbs:e,param:n,tags:r}},Sn=function(e){return{kind:\"connection-target\",location:Gi(),targetType:\"tag\",tags:e}},kn=function(e,t){const{param:n,tags:r}=lo(t,e=>e,{param:null,tags:[]});return{kind:\"connection-target\",targetType:\"localName\",location:Gi(),name:e,param:n,tags:r}},Cn=function(e,t){const{param:n,tags:r}=lo(t,e=>e,{param:null,tags:[]});return{kind:\"connection-target\",targetType:\"particle\",location:Gi(),particle:e,param:n,tags:r}},xn=\".\",Tn=Xi(\".\",!1),En=function(e,t){return{param:lo(e,e=>e,null),tags:lo(t,e=>e[1],[])}},An=\"use\",On=Xi(\"use\",!1),In=\"map\",Rn=Xi(\"map\",!1),Nn=\"create\",$n=Xi(\"create\",!1),Pn=\"copy\",jn=Xi(\"copy\",!1),Bn=\"`slot\",Mn=Xi(\"`slot\",!1),Dn=function(e,t,n){return{kind:\"handle\",location:Gi(),name:lo(n,e=>e[1],null),ref:lo(t,e=>e[1],oo()),fate:e}},zn=\"require\",Fn=Xi(\"require\",!1),Ln=function(e){return{kind:\"require\",location:Gi(),items:ao(e)}},Un=function(e,t){return{kind:\"requireHandle\",location:Gi(),name:lo(e,e=>e[1],null),ref:lo(t,e=>e[1],oo())}},Hn=\"#\",qn=Xi(\"#\",!1),Wn=/^[a-zA-Z]/,Vn=Qi([[\"a\",\"z\"],[\"A\",\"Z\"]],!1,!1),Kn=/^[a-zA-Z0-9_]/,Zn=Qi([[\"a\",\"z\"],[\"A\",\"Z\"],[\"0\",\"9\"],\"_\"],!1,!1),Jn=function(){return Ji().substring(1)},Gn=function(e,t){return[e,...t&&t[1]||[]]},Yn=es(\"a verb (e.g. &Verb)\"),Xn=\"&\",Qn=Xi(\"&\",!1),er=function(e){return e},tr=function(e,t){return{location:Gi(),name:e,tags:t=lo(t,e=>e[1],[])}},nr=function(e){return{location:Gi(),name:e,tags:[]}},rr=function(e){return{location:Gi(),name:e[0],tags:e}},ir=function(e){return{kind:\"particle-ref\",location:Gi(),name:e,verbs:[],tags:[]}},sr=function(e){return{kind:\"particle-ref\",location:Gi(),verbs:[e],tags:[]}},or=function(e,t){return{kind:\"handle-ref\",location:Gi(),id:e,tags:t||[]}},ar=function(e,t){return{kind:\"handle-ref\",location:Gi(),name:e,tags:t||[]}},lr=function(e){return{kind:\"handle-ref\",location:Gi(),tags:e}},cr=\"slot\",hr=Xi(\"slot\",!1),ur=function(e,t){return{kind:\"slot\",location:Gi(),ref:lo(e,e=>e[1],oo()),name:lo(t,e=>e[1],\"\")}},dr=function(e,t){return{kind:\"schema-inline\",location:Gi(),names:lo(e,e=>e.map(e=>e[0]).filter(e=>\"*\"!==e),[]),fields:lo(t,e=>[e[0],...e[1].map(e=>e[2])],[])}},fr=function(e,t){return{kind:\"schema-inline-field\",location:Gi(),name:t,type:lo(e,e=>e[0],null)}},pr=\"schema\",mr=Xi(\"schema\",!1),gr=function(e,t){return{names:e.map(e=>e[1]).filter(e=>\"*\"!==e),parents:lo(t,e=>e,[])}},yr=\"alias\",_r=Xi(\"alias\",!1),vr=function(e,t,n){return{kind:\"schema\",location:Gi(),items:lo(n,ao,[]),alias:t,...e}},br=function(e,t){return{kind:\"schema\",location:Gi(),items:lo(t,ao,[]),...e}},wr=\"extends\",Sr=Xi(\"extends\",!1),kr=function(e,t){return[e,...t.map(e=>e[3])]},Cr=function(e,t){return{kind:\"schema-field\",location:Gi(),type:e,name:t}},xr=function(e){return{kind:\"schema-collection\",location:Gi(),schema:e}},Tr=function(e){return{kind:\"schema-reference\",location:Gi(),schema:e}},Er=\"Text\",Ar=Xi(\"Text\",!1),Or=\"URL\",Ir=Xi(\"URL\",!1),Rr=\"Number\",Nr=Xi(\"Number\",!1),$r=\"Boolean\",Pr=Xi(\"Boolean\",!1),jr=\"Bytes\",Br=Xi(\"Bytes\",!1),Mr=\"Object\",Dr=Xi(\"Object\",!1),zr=function(e){return{kind:\"schema-primitive\",location:Gi(),type:e}},Fr=\"(\",Lr=Xi(\"(\",!1),Ur=\"or\",Hr=Xi(\"or\",!1),qr=\")\",Wr=Xi(\")\",!1),Vr=function(e,t){const n=[e];for(const e of t)n.push(e[3]);return{kind:\"schema-union\",location:Gi(),types:n}},Kr=function(e,t){const n=[e];for(const e of t)n.push(e[3]);return{kind:\"schema-tuple\",location:Gi(),types:n}},Zr=es(\"a version number (e.g. @012)\"),Jr=/^[0-9]/,Gr=Qi([[\"0\",\"9\"]],!1,!1),Yr=function(e){return Number(e.join(\"\"))},Xr=es(\"indentation\"),Qr=\" \",ei=Xi(\" \",!1),ti=function(e){return(e=e.join(\"\")).length>ro.length&&(so.push(ro),ro=e,!0)},ni=es(\"same indentation\"),ri=function(e){return(e=e.join(\"\")).length===ro.length||e.length<ro.length&&(ro=so.pop(),!1)},ii=es(\"same or more indentation\"),si=function(e){return(e=e.join(\"\")).length>=ro.length||(e.length<ro.length?(ro=so.pop(),!1):void 0)},oi=/^[^a-zA-Z0-9_]/,ai=Qi([[\"a\",\"z\"],[\"A\",\"Z\"],[\"0\",\"9\"],\"_\"],!0,!1),li={type:\"any\"},ci=function(e){throw new xt(`Expected identifier but keyword, '${e}' found.`,[],\"\",Gi())},hi=es(\"a `backquoted string`\"),ui=\"`\",di=Xi(\"`\",!1),fi=/^[^`]/,pi=Qi([\"`\"],!0,!1),mi=function(e){return e.join(\"\")},gi=es(\"an identifier (e.g. 'id')\"),yi=\"'\",_i=Xi(\"'\",!1),vi=/^[^']/,bi=Qi([\"'\"],!0,!1),wi=function(e){return e.join(\"\")},Si=es(\"an uppercase identifier (e.g. Foo)\"),ki=/^[A-Z]/,Ci=Qi([[\"A\",\"Z\"]],!1,!1),xi=/^[a-z0-9_]/i,Ti=Qi([[\"a\",\"z\"],[\"0\",\"9\"],\"_\"],!1,!0),Ei=es(\"a lowercase identifier (e.g. foo)\"),Ai=/^[a-z]/,Oi=Qi([[\"a\",\"z\"]],!1,!1),Ii=es(\"a field name (e.g. foo9)\"),Ri=es(\"one or more whitespace characters\"),Ni=es(\"a group of new lines (and optionally comments)\"),$i=/^[ ]/,Pi=Qi([\" \"],!1,!1),ji=\"//\",Bi=Xi(\"//\",!1),Mi=es(\"a new line\"),Di=\"\\r\",zi=Xi(\"\\r\",!1),Fi=\"\\n\",Li=Xi(\"\\n\",!1);let Ui=0,Hi=0;const qi=[{line:1,column:1}];let Wi,Vi=0,Ki=[],Zi=0;if(void 0!==t.startRule){if(!(t.startRule in r))throw new Error(\"Can't start parsing from rule \\\"\"+t.startRule+'\".');i=r[t.startRule]}function Ji(){return e.substring(Hi,Ui)}function Gi(){return ns(Hi,Ui)}function Yi(e,t){throw function(e,t){return new xt(e,[],\"\",t)}(e,t=void 0!==t?t:ns(Hi,Ui))}function Xi(e,t){return{type:\"literal\",text:e,ignoreCase:t}}function Qi(e,t,n){return{type:\"class\",parts:e,inverted:t,ignoreCase:n}}function es(e){return{type:\"other\",description:e}}function ts(t){let n,r=qi[t];if(r)return r;for(n=t-1;!qi[n];)n--;for(r={line:(r=qi[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return qi[t]=r,r}function ns(e,t){const n=ts(e),r=ts(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function rs(e){Ui<Vi||(Ui>Vi&&(Vi=Ui,Ki=[]),Ki.push(e))}function is(e,t,n){return new xt(xt.buildMessage(e,t),e,t,n)}function ss(){let e,t,r,i,o,a,l,c,h;if(e=Ui,(t=to())===n&&(t=null),t!==n)if((r=Vs())===n&&(r=null),r!==n){for(i=[],o=Ui,a=Ui,(l=Ks())!==n&&(c=as())!==n&&(h=to())!==n?a=l=[l,c,h]:(Ui=a,a=n),a===n&&(a=null),a!==n&&(l=Ks())!==n&&(c=os())!==n?o=a=[a,l,c]:(Ui=o,o=n);o!==n;)i.push(o),o=Ui,a=Ui,(l=Ks())!==n&&(c=as())!==n&&(h=to())!==n?a=l=[l,c,h]:(Ui=a,a=n),a===n&&(a=null),a!==n&&(l=Ks())!==n&&(c=os())!==n?o=a=[a,l,c]:(Ui=o,o=n);i!==n?(Hi=e,e=t=s(i)):(Ui=e,e=n)}else Ui=e,e=n;else Ui=e,e=n;return e}function os(){let t;return(t=function(){let t,r,i,s,o,a,l,c,h,u,d;if(t=Ui,e.substr(Ui,6)===Yt?(r=Yt,Ui+=6):(r=n,0===Zi&&rs(Xt)),r!==n)if(i=Ui,(s=eo())!==n&&(o=Ys())!==n?i=s=[s,o]:(Ui=i,i=n),i===n&&(i=null),i!==n)if(s=Ui,(o=eo())!==n&&(a=Bs())!==n?s=o=[o,a]:(Ui=s,s=n),s===n&&(s=null),s!==n)if((o=to())!==n){if(a=Ui,(l=Vs())!==n){for(c=[],h=Ui,(u=Ks())!==n&&(d=xs())!==n?h=u=[u,d]:(Ui=h,h=n);h!==n;)c.push(h),h=Ui,(u=Ks())!==n&&(d=xs())!==n?h=u=[u,d]:(Ui=h,h=n);c!==n?a=l=[l,c]:(Ui=a,a=n)}else Ui=a,a=n;a===n&&(a=null),a!==n?(Hi=t,r=Qt(i,s,a),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u,d,f,p;if(t=Ui,e.substr(Ui,8)===ge?(r=ge,Ui+=8):(r=n,0===Zi&&rs(ye)),r!==n)if((i=eo())!==n)if((s=Ys())!==n)if(o=Ui,(a=eo())!==n&&(l=Bs())!==n?o=a=[a,l]:(Ui=o,o=n),o===n&&(o=null),o!==n)if(a=Ui,(l=eo())!==n?(e.substr(Ui,2)===E?(c=E,Ui+=2):(c=n,0===Zi&&rs(A)),c!==n&&(h=eo())!==n&&(u=Gs())!==n?a=l=[l,c,h,u]:(Ui=a,a=n)):(Ui=a,a=n),a===n&&(a=null),a!==n)if((l=to())!==n){if(c=Ui,(h=Vs())!==n){for(u=[],d=Ui,(f=Ks())!==n&&(p=ds())!==n?d=f=[f,p]:(Ui=d,d=n);d!==n;)u.push(d),d=Ui,(f=Ks())!==n&&(p=ds())!==n?d=f=[f,p]:(Ui=d,d=n);u!==n?c=h=[h,u]:(Ui=c,c=n)}else Ui=c,c=n;c===n&&(c=null),c!==n?((h=to())===n&&(h=null),h!==n?(Hi=t,r=_e(s,o,a,c),t=r):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=function(){let t,r,i,s,o;return t=Ui,e.substr(Ui,6)===B?(r=B,Ui+=6):(r=n,0===Zi&&rs(M)),r!==n&&(i=eo())!==n&&(s=Gs())!==n&&(o=to())!==n?(Hi=t,r=D(s),t=r):(Ui=t,t=n),t}())===n&&(t=function(){let e,t,r,i,s,o,a,l,c;if(e=Ui,(t=Us())!==n)if((r=to())!==n){if(i=Ui,(s=Vs())!==n){for(o=[],a=Ui,(l=Ks())!==n&&(c=Hs())!==n?a=l=[l,c]:(Ui=a,a=n);a!==n;)o.push(a),a=Ui,(l=Ks())!==n&&(c=Hs())!==n?a=l=[l,c]:(Ui=a,a=n);o!==n?i=s=[s,o]:(Ui=i,i=n)}else Ui=i,i=n;i===n&&(i=null),i!==n?(Hi=e,t=br(t,i),e=t):(Ui=e,e=n)}else Ui=e,e=n;else Ui=e,e=n;return e}())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u,d,f,p;if(t=Ui,e.substr(Ui,5)===yr?(r=yr,Ui+=5):(r=n,0===Zi&&rs(_r)),r!==n)if((i=eo())!==n)if((s=Us())!==n)if((o=eo())!==n)if((a=function(){let t,r,i,s;return t=Ui,e.substr(Ui,2)===en?(r=en,Ui+=2):(r=n,0===Zi&&rs(tn)),r!==n&&(i=eo())!==n&&(s=Ys())!==n?(Hi=t,r=nn(s),t=r):(Ui=t,t=n),t}())!==n)if((l=to())!==n){if(c=Ui,(h=Vs())!==n){for(u=[],d=Ui,(f=Ks())!==n&&(p=Hs())!==n?d=f=[f,p]:(Ui=d,d=n);d!==n;)u.push(d),d=Ui,(f=Ks())!==n&&(p=Hs())!==n?d=f=[f,p]:(Ui=d,d=n);u!==n?c=h=[h,u]:(Ui=c,c=n)}else Ui=c,c=n;c===n&&(c=null),c!==n?(Hi=t,r=vr(s,a,c),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=function(){let t,r,i,s,o,c,h,u,d,f,p,m,g,y,_,v,P,j,B,M,D;if(t=Ui,e.substr(Ui,5)===b?(r=b,Ui+=5):(r=n,0===Zi&&rs(w)),r!==n)if((i=eo())!==n)if((s=Ys())!==n)if((o=eo())!==n)if(e.substr(Ui,2)===S?(c=S,Ui+=2):(c=n,0===Zi&&rs(k)),c!==n)if((h=eo())!==n)if((u=function(){let e;return(e=Fs())===n&&(e=ms())===n&&(e=gs())===n&&(e=vs()),e}())!==n)if(d=Ui,(f=eo())!==n&&(p=Gs())!==n?d=f=[f,p]:(Ui=d,d=n),d===n&&(d=null),d!==n)if(f=Ui,e.substr(Ui,2)===C?(p=C,Ui+=2):(p=n,0===Zi&&rs(x)),p!==n&&(m=Gs())!==n?f=p=[p,m]:(Ui=f,f=n),f===n&&(f=null),f!==n)if(p=Ui,(m=eo())!==n&&(g=function(){let t,r,i,s;if(Zi++,t=Ui,64===e.charCodeAt(Ui)?(r=a,Ui++):(r=n,0===Zi&&rs(l)),r!==n){if(i=[],Jr.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(Gr)),s!==n)for(;s!==n;)i.push(s),Jr.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(Gr));else i=n;i!==n?(Hi=t,r=Yr(i),t=r):(Ui=t,t=n)}else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(Zr)),t}())!==n?p=m=[m,g]:(Ui=p,p=n),p===n&&(p=null),p!==n)if(m=Ui,(g=eo())!==n&&(y=Ps())!==n?m=g=[g,y]:(Ui=m,m=n),m===n&&(m=null),m!==n)if((g=eo())!==n)if((y=function(){let t;return(t=function(){let t,r,i,s;return t=Ui,e.substr(Ui,2)===E?(r=E,Ui+=2):(r=n,0===Zi&&rs(A)),r!==n&&(i=eo())!==n&&(s=Gs())!==n?(Hi=t,r=O(s),t=r):(Ui=t,t=n),t}())===n&&(t=function(){let t,r,i,s;return t=Ui,e.substr(Ui,2)===E?(r=E,Ui+=2):(r=n,0===Zi&&rs(A)),r!==n&&(i=eo())!==n&&(s=Ys())!==n?(Hi=t,r=I(s),t=r):(Ui=t,t=n),t}())===n&&(t=function(){let t,r,i,s;return t=Ui,e.substr(Ui,2)===R?(r=R,Ui+=2):(r=n,0===Zi&&rs(N)),r!==n&&(i=eo())!==n&&(s=Gs())!==n?(Hi=t,r=$(s),t=r):(Ui=t,t=n),t}()),t}())!==n)if((_=to())!==n){if(v=Ui,(P=Vs())!==n){if(j=[],B=Ui,(M=Ks())!==n&&(D=cs())!==n?B=M=[M,D]:(Ui=B,B=n),B!==n)for(;B!==n;)j.push(B),B=Ui,(M=Ks())!==n&&(D=cs())!==n?B=M=[M,D]:(Ui=B,B=n);else j=n;j!==n?v=P=[P,j]:(Ui=v,v=n)}else Ui=v,v=n;v===n&&(v=null),v!==n?(Hi=t,r=T(s,u,d,f,p,m,y,v),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u,d,f;if(Zi++,t=Ui,e.substr(Ui,9)===F?(r=F,Ui+=9):(r=n,0===Zi&&rs(L)),r!==n)if((i=eo())!==n)if((s=Ys())!==n)if(o=Ui,(a=eo())===n&&(a=null),a!==n?(60===e.charCodeAt(Ui)?(l=U,Ui++):(l=n,0===Zi&&rs(H)),l!==n?((c=eo())===n&&(c=null),c!==n&&(h=function(){let t,r,i,s,o,a,l;if(t=Ui,(r=ys())!==n){for(i=[],s=Ui,44===e.charCodeAt(Ui)?(o=st,Ui++):(o=n,0===Zi&&rs(ot)),o!==n&&(a=eo())!==n&&(l=ys())!==n?s=o=[o,a,l]:(Ui=s,s=n);s!==n;)i.push(s),s=Ui,44===e.charCodeAt(Ui)?(o=st,Ui++):(o=n,0===Zi&&rs(ot)),o!==n&&(a=eo())!==n&&(l=ys())!==n?s=o=[o,a,l]:(Ui=s,s=n);i!==n?(Hi=t,r=dt(r,i),t=r):(Ui=t,t=n)}else Ui=t,t=n;return t}())!==n?((u=eo())===n&&(u=null),u!==n?(62===e.charCodeAt(Ui)?(d=q,Ui++):(d=n,0===Zi&&rs(W)),d!==n?o=a=[a,l,c,h,u,d]:(Ui=o,o=n)):(Ui=o,o=n)):(Ui=o,o=n)):(Ui=o,o=n)):(Ui=o,o=n),o===n&&(o=null),o!==n)if((a=to())!==n){if(l=Ui,(c=Vs())!==n){for(h=[],u=Ui,(d=Ks())!==n&&(f=hs())!==n?u=d=[d,f]:(Ui=u,u=n);u!==n;)h.push(u),u=Ui,(d=Ks())!==n&&(f=hs())!==n?u=d=[d,f]:(Ui=u,u=n);h!==n?l=c=[c,h]:(Ui=l,l=n)}else Ui=l,l=n;l===n&&(l=null),l!==n?((c=to())===n&&(c=null),c!==n?(Hi=t,r=V(s,o,l),t=r):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(z)),t}())===n&&(t=function(){let t,r,i,s,o,a,l,c,h;if(t=Ui,e.substr(Ui,4)===se?(r=se,Ui+=4):(r=n,0===Zi&&rs(oe)),r!==n)if((i=to())!==n){if(s=Ui,(o=Vs())!==n){for(a=[],l=Ui,(c=Ks())!==n&&(h=us())!==n?l=c=[c,h]:(Ui=l,l=n);l!==n;)a.push(l),l=Ui,(c=Ks())!==n&&(h=us())!==n?l=c=[c,h]:(Ui=l,l=n);a!==n?s=o=[o,a]:(Ui=s,s=n)}else Ui=s,s=n;s===n&&(s=null),s!==n?((o=to())===n&&(o=null),o!==n?(Hi=t,r=ae(s),t=r):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=function(){let t,r,i,s,o,a,l,c,y,_;return t=Ui,e.substr(Ui,8)===h?(r=h,Ui+=8):(r=n,0===Zi&&rs(u)),r!==n&&(i=eo())!==n&&(s=Ys())!==n&&(o=to())!==n&&(a=Vs())!==n&&(l=Ks())!==n&&(c=function(){let t,r,i;return t=Ui,e.substr(Ui,5)===f?(r=f,Ui+=5):(r=n,0===Zi&&rs(p)),r!==n&&(i=no())!==n?(Hi=t,r=m(),t=r):(Ui=t,t=n),t}())!==n&&(y=function(){let e,t,r,i,s;if(e=Ui,t=[],r=Ui,(i=Zs())!==n&&(s=ls())!==n?r=i=[i,s]:(Ui=r,r=n),r!==n)for(;r!==n;)t.push(r),r=Ui,(i=Zs())!==n&&(s=ls())!==n?r=i=[i,s]:(Ui=r,r=n);else t=n;return t!==n&&(Hi=e,t=g(t)),e=t}())!==n?((_=to())===n&&(_=null),_!==n?(Hi=t,r=d(s,y),t=r):(Ui=t,t=n)):(Ui=t,t=n),t}()),t}function as(){let t,r,i;return Zi++,t=Ui,64===e.charCodeAt(Ui)?(r=a,Ui++):(r=n,0===Zi&&rs(l)),r!==n&&(i=Xs())!==n?(Hi=t,t=r=c(i)):(Ui=t,t=n),Zi--,t===n&&(r=n,0===Zi&&rs(o)),t}function ls(){let t,r,i;for(t=Ui,r=[],y.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(_));i!==n;)r.push(i),y.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(_));return r!==n&&(i=no())!==n?(Hi=t,t=r=v()):(Ui=t,t=n),t}function cs(){let t,r,i,s,o;return t=Ui,e.substr(Ui,11)===P?(r=P,Ui+=11):(r=n,0===Zi&&rs(j)),r!==n&&(i=eo())!==n&&(s=Js())!==n&&(o=to())!==n?t=r=[r,i,s,o]:(Ui=t,t=n),t}function hs(){let t;return(t=function(){let t,r,i,s,o,a,l;return t=Ui,r=Ui,e.substr(Ui,4)===G?(i=G,Ui+=4):(i=n,0===Zi&&rs(Y)),i!==n&&(s=eo())!==n?r=i=[i,s]:(Ui=r,r=n),r===n&&(r=null),r!==n?(e.substr(Ui,7)===X?(i=X,Ui+=7):(i=n,0===Zi&&rs(Q)),i===n&&(e.substr(Ui,7)===ee?(i=ee,Ui+=7):(i=n,0===Zi&&rs(te))),i!==n?(s=Ui,(o=eo())!==n?(e.substr(Ui,6)===ne?(a=ne,Ui+=6):(a=n,0===Zi&&rs(re)),a!==n?s=o=[o,a]:(Ui=s,s=n)):(Ui=s,s=n),s===n&&(s=null),s!==n?(o=Ui,(a=eo())!==n&&(l=Xs())!==n?o=a=[a,l]:(Ui=o,o=n),o===n&&(o=null),o!==n&&(a=to())!==n?(Hi=t,r=ie(r,i,s,o),t=r):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),t}())===n&&(t=function(){let t,r,i,s,o;return t=Ui,r=Ui,(i=fs())!==n&&(s=eo())!==n?r=i=[i,s]:(Ui=r,r=n),r===n&&(r=null),r!==n?(i=Ui,(s=ps())!==n&&(o=eo())!==n?i=s=[s,o]:(Ui=i,i=n),i===n&&(i=null),i!==n?((s=Xs())===n&&(42===e.charCodeAt(Ui)?(s=K,Ui++):(s=n,0===Zi&&rs(Z))),s!==n&&(o=to())!==n?(Hi=t,r=J(r,i,s),t=r):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),t}()),t}function us(){let t;return(t=function(){let t,r,i,s,o,a,l;return t=Ui,e.substr(Ui,10)===fe?(r=fe,Ui+=10):(r=n,0===Zi&&rs(pe)),r!==n?((i=eo())===n&&(i=null),i!==n?(58===e.charCodeAt(Ui)?(s=he,Ui++):(s=n,0===Zi&&rs(ue)),s!==n?((o=eo())===n&&(o=null),o!==n&&(a=Gs())!==n&&(l=to())!==n?(Hi=t,r=me(a),t=r):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),t}())===n&&(t=function(){let t,r,i,s,o,a,l;return t=Ui,e.substr(Ui,4)===le?(r=le,Ui+=4):(r=n,0===Zi&&rs(ce)),r!==n?((i=eo())===n&&(i=null),i!==n?(58===e.charCodeAt(Ui)?(s=he,Ui++):(s=n,0===Zi&&rs(ue)),s!==n?((o=eo())===n&&(o=null),o!==n&&(a=Gs())!==n&&(l=to())!==n?(Hi=t,r=de(a),t=r):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),t}()),t}function ds(){let t,r;return Zi++,(t=function(){let t,r,i,s,o;return t=Ui,e.substr(Ui,8)===ft?(r=ft,Ui+=8):(r=n,0===Zi&&rs(pt)),r!==n&&(i=eo())!==n&&(s=function(){let t;return e.substr(Ui,9)===gt?(t=gt,Ui+=9):(t=n,0===Zi&&rs(yt)),t===n&&(e.substr(Ui,3)===_t?(t=_t,Ui+=3):(t=n,0===Zi&&rs(vt)),t===n&&(e.substr(Ui,2)===bt?(t=bt,Ui+=2):(t=n,0===Zi&&rs(wt)),t===n&&(e.substr(Ui,5)===St?(t=St,Ui+=5):(t=n,0===Zi&&rs(kt)),t===n&&(e.substr(Ui,14)===Ct?(t=Ct,Ui+=14):(t=n,0===Zi&&rs(Tt)),t===n&&(e.substr(Ui,8)===Et?(t=Et,Ui+=8):(t=n,0===Zi&&rs(At)),t===n&&(e.substr(Ui,7)===Ot?(t=Ot,Ui+=7):(t=n,0===Zi&&rs(It)),t===n&&(e.substr(Ui,10)===Rt?(t=Rt,Ui+=10):(t=n,0===Zi&&rs(Nt))))))))),t}())!==n&&(o=to())!==n?(Hi=t,r=mt(s),t=r):(Ui=t,t=n),t}())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u,d,f,p,m;if(t=Ui,r=Ui,e.substr(Ui,4)===G?(i=G,Ui+=4):(i=n,0===Zi&&rs(Y)),i!==n&&(s=eo())!==n?r=i=[i,s]:(Ui=r,r=n),r===n&&(r=null),r!==n)if(e.substr(Ui,7)===X?(i=X,Ui+=7):(i=n,0===Zi&&rs(Q)),i!==n)if((s=eo())!==n)if(o=Ui,e.substr(Ui,6)===ne?(a=ne,Ui+=6):(a=n,0===Zi&&rs(re)),a!==n&&(l=eo())!==n?o=a=[a,l]:(Ui=o,o=n),o===n&&(o=null),o!==n)if((a=Xs())!==n)if(l=Ui,(c=eo())!==n&&(h=Ps())!==n?l=c=[c,h]:(Ui=l,l=n),l===n&&(l=null),l!==n)if((c=to())!==n){if(h=Ui,(u=Vs())!==n){for(d=[],f=Ui,(p=Ks())!==n&&(m=bs())!==n?f=p=[p,m]:(Ui=f,f=n);f!==n;)d.push(f),f=Ui,(p=Ks())!==n&&(m=bs())!==n?f=p=[p,m]:(Ui=f,f=n);d!==n?h=u=[u,d]:(Ui=h,h=n)}else Ui=h,h=n;h===n&&(h=null),h!==n?(Hi=t,r=$t(r,o,a,l,h),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=ks())===n&&(t=function t(){let r,i,s,o,a,l,c,h,u;if(r=Ui,(i=function(){let t,r,i,s,o,a,l;return t=Ui,(r=fs())!==n?(63===e.charCodeAt(Ui)?(i=we,Ui++):(i=n,0===Zi&&rs(Se)),i===n&&(i=null),i!==n&&(s=eo())!==n&&(o=ps())!==n&&(a=eo())!==n&&(l=function(){let e,t,r,i,s;return e=Ui,(t=Xs())!==n?(r=Ui,(i=eo())!==n&&(s=Ps())!==n?r=i=[i,s]:(Ui=r,r=n),r===n&&(r=null),r!==n?(Hi=e,t=tr(t,r),e=t):(Ui=e,e=n)):(Ui=e,e=n),e===n&&(e=Ui,(t=eo())!==n&&(r=Xs())!==n?(Hi=e,t=nr(r),e=t):(Ui=e,e=n),e===n&&(e=Ui,(t=eo())!==n&&(r=Ps())!==n?(Hi=e,t=rr(r),e=t):(Ui=e,e=n))),e}())!==n?(Hi=t,r=ke(r,i,o,l),t=r):(Ui=t,t=n)):(Ui=t,t=n),t}())!==n)if((s=to())!==n){if(o=Ui,(a=Vs())!==n){for(l=[],c=Ui,(h=Ks())!==n&&(u=t())!==n?c=h=[h,u]:(Ui=c,c=n);c!==n;)l.push(c),c=Ui,(h=Ks())!==n&&(u=t())!==n?c=h=[h,u]:(Ui=c,c=n);l!==n?o=a=[a,l]:(Ui=o,o=n)}else Ui=o,o=n;o===n&&(o=null),o!==n?(Hi=r,i=be(i,o),r=i):(Ui=r,r=n)}else Ui=r,r=n;else Ui=r,r=n;return r}()),Zi--,t===n&&(r=n,0===Zi&&rs(ve)),t}function fs(){let t,r;return Zi++,e.substr(Ui,5)===xe?(t=xe,Ui+=5):(t=n,0===Zi&&rs(Te)),t===n&&(e.substr(Ui,2)===E?(t=E,Ui+=2):(t=n,0===Zi&&rs(A)),t===n&&(e.substr(Ui,3)===Ee?(t=Ee,Ui+=3):(t=n,0===Zi&&rs(Ae)),t===n&&(e.substr(Ui,4)===Oe?(t=Oe,Ui+=4):(t=n,0===Zi&&rs(Ie)),t===n&&(e.substr(Ui,8)===Re?(t=Re,Ui+=8):(t=n,0===Zi&&rs(Ne)),t===n&&(t=Ui,e.substr(Ui,8)===$e?(r=$e,Ui+=8):(r=n,0===Zi&&rs(Pe)),r!==n&&(Hi=t,r=je()),t=r))))),Zi--,t===n&&(r=n,0===Zi&&rs(Ce)),t}function ps(){let t;return(t=ys())===n&&(t=ms())===n&&(t=gs())===n&&(t=function(){let t,r,i,s;return t=Ui,e.substr(Ui,10)===qe?(r=qe,Ui+=10):(r=n,0===Zi&&rs(We)),r!==n&&(i=ps())!==n?(62===e.charCodeAt(Ui)?(s=q,Ui++):(s=n,0===Zi&&rs(W)),s!==n?(Hi=t,r=Ve(i),t=r):(Ui=t,t=n)):(Ui=t,t=n),t}())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u,d,f,p;if(t=Ui,e.substr(Ui,4)===Qe?(r=Qe,Ui+=4):(r=n,0===Zi&&rs(et)),r!==n)if(i=Ui,Zi++,tt.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(nt)),Zi--,s!==n?(Ui=i,i=void 0):i=n,i!==n){if(s=Ui,(o=eo())===n&&(o=null),o!==n)if(123===e.charCodeAt(Ui)?(a=rt,Ui++):(a=n,0===Zi&&rs(it)),a!==n){if(l=Ui,(c=_s())!==n){for(h=[],u=Ui,44===e.charCodeAt(Ui)?(d=st,Ui++):(d=n,0===Zi&&rs(ot)),d!==n&&(f=eo())!==n&&(p=_s())!==n?u=d=[d,f,p]:(Ui=u,u=n);u!==n;)h.push(u),u=Ui,44===e.charCodeAt(Ui)?(d=st,Ui++):(d=n,0===Zi&&rs(ot)),d!==n&&(f=eo())!==n&&(p=_s())!==n?u=d=[d,f,p]:(Ui=u,u=n);h!==n?l=c=[c,h]:(Ui=l,l=n)}else Ui=l,l=n;l===n&&(l=null),l!==n?(125===e.charCodeAt(Ui)?(c=at,Ui++):(c=n,0===Zi&&rs(lt)),c!==n?s=o=[o,a,l,c]:(Ui=s,s=n)):(Ui=s,s=n)}else Ui=s,s=n;else Ui=s,s=n;s===n&&(s=null),s!==n?(Hi=t,r=ct(s),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=Fs())===n&&(t=vs()),t}function ms(){let t,r,i,s;return t=Ui,91===e.charCodeAt(Ui)?(r=Be,Ui++):(r=n,0===Zi&&rs(Me)),r!==n&&(i=ps())!==n?(93===e.charCodeAt(Ui)?(s=De,Ui++):(s=n,0===Zi&&rs(ze)),s!==n?(Hi=t,t=r=Fe(i)):(Ui=t,t=n)):(Ui=t,t=n),t}function gs(){let t,r,i,s;return t=Ui,e.substr(Ui,14)===Le?(r=Le,Ui+=14):(r=n,0===Zi&&rs(Ue)),r!==n&&(i=ps())!==n?(62===e.charCodeAt(Ui)?(s=q,Ui++):(s=n,0===Zi&&rs(W)),s!==n?(Hi=t,t=r=He(i)):(Ui=t,t=n)):(Ui=t,t=n),t}function ys(){let t,r,i,s,o,a,l,c;return Zi++,t=Ui,126===e.charCodeAt(Ui)?(r=Ze,Ui++):(r=n,0===Zi&&rs(Je)),r!==n&&(i=Xs())!==n?(s=Ui,(o=eo())!==n?(e.substr(Ui,4)===Ge?(a=Ge,Ui+=4):(a=n,0===Zi&&rs(Ye)),a!==n&&(l=eo())!==n&&(c=ps())!==n?s=o=[o,a,l,c]:(Ui=s,s=n)):(Ui=s,s=n),s===n&&(s=null),s!==n?(Hi=t,t=r=Xe(i,s)):(Ui=t,t=n)):(Ui=t,t=n),Zi--,t===n&&(r=n,0===Zi&&rs(Ke)),t}function _s(){let t,r,i,s,o,a;return t=Ui,(r=Qs())!==n?((i=eo())===n&&(i=null),i!==n?(58===e.charCodeAt(Ui)?(s=he,Ui++):(s=n,0===Zi&&rs(ue)),s!==n?((o=eo())===n&&(o=null),o!==n&&(a=Xs())!==n?(Hi=t,t=r=ht(r,a)):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),t}function vs(){let e,t;return e=Ui,(t=Ys())!==n&&(Hi=e,t=ut(t)),e=t}function bs(){let t;return(t=ws())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u,d,f,p,m;if(t=Ui,r=Ui,e.substr(Ui,4)===G?(i=G,Ui+=4):(i=n,0===Zi&&rs(Y)),i!==n&&(s=eo())!==n?r=i=[i,s]:(Ui=r,r=n),r===n&&(r=null),r!==n)if(e.substr(Ui,7)===ee?(i=ee,Ui+=7):(i=n,0===Zi&&rs(te)),i!==n)if((s=eo())!==n)if(o=Ui,e.substr(Ui,6)===ne?(a=ne,Ui+=6):(a=n,0===Zi&&rs(re)),a!==n&&(l=eo())!==n?o=a=[a,l]:(Ui=o,o=n),o===n&&(o=null),o!==n)if((a=Xs())!==n)if(l=Ui,(c=eo())!==n&&(h=Ps())!==n?l=c=[c,h]:(Ui=l,l=n),l===n&&(l=null),l!==n)if((c=to())!==n){if(h=Ui,(u=Vs())!==n){for(d=[],f=Ui,(p=Ks())!==n&&(m=Ss())!==n?f=p=[p,m]:(Ui=f,f=n);f!==n;)d.push(f),f=Ui,(p=Ks())!==n&&(m=Ss())!==n?f=p=[p,m]:(Ui=f,f=n);d!==n?h=u=[u,d]:(Ui=h,h=n)}else Ui=h,h=n;h===n&&(h=null),h!==n?(Hi=t,r=Wt(r,o,a,l,h),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}()),t}function ws(){let t,r,i,s,o;return t=Ui,e.substr(Ui,10)===Pt?(r=Pt,Ui+=10):(r=n,0===Zi&&rs(jt)),r!==n&&(i=eo())!==n?(e.substr(Ui,10)===Bt?(s=Bt,Ui+=10):(s=n,0===Zi&&rs(Mt)),s===n&&(e.substr(Ui,3)===Dt?(s=Dt,Ui+=3):(s=n,0===Zi&&rs(zt)),s===n&&(e.substr(Ui,6)===Ft?(s=Ft,Ui+=6):(s=n,0===Zi&&rs(Lt)),s===n&&(e.substr(Ui,5)===Ut?(s=Ut,Ui+=5):(s=n,0===Zi&&rs(Ht))))),s!==n&&(o=to())!==n?(Hi=t,t=r=qt(s)):(Ui=t,t=n)):(Ui=t,t=n),t}function Ss(){let t;return(t=ws())===n&&(t=function(){let t,r,i,s,o;return t=Ui,e.substr(Ui,6)===Vt?(r=Vt,Ui+=6):(r=n,0===Zi&&rs(Kt)),r!==n&&(i=eo())!==n&&(s=Xs())!==n&&(o=to())!==n?(Hi=t,r=Zt(s),t=r):(Ui=t,t=n),t}()),t}function ks(){let t,r,i,s,o,a,l,c,h,u,d;if(t=Ui,e.substr(Ui,11)===P?(r=P,Ui+=11):(r=n,0===Zi&&rs(j)),r!==n)if((i=eo())!==n)if((s=Js())!==n)if((o=to())!==n){if(a=Ui,(l=Vs())!==n){if(c=[],h=Ui,(u=Ks())!==n&&(d=Cs())!==n?h=u=[u,d]:(Ui=h,h=n),h!==n)for(;h!==n;)c.push(h),h=Ui,(u=Ks())!==n&&(d=Cs())!==n?h=u=[u,d]:(Ui=h,h=n);else c=n;c!==n?a=l=[l,c]:(Ui=a,a=n)}else Ui=a,a=n;a===n&&(a=null),a!==n?(Hi=t,t=r=Jt(s,a)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}function Cs(){let e,t,r,i,s;return e=Ui,(t=Xs())!==n&&(r=eo())!==n&&(i=Js())!==n&&(s=to())!==n?(Hi=e,e=t=Gt(t,i)):(Ui=e,e=n),e}function xs(){let t;return(t=Es())===n&&(t=function(){let e,t,r,i,s,o;return e=Ui,(t=Ns())!==n?(r=Ui,(i=eo())!==n&&(s=Ds())!==n?r=i=[i,s]:(Ui=r,r=n),r===n&&(r=null),r!==n?(i=Ui,(s=eo())!==n&&(o=Ts())!==n?i=s=[s,o]:(Ui=i,i=n),i===n&&(i=null),i!==n&&(s=to())!==n?(Hi=e,t=Dn(t,r,i),e=t):(Ui=e,e=n)):(Ui=e,e=n)):(Ui=e,e=n),e}())===n&&(t=$s())===n&&(t=function(){let t,r,i,s,o,a,l,c,h;if(t=Ui,e.substr(Ui,7)===zn?(r=zn,Ui+=7):(r=n,0===Zi&&rs(Fn)),r!==n)if((i=to())!==n){if(s=Ui,(o=Vs())!==n){for(a=[],l=Ui,(c=Ks())!==n?((h=Es())===n&&(h=$s())===n&&(h=zs()),h!==n?l=c=[c,h]:(Ui=l,l=n)):(Ui=l,l=n);l!==n;)a.push(l),l=Ui,(c=Ks())!==n?((h=Es())===n&&(h=$s())===n&&(h=zs()),h!==n?l=c=[c,h]:(Ui=l,l=n)):(Ui=l,l=n);a!==n?s=o=[o,a]:(Ui=s,s=n)}else Ui=s,s=n;s===n&&(s=null),s!==n?(Hi=t,r=Ln(s),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=zs())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u,d,f,p,m;if(t=Ui,e.substr(Ui,6)===hn?(r=hn,Ui+=6):(r=n,0===Zi&&rs(un)),r!==n)if((i=eo())!==n)if((s=Js())!==n)if((o=to())!==n){if(a=Ui,(l=Vs())!==n){if(c=Ui,(h=Ks())!==n)if(e.substr(Ui,6)===dn?(u=dn,Ui+=6):(u=n,0===Zi&&rs(fn)),u!==n){if(d=[],f=Ui,(p=eo())!==n&&(m=Js())!==n?f=p=[p,m]:(Ui=f,f=n),f!==n)for(;f!==n;)d.push(f),f=Ui,(p=eo())!==n&&(m=Js())!==n?f=p=[p,m]:(Ui=f,f=n);else d=n;d!==n&&(f=to())!==n?c=h=[h,u,d,f]:(Ui=c,c=n)}else Ui=c,c=n;else Ui=c,c=n;c!==n?a=l=[l,c]:(Ui=a,a=n)}else Ui=a,a=n;a===n&&(a=null),a!==n?(Hi=t,r=pn(s,a),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=function(){let e,t,r,i,s,o,a;return e=Ui,(t=Is())!==n&&(r=eo())!==n&&(i=Os())!==n&&(s=eo())!==n&&(o=Is())!==n&&(a=to())!==n?(Hi=e,t=cn(t,i,o),e=t):(Ui=e,e=n),e}())===n&&(t=ks()),t}function Ts(){let t,r,i,s;return t=Ui,e.substr(Ui,2)===en?(r=en,Ui+=2):(r=n,0===Zi&&rs(tn)),r!==n&&(i=eo())!==n&&(s=Xs())!==n?(Hi=t,t=r=nn(s)):(Ui=t,t=n),t}function Es(){let t,r,i,s,o,a,l,c,h,u;if(t=Ui,(r=function(){let e,t;return e=Ui,(t=Ys())!==n&&(Hi=e,t=ir(t)),(e=t)===n&&(e=Ui,(t=js())!==n&&(Hi=e,t=sr(t)),e=t),e}())===n&&(42===e.charCodeAt(Ui)?(r=K,Ui++):(r=n,0===Zi&&rs(Z))),r!==n)if(i=Ui,(s=eo())!==n&&(o=Ts())!==n?i=s=[s,o]:(Ui=i,i=n),i===n&&(i=null),i!==n)if((s=to())!==n){if(o=Ui,(a=Vs())!==n){for(l=[],c=Ui,(h=Ks())!==n&&(u=As())!==n?c=h=[h,u]:(Ui=c,c=n);c!==n;)l.push(c),c=Ui,(h=Ks())!==n&&(u=As())!==n?c=h=[h,u]:(Ui=c,c=n);l!==n?o=a=[a,l]:(Ui=o,o=n)}else Ui=o,o=n;o===n&&(o=null),o!==n?(Hi=t,t=r=rn(r,i,o)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}function As(){let t;return(t=function t(){let r,i,s,o,a,l,c,h,u,d,f,p;if(r=Ui,(i=function(){let t;return e.substr(Ui,7)===ee?(t=ee,Ui+=7):(t=n,0===Zi&&rs(te)),t===n&&(e.substr(Ui,7)===X?(t=X,Ui+=7):(t=n,0===Zi&&rs(Q))),t}())!==n)if((s=eo())!==n)if((o=function(){let e,t,r;return e=Ui,(t=Xs())!==n?((r=Ms())===n&&(r=null),r!==n?(Hi=e,t=ln(t,r),e=t):(Ui=e,e=n)):(Ui=e,e=n),e}())!==n)if(a=Ui,(l=eo())!==n&&(c=Ts())!==n?a=l=[l,c]:(Ui=a,a=n),a===n&&(a=null),a!==n)if((l=to())!==n){if(c=Ui,(h=Vs())!==n){for(u=[],d=Ui,(f=Ks())!==n&&(p=t())!==n?d=f=[f,p]:(Ui=d,d=n);d!==n;)u.push(d),d=Ui,(f=Ks())!==n&&(p=t())!==n?d=f=[f,p]:(Ui=d,d=n);u!==n?c=h=[h,u]:(Ui=c,c=n)}else Ui=c,c=n;c===n&&(c=null),c!==n?(Hi=r,i=an(i,o,a,c),r=i):(Ui=r,r=n)}else Ui=r,r=n;else Ui=r,r=n;else Ui=r,r=n;else Ui=r,r=n;else Ui=r,r=n;return r}())===n&&(t=function t(){let r,i,s,o,a,l,c,h,u,d,f,p;if(r=Ui,(i=Xs())===n&&(42===e.charCodeAt(Ui)?(i=K,Ui++):(i=n,0===Zi&&rs(Z))),i!==n)if((s=eo())!==n)if((o=Os())!==n)if(a=Ui,(l=eo())!==n&&(c=function(){let e,t,r,i;return e=Ui,(t=Ys())===n&&(t=Xs()),t===n&&(t=null),t!==n?((r=eo())===n&&(r=null),r!==n?((i=Ps())===n&&(i=null),i!==n?(Hi=e,t=on(t,i),e=t):(Ui=e,e=n)):(Ui=e,e=n)):(Ui=e,e=n),e}())!==n?a=l=[l,c]:(Ui=a,a=n),a===n&&(a=null),a!==n)if((l=to())!==n){if(c=Ui,(h=Vs())!==n){for(u=[],d=Ui,(f=Ks())!==n&&(p=t())!==n?d=f=[f,p]:(Ui=d,d=n);d!==n;)u.push(d),d=Ui,(f=Ks())!==n&&(p=t())!==n?d=f=[f,p]:(Ui=d,d=n);u!==n?c=h=[h,u]:(Ui=c,c=n)}else Ui=c,c=n;c===n&&(c=null),c!==n?(Hi=r,i=sn(i,o,a,c),r=i):(Ui=r,r=n)}else Ui=r,r=n;else Ui=r,r=n;else Ui=r,r=n;else Ui=r,r=n;else Ui=r,r=n;return r}()),t}function Os(){let t;return e.substr(Ui,2)===mn?(t=mn,Ui+=2):(t=n,0===Zi&&rs(gn)),t===n&&(e.substr(Ui,2)===yn?(t=yn,Ui+=2):(t=n,0===Zi&&rs(_n)),t===n&&(61===e.charCodeAt(Ui)?(t=vn,Ui++):(t=n,0===Zi&&rs(bn)),t===n&&(e.substr(Ui,7)===X?(t=X,Ui+=7):(t=n,0===Zi&&rs(Q)),t===n&&(e.substr(Ui,7)===ee?(t=ee,Ui+=7):(t=n,0===Zi&&rs(te)))))),t}function Is(){let e;return(e=function(){let e,t,r;return e=Ui,(t=Bs())!==n?((r=Rs())===n&&(r=null),r!==n?(Hi=e,t=wn(t,r),e=t):(Ui=e,e=n)):(Ui=e,e=n),e}())===n&&(e=function(){let e,t;return e=Ui,(t=Ps())!==n&&(Hi=e,t=Sn(t)),e=t}())===n&&(e=function(){let e,t,r;return e=Ui,(t=Ys())!==n?((r=Rs())===n&&(r=null),r!==n?(Hi=e,t=Cn(t,r),e=t):(Ui=e,e=n)):(Ui=e,e=n),e}())===n&&(e=function(){let e,t,r;return e=Ui,(t=Xs())!==n?((r=Rs())===n&&(r=null),r!==n?(Hi=e,t=kn(t,r),e=t):(Ui=e,e=n)):(Ui=e,e=n),e}()),e}function Rs(){let t,r,i,s,o,a;return t=Ui,46===e.charCodeAt(Ui)?(r=xn,Ui++):(r=n,0===Zi&&rs(Tn)),r!==n?((i=Xs())===n&&(i=null),i!==n?(s=Ui,(o=eo())===n&&(o=null),o!==n&&(a=Ps())!==n?s=o=[o,a]:(Ui=s,s=n),s===n&&(s=null),s!==n?(Hi=t,t=r=En(i,s)):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),t}function Ns(){let t;return 63===e.charCodeAt(Ui)?(t=we,Ui++):(t=n,0===Zi&&rs(Se)),t===n&&(e.substr(Ui,3)===An?(t=An,Ui+=3):(t=n,0===Zi&&rs(On)),t===n&&(e.substr(Ui,3)===In?(t=In,Ui+=3):(t=n,0===Zi&&rs(Rn)),t===n&&(e.substr(Ui,6)===Nn?(t=Nn,Ui+=6):(t=n,0===Zi&&rs($n)),t===n&&(e.substr(Ui,4)===Pn?(t=Pn,Ui+=4):(t=n,0===Zi&&rs(jn)),t===n&&(e.substr(Ui,5)===Bn?(t=Bn,Ui+=5):(t=n,0===Zi&&rs(Mn))))))),t}function $s(){let t,r,i,s,o,a;return t=Ui,e.substr(Ui,6)===Vt?(r=Vt,Ui+=6):(r=n,0===Zi&&rs(Kt)),r!==n?(i=Ui,(s=eo())!==n&&(o=Ts())!==n?i=s=[s,o]:(Ui=i,i=n),i===n&&(i=null),i!==n?(s=Ui,(o=eo())!==n&&(a=Ds())!==n?s=o=[o,a]:(Ui=s,s=n),s===n&&(s=null),s!==n&&(o=to())!==n?(Hi=t,t=r=Un(i,s)):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),t}function Ps(){let t,r,i,s,o;return t=Ui,(r=function(){let t,r,i,s,o;if(t=Ui,35===e.charCodeAt(Ui)?(r=Hn,Ui++):(r=n,0===Zi&&rs(qn)),r!==n)if(Wn.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Vn)),i!==n){for(s=[],Kn.test(e.charAt(Ui))?(o=e.charAt(Ui),Ui++):(o=n,0===Zi&&rs(Zn));o!==n;)s.push(o),Kn.test(e.charAt(Ui))?(o=e.charAt(Ui),Ui++):(o=n,0===Zi&&rs(Zn));s!==n?(Hi=t,t=r=Jn()):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;return t}())!==n?(i=Ui,(s=eo())!==n&&(o=Ps())!==n?i=s=[s,o]:(Ui=i,i=n),i===n&&(i=null),i!==n?(Hi=t,t=r=Gn(r,i)):(Ui=t,t=n)):(Ui=t,t=n),t}function js(){let t,r,i,s,o;if(Zi++,t=Ui,38===e.charCodeAt(Ui)?(r=Xn,Ui++):(r=n,0===Zi&&rs(Qn)),r!==n)if(Wn.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Vn)),i!==n){for(s=[],Kn.test(e.charAt(Ui))?(o=e.charAt(Ui),Ui++):(o=n,0===Zi&&rs(Zn));o!==n;)s.push(o),Kn.test(e.charAt(Ui))?(o=e.charAt(Ui),Ui++):(o=n,0===Zi&&rs(Zn));s!==n?(Hi=t,t=r=Jn()):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(Yn)),t}function Bs(){let e,t,r,i,s;return e=Ui,(t=js())!==n?(r=Ui,(i=eo())!==n&&(s=Bs())!==n?r=i=[i,s]:(Ui=r,r=n),r===n&&(r=null),r!==n?(Hi=e,e=t=Gn(t,r)):(Ui=e,e=n)):(Ui=e,e=n),e}function Ms(){let e,t,r;return e=Ui,(t=eo())!==n&&(r=Ps())!==n?(Hi=e,e=t=er(r)):(Ui=e,e=n),e}function Ds(){let e,t,r;return e=Ui,(t=Gs())!==n?((r=Ms())===n&&(r=null),r!==n?(Hi=e,e=t=or(t,r)):(Ui=e,e=n)):(Ui=e,e=n),e===n&&(e=Ui,(t=Ys())!==n?((r=Ms())===n&&(r=null),r!==n?(Hi=e,e=t=ar(t,r)):(Ui=e,e=n)):(Ui=e,e=n),e===n&&(e=Ui,(t=Ps())!==n&&(Hi=e,t=lr(t)),e=t)),e}function zs(){let t,r,i,s,o,a;return t=Ui,e.substr(Ui,4)===cr?(r=cr,Ui+=4):(r=n,0===Zi&&rs(hr)),r!==n?(i=Ui,(s=eo())!==n&&(o=Ds())!==n?i=s=[s,o]:(Ui=i,i=n),i===n&&(i=null),i!==n?(s=Ui,(o=eo())!==n&&(a=Ts())!==n?s=o=[o,a]:(Ui=s,s=n),s===n&&(s=null),s!==n&&(o=to())!==n?(Hi=t,t=r=ur(i,s)):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),t}function Fs(){let t,r,i,s,o,a,l,c,h,u;if(t=Ui,r=[],i=Ui,(s=Ys())===n&&(42===e.charCodeAt(Ui)?(s=K,Ui++):(s=n,0===Zi&&rs(Z))),s!==n&&(o=eo())!==n?i=s=[s,o]:(Ui=i,i=n),i!==n)for(;i!==n;)r.push(i),i=Ui,(s=Ys())===n&&(42===e.charCodeAt(Ui)?(s=K,Ui++):(s=n,0===Zi&&rs(Z))),s!==n&&(o=eo())!==n?i=s=[s,o]:(Ui=i,i=n);else r=n;if(r!==n)if(123===e.charCodeAt(Ui)?(i=rt,Ui++):(i=n,0===Zi&&rs(it)),i!==n){if(s=Ui,(o=Ls())!==n){for(a=[],l=Ui,44===e.charCodeAt(Ui)?(c=st,Ui++):(c=n,0===Zi&&rs(ot)),c!==n&&(h=eo())!==n&&(u=Ls())!==n?l=c=[c,h,u]:(Ui=l,l=n);l!==n;)a.push(l),l=Ui,44===e.charCodeAt(Ui)?(c=st,Ui++):(c=n,0===Zi&&rs(ot)),c!==n&&(h=eo())!==n&&(u=Ls())!==n?l=c=[c,h,u]:(Ui=l,l=n);a!==n?s=o=[o,a]:(Ui=s,s=n)}else Ui=s,s=n;s===n&&(s=null),s!==n?(125===e.charCodeAt(Ui)?(o=at,Ui++):(o=n,0===Zi&&rs(lt)),o!==n?(Hi=t,t=r=dr(r,s)):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;return t}function Ls(){let e,t,r,i;return e=Ui,t=Ui,(r=qs())!==n&&(i=eo())!==n?t=r=[r,i]:(Ui=t,t=n),t===n&&(t=null),t!==n&&(r=Qs())!==n?(Hi=e,e=t=fr(t,r)):(Ui=e,e=n),e}function Us(){let t,r,i,s,o,a;if(t=Ui,e.substr(Ui,6)===pr?(r=pr,Ui+=6):(r=n,0===Zi&&rs(mr)),r!==n){if(i=[],s=Ui,(o=eo())!==n?(42===e.charCodeAt(Ui)?(a=K,Ui++):(a=n,0===Zi&&rs(Z)),a===n&&(a=Ys()),a!==n?s=o=[o,a]:(Ui=s,s=n)):(Ui=s,s=n),s!==n)for(;s!==n;)i.push(s),s=Ui,(o=eo())!==n?(42===e.charCodeAt(Ui)?(a=K,Ui++):(a=n,0===Zi&&rs(Z)),a===n&&(a=Ys()),a!==n?s=o=[o,a]:(Ui=s,s=n)):(Ui=s,s=n);else i=n;i!==n?((s=function(){let t,r,i,s,o,a,l,c,h,u,d;if(t=Ui,(r=eo())!==n)if(e.substr(Ui,7)===wr?(i=wr,Ui+=7):(i=n,0===Zi&&rs(Sr)),i!==n)if((s=eo())!==n)if((o=Ys())!==n){for(a=[],l=Ui,(c=eo())===n&&(c=null),c!==n?(44===e.charCodeAt(Ui)?(h=st,Ui++):(h=n,0===Zi&&rs(ot)),h!==n&&(u=eo())!==n&&(d=Ys())!==n?l=c=[c,h,u,d]:(Ui=l,l=n)):(Ui=l,l=n);l!==n;)a.push(l),l=Ui,(c=eo())===n&&(c=null),c!==n?(44===e.charCodeAt(Ui)?(h=st,Ui++):(h=n,0===Zi&&rs(ot)),h!==n&&(u=eo())!==n&&(d=Ys())!==n?l=c=[c,h,u,d]:(Ui=l,l=n)):(Ui=l,l=n);a!==n?(Hi=t,r=kr(o,a),t=r):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(s=null),s!==n?(Hi=t,t=r=gr(i,s)):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;return t}function Hs(){let e;return(e=function(){let e,t,r,i,s;return e=Ui,(t=qs())!==n&&(r=eo())!==n&&(i=Qs())!==n&&(s=to())!==n?(Hi=e,t=Cr(t,i),e=t):(Ui=e,e=n),e}())===n&&(e=ks()),e}function qs(){let t;return(t=function(){let t,r,i,s,o,a;if(t=Ui,e.substr(Ui,10)===qe?(r=qe,Ui+=10):(r=n,0===Zi&&rs(We)),r!==n){for(i=[],s=eo();s!==n;)i.push(s),s=eo();if(i!==n)if((s=Fs())===n&&(s=vs()),s!==n){for(o=[],a=eo();a!==n;)o.push(a),a=eo();o!==n?(62===e.charCodeAt(Ui)?(a=q,Ui++):(a=n,0===Zi&&rs(W)),a!==n?(Hi=t,r=Tr(s),t=r):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n}else Ui=t,t=n;return t}())===n&&(t=function(){let t,r,i,s,o,a;if(t=Ui,91===e.charCodeAt(Ui)?(r=Be,Ui++):(r=n,0===Zi&&rs(Me)),r!==n){for(i=[],s=eo();s!==n;)i.push(s),s=eo();if(i!==n)if((s=qs())!==n){for(o=[],a=eo();a!==n;)o.push(a),a=eo();o!==n?(93===e.charCodeAt(Ui)?(a=De,Ui++):(a=n,0===Zi&&rs(ze)),a!==n?(Hi=t,r=xr(s),t=r):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n}else Ui=t,t=n;return t}())===n&&(t=Ws())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u;if(t=Ui,40===e.charCodeAt(Ui)?(r=Fr,Ui++):(r=n,0===Zi&&rs(Lr)),r!==n)if((i=eo())===n&&(i=null),i!==n)if((s=Ws())!==n){if(o=[],a=Ui,(l=eo())!==n?(e.substr(Ui,2)===Ur?(c=Ur,Ui+=2):(c=n,0===Zi&&rs(Hr)),c!==n&&(h=eo())!==n&&(u=Ws())!==n?a=l=[l,c,h,u]:(Ui=a,a=n)):(Ui=a,a=n),a!==n)for(;a!==n;)o.push(a),a=Ui,(l=eo())!==n?(e.substr(Ui,2)===Ur?(c=Ur,Ui+=2):(c=n,0===Zi&&rs(Hr)),c!==n&&(h=eo())!==n&&(u=Ws())!==n?a=l=[l,c,h,u]:(Ui=a,a=n)):(Ui=a,a=n);else o=n;o!==n?((a=eo())===n&&(a=null),a!==n?(41===e.charCodeAt(Ui)?(l=qr,Ui++):(l=n,0===Zi&&rs(Wr)),l!==n?(Hi=t,r=Vr(s,o),t=r):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}())===n&&(t=function(){let t,r,i,s,o,a,l,c,h,u;if(t=Ui,40===e.charCodeAt(Ui)?(r=Fr,Ui++):(r=n,0===Zi&&rs(Lr)),r!==n)if((i=eo())===n&&(i=null),i!==n)if((s=Ws())!==n){for(o=[],a=Ui,(l=eo())===n&&(l=null),l!==n?(44===e.charCodeAt(Ui)?(c=st,Ui++):(c=n,0===Zi&&rs(ot)),c!==n?((h=eo())===n&&(h=null),h!==n&&(u=Ws())!==n?a=l=[l,c,h,u]:(Ui=a,a=n)):(Ui=a,a=n)):(Ui=a,a=n);a!==n;)o.push(a),a=Ui,(l=eo())===n&&(l=null),l!==n?(44===e.charCodeAt(Ui)?(c=st,Ui++):(c=n,0===Zi&&rs(ot)),c!==n?((h=eo())===n&&(h=null),h!==n&&(u=Ws())!==n?a=l=[l,c,h,u]:(Ui=a,a=n)):(Ui=a,a=n)):(Ui=a,a=n);o!==n?((a=eo())===n&&(a=null),a!==n?(41===e.charCodeAt(Ui)?(l=qr,Ui++):(l=n,0===Zi&&rs(Wr)),l!==n?(Hi=t,r=Kr(s,o),t=r):(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;else Ui=t,t=n;return t}()),t}function Ws(){let t,r;return t=Ui,e.substr(Ui,4)===Er?(r=Er,Ui+=4):(r=n,0===Zi&&rs(Ar)),r===n&&(e.substr(Ui,3)===Or?(r=Or,Ui+=3):(r=n,0===Zi&&rs(Ir)),r===n&&(e.substr(Ui,6)===Rr?(r=Rr,Ui+=6):(r=n,0===Zi&&rs(Nr)),r===n&&(e.substr(Ui,7)===$r?(r=$r,Ui+=7):(r=n,0===Zi&&rs(Pr)),r===n&&(e.substr(Ui,5)===jr?(r=jr,Ui+=5):(r=n,0===Zi&&rs(Br)),r===n&&(e.substr(Ui,6)===Mr?(r=Mr,Ui+=6):(r=n,0===Zi&&rs(Dr))))))),r!==n&&(Hi=t,r=zr(r)),t=r}function Vs(){let t,r,i,s;if(Zi++,t=Ui,Zi++,r=Ui,i=[],32===e.charCodeAt(Ui)?(s=Qr,Ui++):(s=n,0===Zi&&rs(ei)),s!==n)for(;s!==n;)i.push(s),32===e.charCodeAt(Ui)?(s=Qr,Ui++):(s=n,0===Zi&&rs(ei));else i=n;return i!==n?(Hi=Ui,(s=(s=ti(i))?void 0:n)!==n?r=i=[i,s]:(Ui=r,r=n)):(Ui=r,r=n),Zi--,r!==n?(Ui=t,t=void 0):t=n,Zi--,t===n&&(r=n,0===Zi&&rs(Xr)),t}function Ks(){let t,r,i,s,o;for(Zi++,t=Ui,r=Ui,Zi++,i=Ui,s=[],32===e.charCodeAt(Ui)?(o=Qr,Ui++):(o=n,0===Zi&&rs(ei));o!==n;)s.push(o),32===e.charCodeAt(Ui)?(o=Qr,Ui++):(o=n,0===Zi&&rs(ei));if(s!==n?(Hi=Ui,(o=(o=ri(s))?void 0:n)!==n?i=s=[s,o]:(Ui=i,i=n)):(Ui=i,i=n),Zi--,i!==n?(Ui=r,r=void 0):r=n,r!==n){for(i=[],32===e.charCodeAt(Ui)?(s=Qr,Ui++):(s=n,0===Zi&&rs(ei));s!==n;)i.push(s),32===e.charCodeAt(Ui)?(s=Qr,Ui++):(s=n,0===Zi&&rs(ei));i!==n?t=r=[r,i]:(Ui=t,t=n)}else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(ni)),t}function Zs(){let t,r,i,s,o;for(Zi++,t=Ui,r=Ui,Zi++,i=Ui,s=[],32===e.charCodeAt(Ui)?(o=Qr,Ui++):(o=n,0===Zi&&rs(ei));o!==n;)s.push(o),32===e.charCodeAt(Ui)?(o=Qr,Ui++):(o=n,0===Zi&&rs(ei));if(s!==n?(Hi=Ui,(o=(o=si(s))?void 0:n)!==n?i=s=[s,o]:(Ui=i,i=n)):(Ui=i,i=n),Zi--,i!==n?(Ui=r,r=void 0):r=n,r!==n){for(i=[],32===e.charCodeAt(Ui)?(s=Qr,Ui++):(s=n,0===Zi&&rs(ei));s!==n;)i.push(s),32===e.charCodeAt(Ui)?(s=Qr,Ui++):(s=n,0===Zi&&rs(ei));i!==n?(Hi=t,t=r=v()):(Ui=t,t=n)}else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(ii)),t}function Js(){let t,r,i,s;if(Zi++,t=Ui,96===e.charCodeAt(Ui)?(r=ui,Ui++):(r=n,0===Zi&&rs(di)),r!==n){if(i=[],fi.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(pi)),s!==n)for(;s!==n;)i.push(s),fi.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(pi));else i=n;i!==n?(96===e.charCodeAt(Ui)?(s=ui,Ui++):(s=n,0===Zi&&rs(di)),s!==n?(Hi=t,t=r=mi(i)):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(hi)),t}function Gs(){let t,r,i,s;if(Zi++,t=Ui,39===e.charCodeAt(Ui)?(r=yi,Ui++):(r=n,0===Zi&&rs(_i)),r!==n){if(i=[],vi.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(bi)),s!==n)for(;s!==n;)i.push(s),vi.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(bi));else i=n;i!==n?(39===e.charCodeAt(Ui)?(s=yi,Ui++):(s=n,0===Zi&&rs(_i)),s!==n?(Hi=t,t=r=wi(i)):(Ui=t,t=n)):(Ui=t,t=n)}else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(gi)),t}function Ys(){let t,r,i,s;if(Zi++,t=Ui,ki.test(e.charAt(Ui))?(r=e.charAt(Ui),Ui++):(r=n,0===Zi&&rs(Ci)),r!==n){for(i=[],xi.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(Ti));s!==n;)i.push(s),xi.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(Ti));i!==n?(Hi=t,t=r=v()):(Ui=t,t=n)}else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(Si)),t}function Xs(){let t,r,i,s,o;if(Zi++,t=Ui,r=Ui,Zi++,i=function(){let t,r,i,s;return t=Ui,(r=Os())===n&&(r=fs())===n&&(r=Ns())===n&&(e.substr(Ui,8)===ge?(r=ge,Ui+=8):(r=n,0===Zi&&rs(ye)),r===n&&(e.substr(Ui,6)===Yt?(r=Yt,Ui+=6):(r=n,0===Zi&&rs(Xt)),r===n&&(e.substr(Ui,6)===B?(r=B,Ui+=6):(r=n,0===Zi&&rs(M)),r===n&&(e.substr(Ui,9)===F?(r=F,Ui+=9):(r=n,0===Zi&&rs(L)),r===n&&(e.substr(Ui,6)===pr?(r=pr,Ui+=6):(r=n,0===Zi&&rs(mr)),r===n&&(e.substr(Ui,7)===zn?(r=zn,Ui+=7):(r=n,0===Zi&&rs(Fn)),r===n&&(e.substr(Ui,6)===Vt?(r=Vt,Ui+=6):(r=n,0===Zi&&rs(Kt))))))))),r!==n?(oi.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(ai)),i===n&&(i=Ui,Zi++,e.length>Ui?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(li)),Zi--,s===n?i=void 0:(Ui=i,i=n)),i!==n?(Hi=t,t=r=ci(r)):(Ui=t,t=n)):(Ui=t,t=n),t}(),Zi--,i===n?r=void 0:(Ui=r,r=n),r!==n)if(Ai.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Oi)),i!==n){for(s=[],xi.test(e.charAt(Ui))?(o=e.charAt(Ui),Ui++):(o=n,0===Zi&&rs(Ti));o!==n;)s.push(o),xi.test(e.charAt(Ui))?(o=e.charAt(Ui),Ui++):(o=n,0===Zi&&rs(Ti));s!==n?(Hi=t,t=r=v()):(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(Ei)),t}function Qs(){let t,r,i,s;if(Zi++,t=Ui,Ai.test(e.charAt(Ui))?(r=e.charAt(Ui),Ui++):(r=n,0===Zi&&rs(Oi)),r!==n){for(i=[],xi.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(Ti));s!==n;)i.push(s),xi.test(e.charAt(Ui))?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(Ti));i!==n?(Hi=t,t=r=v()):(Ui=t,t=n)}else Ui=t,t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(Ii)),t}function eo(){let t,r;if(Zi++,t=[],32===e.charCodeAt(Ui)?(r=Qr,Ui++):(r=n,0===Zi&&rs(ei)),r!==n)for(;r!==n;)t.push(r),32===e.charCodeAt(Ui)?(r=Qr,Ui++):(r=n,0===Zi&&rs(ei));else t=n;return Zi--,t===n&&(r=n,0===Zi&&rs(Ri)),t}function to(){let t,r,i,s,o;for(Zi++,t=Ui,r=[],$i.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Pi));i!==n;)r.push(i),$i.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Pi));if(r!==n?(i=Ui,Zi++,e.length>Ui?(s=e.charAt(Ui),Ui++):(s=n,0===Zi&&rs(li)),Zi--,s===n?i=void 0:(Ui=i,i=n),i!==n?t=r=[r,i]:(Ui=t,t=n)):(Ui=t,t=n),t===n){for(t=Ui,r=[],$i.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Pi));i!==n;)r.push(i),$i.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Pi));if(r!==n)if(e.substr(Ui,2)===ji?(i=ji,Ui+=2):(i=n,0===Zi&&rs(Bi)),i!==n){for(s=[],y.test(e.charAt(Ui))?(o=e.charAt(Ui),Ui++):(o=n,0===Zi&&rs(_));o!==n;)s.push(o),y.test(e.charAt(Ui))?(o=e.charAt(Ui),Ui++):(o=n,0===Zi&&rs(_));s!==n&&(o=to())!==n?t=r=[r,i,s,o]:(Ui=t,t=n)}else Ui=t,t=n;else Ui=t,t=n;if(t===n){for(t=Ui,r=[],$i.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Pi));i!==n;)r.push(i),$i.test(e.charAt(Ui))?(i=e.charAt(Ui),Ui++):(i=n,0===Zi&&rs(Pi));r!==n&&(i=no())!==n?((s=to())===n&&(s=null),s!==n?t=r=[r,i,s]:(Ui=t,t=n)):(Ui=t,t=n)}}return Zi--,t===n&&(r=n,0===Zi&&rs(Ni)),t}function no(){let t,r,i,s;return Zi++,t=Ui,13===e.charCodeAt(Ui)?(r=Di,Ui++):(r=n,0===Zi&&rs(zi)),r===n&&(r=null),r!==n?(10===e.charCodeAt(Ui)?(i=Fi,Ui++):(i=n,0===Zi&&rs(Li)),i!==n?(13===e.charCodeAt(Ui)?(s=Di,Ui++):(s=n,0===Zi&&rs(zi)),s===n&&(s=null),s!==n?t=r=[r,i,s]:(Ui=t,t=n)):(Ui=t,t=n)):(Ui=t,t=n),Zi--,t===n&&(r=n,0===Zi&&rs(Mi)),t}let ro=\"\",io=\"\";const so=[],oo=()=>({kind:\"handle-ref\",id:null,name:null,tags:[],location:Gi()});function ao(e){return e[1].map(e=>e[1])}function lo(e,t,n){if(null!==e){const n=t(e);if(null!==n)return n}return null===n?null:n}if((Wi=i())!==n&&Ui===e.length)return Wi;throw Wi!==n&&Ui<e.length&&rs({type:\"end\"}),is(Ki,Vi<e.length?e.charAt(Vi):null,Vi<e.length?ns(Vi,Vi+1):ns(Vi,Vi))};var Et,At=n(21),Ot=n.n(At);async function It(e){const t=Ot.a.createHash(\"sha1\");return t.update(e),Promise.resolve().then(()=>t.digest(\"hex\"))}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class Rt{constructor(){this.storageKey=null,this.name=null}apply(e){e.forEach(e=>{this[e.key]=e.value})}}function Nt(e,t){return e===t?0:null===e?-1:1}function $t(e,t){return null==e||null==t?Nt(e,t):e.localeCompare(t)}function Pt(e,t){return null==e||null==t?Nt(e,t):e-t}function jt(e,t,n){if(d()(null!=e),d()(null!=t),e.length!==t.length)return Pt(e.length,t.length);for(let r=0;r<e.length;r++){let i;if(0!==(i=n(e[r],t[r])))return i}return 0}function Bt(e,t){return null==e||null==t?Nt(e,t):e._compareTo(t)}class Mt{}class Dt extends Mt{constructor(e,t){super(),this.particle=e,this.connection=t}_clone(e){return new Dt(this.particle,this.connection)}_compareTo(e){let t;return 0!==(t=$t(this.particle.name,e.particle.name))?t:0!==(t=$t(this.connection,e.connection))?t:0}toString(e){return this.connection?`${this.particle.name}.${this.connection}`:`${this.particle.name}`}}class zt extends Mt{constructor(e,t){super(),d()(e),this.instance=e,this.connection=t}_clone(e){return new zt(e.get(this.instance),this.connection)}_compareTo(e){let t;return 0!==(t=Bt(this.instance,e.instance))?t:0!==(t=$t(this.connection,e.connection))?t:0}toString(e){return this.connection?`${e.get(this.instance)}.${this.connection}`:`${e.get(this.instance)}`}}class Ft extends Mt{constructor(e){super(),this.handle=e}_clone(e){return new Ft(this.handle)}_compareTo(e){let t;return 0!==(t=$t(this.handle.localName,e.handle.localName))?t:0}toString(e){return`${this.handle.localName}`}}class Lt extends Mt{constructor(e){super(),this.tags=e}_clone(e){return new Lt(this.tags)}_compareTo(e){let t;return 0!==(t=jt(this.tags,e.tags,$t))?t:0}toString(e){return this.tags.map(e=>`#${e}`).join(\" \")}}class Ut{constructor(e,t,n,r){d()(n),d()(r),this.from=e,this.to=t,this.direction=n,this.type=r,Object.freeze(this)}_copyInto(e,t){if(\"constraint\"===this.type){if(!(this.from instanceof zt||this.to instanceof zt))return e.newConnectionConstraint(this.from._clone(),this.to._clone(),this.direction);d()(!1)}return e.newObligation(this.from._clone(t),this.to._clone(t),this.direction)}_compareTo(e){let t;return 0!==(t=this.from._compareTo(e.from))?t:0!==(t=this.to._compareTo(e.to))?t:0!==(t=$t(this.direction,e.direction))?t:0}toString(e,t){let n=\"\";return t&&!0===t.showUnresolved&&\"obligation\"===this.type&&(n=\" // unresolved obligation\"),`${this.from.toString(e)} ${this.direction} ${this.to.toString(e)}${n}`}}class Ht{constructor(e){this._id=null,this._localName=void 0,this._tags=[],this._type=void 0,this._fate=null,this._originalFate=null,this._originalId=null,this._connections=[],this._mappedType=void 0,this._storageKey=void 0,this._pattern=void 0,this._immediateValue=void 0,d()(e),this._recipe=e}_copyInto(e,t,n){let r=void 0;return null!==this._id&&[\"map\",\"use\",\"copy\"].includes(this.fate)&&(r=e.findHandle(this._id)),null==r&&((r=e.newHandle())._id=this._id,r._tags=[...this._tags],r._type=this._type?this._type._cloneWithResolutions(n):void 0,r._fate=this._fate,r._originalFate=this._originalFate,r._originalId=this._originalId,r._mappedType=this._mappedType,r._storageKey=this._storageKey,r._immediateValue=this._immediateValue,r._connections=[],r._pattern=this._pattern),r}mergeInto(e){for(d()(this.recipe===e.recipe,\"Cannot merge handles from different recipes.\");this.connections.length>0;){const[t]=this.connections;t.disconnectHandle(),t.connectToHandle(e)}e._immediateValue=this._immediateValue,e.tags=e.tags.concat(this.tags),e.recipe.removeHandle(this),e.fate=this._mergedFate([this.fate,e.fate])}_mergedFate(e){return d()(e.length>0,\"Cannot merge empty fates list\"),d()(!e.includes(\"map\")&&!e.includes(\"copy\"),\"Merging map/copy not supported yet\"),e.every(e=>\"use\"===e)?\"use\":\"create\"}_startNormalize(){this._localName=null,this._tags.sort()}_finishNormalize(){for(const e of this._connections)d()(Object.isFrozen(e),`Handle connection '${e.name}' is not frozen.`);this._connections.sort(Bt),Object.freeze(this)}_compareTo(e){let t;return 0!==(t=$t(this._id,e._id))?t:0!==(t=$t(this._localName,e._localName))?t:0!==(t=jt(this._tags,e._tags,$t))?t:0!==(t=$t(this.fate,e.fate))?t:0!==(t=$t(this._immediateValue&&this._immediateValue.toString()||\"\",e._immediateValue&&e._immediateValue.toString()||\"\"))?t:0}get fate(){return this._fate||\"?\"}set fate(e){null==this._originalFate&&(this._originalFate=this._fate),this._fate=e}get originalFate(){return this._originalFate||\"?\"}get originalId(){return this._originalId}get recipe(){return this._recipe}get tags(){return this._tags}set tags(e){this._tags=e}get type(){return this._type}get id(){return this._id}set id(e){this._originalId||(this._originalId=this._id),this._id=e}mapToStorage(e){if(!e)throw new Error(\"Cannot map to undefined storage\");this._id=e.id,this._originalId=e.originalId,this._type=void 0,this._mappedType=e.type,this._storageKey=e.storageKey}get localName(){return this._localName}set localName(e){this._localName=e}get connections(){return this._connections}get storageKey(){return this._storageKey}set storageKey(e){this._storageKey=e}get pattern(){return this._pattern}set pattern(e){this._pattern=e}get mappedType(){return this._mappedType}set mappedType(e){this._mappedType=e}get immediateValue(){return this._immediateValue}set immediateValue(e){this._immediateValue=e}static effectiveType(e,t){const n=new Map,r=t.filter(e=>null!=e.type).map(e=>({type:e.type._cloneWithResolutions(n),direction:e.direction}));return Xe.processTypeList(e?e._cloneWithResolutions(n):null,r)}static resolveEffectiveType(e,t){const n=t.filter(e=>null!=e.type).map(e=>({type:e.type,direction:e.direction}));return Xe.processTypeList(e,n)}_isValid(e){const t=new Set;for(const n of this._connections){if(\"map\"===this.fate&&[\"out\",\"inout\"].includes(n.direction))return e&&e.errors&&e.errors.set(this,`Invalid fate '${this.fate}' for handle '${this}'; it is used for '${n.direction}' ${n.getQualifiedName()} connection`),!1;n.tags.forEach(e=>t.add(e))}const n=Ht.resolveEffectiveType(this._mappedType,this._connections);return n?(this._type=n,this._tags.forEach(e=>t.add(e)),this._tags=[...t],!0):(e&&e.errors&&e.errors.set(this,`Type validations failed for handle '${this}'`),!1)}isResolved(e){d()(Object.isFrozen(this));let t=!0;if(this.type){let n=!0;\"create\"!==this.fate&&\"`slot\"!==this.fate||(n=!1),(n&&!this.type.isResolved()||!this.type.canEnsureResolved())&&(e&&e.details.push(\"unresolved type\"),t=!1)}else e&&e.details.push(\"missing type\"),t=!1;switch(this.fate){case\"?\":e&&e.details.push(\"missing fate\"),t=!1;break;case\"copy\":case\"map\":case\"use\":e&&null===this.id&&e.details.push(\"missing id\"),t=t&&null!==this.id;break;case\"`slot\":case\"create\":break;default:throw e&&e.details.push(`invalid fate ${this.fate}`),new Error(`Unexpected fate: ${this.fate}`)}return t}toString(e,t){if(this._immediateValue)return;t=t||{};const n=[];if(n.push(this.fate),this.id&&n.push(`'${this.id}'`),n.push(...this.tags.map(e=>`#${e}`)),n.push(`as ${e&&e.get(this)||this.localName}`),this.type)if(n.push(\"//\"),this.type.isResolved())n.push(this.type.resolvedType().toString({hideFields:null==t.hideFields||t.hideFields}));else if(n.push(this.type.toString()),t.showUnresolved&&this.type.canEnsureResolved()){const e=Le.fromLiteral(this.type.toLiteral());e.maybeEnsureResolved(),n.push(\"//\"),n.push(e.resolvedType().toString({hideFields:null==t.hideFields||t.hideFields}))}if(t.showUnresolved){const e={details:[]};this.isResolved(e)||n.push(` // unresolved handle: ${e.details.join(\", \")}`)}return n.join(\" \")}findConnectionByDirection(e){return this._connections.find(t=>t.direction===e)}}class qt{constructor(e,t){this._tags=[],this.resolvedType=void 0,this._direction=void 0,this._handle=void 0,d()(t),d()(t.recipe),this._recipe=t.recipe,this._name=e,this._particle=t}_clone(e,t){if(t.has(this))return t.get(this);const n=new qt(this._name,e);return n._tags=[...this._tags],n.resolvedType=this.resolvedType,n._direction=this._direction,null!=this._handle&&(n._handle=t.get(this._handle),d()(void 0!==n._handle),n._handle.connections.push(n)),t.set(this,n),n}cloneTypeWithResolutions(e){this.resolvedType&&(this.resolvedType=this.resolvedType._cloneWithResolutions(e))}_normalize(){this._tags.sort(),Object.freeze(this)}_compareTo(e){let t;return 0!==(t=Bt(this._particle,e._particle))?t:0!==(t=$t(this._name,e._name))?t:0!==(t=jt(this._tags,e._tags,$t))?t:0!==(t=Bt(this._handle,e._handle))?t:0!==(t=$t(this._direction,e._direction))?t:0}get recipe(){return this._recipe}get name(){return this._name}getQualifiedName(){return`${this.particle.name}::${this.name}`}get tags(){return this._tags}get type(){if(this.resolvedType)return this.resolvedType;const e=this.spec;return e?e.type:null}get direction(){if(this._direction)return this._direction;const e=this.spec;return e?e.direction:null}get isInput(){return\"in\"===this.direction||\"inout\"===this.direction}get isOutput(){return\"out\"===this.direction||\"inout\"===this.direction}get handle(){return this._handle}get particle(){return this._particle}set tags(e){this._tags=e}set type(e){this.resolvedType=e,this._resetHandleType()}set direction(e){this._direction=e,this._resetHandleType()}get spec(){return null==this.particle.spec?null:this.particle.spec.handleConnectionMap.get(this.name)}get isOptional(){return null!=this.spec&&this.spec.isOptional}_isValid(e){if(this.direction&&![\"in\",\"out\",\"inout\",\"host\",\"`consume\",\"`provide\"].includes(this.direction))return e&&e.errors&&e.errors.set(this,`Invalid direction '${this.direction}' for handle connection '${this.getQualifiedName()}'`),!1;if(this.particle.spec&&this.name){const t=this.spec;if(!t)return e&&e.errors&&e.errors.set(this,`Connection ${this.name} is not defined by ${this.particle.name}.`),!1;if(this.direction!==t.direction&&(![\"in\",\"out\"].includes(this.direction)||\"inout\"!==t.direction))return e&&e.errors&&e.errors.set(this,`Direction '${this.direction}' for handle connection '${this.getQualifiedName()}' doesn't match particle spec's direction '${t.direction}'`),!1;if(this.resolvedType){if(!t.isCompatibleType(this.resolvedType))return e&&e.errors&&e.errors.set(this,`Type '${this.resolvedType.toString()} for handle connection '${this.getQualifiedName()}' doesn't match particle spec's type '${t.type.toString()}'`),!1}else this.resolvedType=t.type}return!0}isResolved(e){let t;return d()(Object.isFrozen(this)),!this.spec||!this.spec.parentConnection||(t=this.particle.connections[this.spec.parentConnection.name])&&t.handle?this.handle?this.direction?!!this.type||(e&&(e.details=\"missing type\"),!1):(e&&(e.details=\"missing direction\"),!1):!!this.isOptional||(e&&(e.details=\"missing handle\"),!1):(e&&(e.details=\"parent connection missing handle\"),!1)}_resetHandleType(){this._handle&&(this._handle._type=void 0)}connectToHandle(e){d()(e.recipe===this.recipe),this._handle=e,this._resetHandleType(),this._handle.connections.push(this)}disconnectHandle(){const e=this._handle.connections.indexOf(this);d()(e>=0),this._handle.connections.splice(e,1),this._handle=void 0}toString(e,t){const n=[];return n.push(this.name||\"*\"),n.push({in:\"<-\",out:\"->\",inout:\"=\",host:\"=\",\"`consume\":\"<-\",\"`provide\":\"->\"}[this.direction]||this.direction||\"=\"),this.handle&&(this.handle.immediateValue?n.push(this.handle.immediateValue.name):n.push(`${e&&e.get(this.handle)||this.handle.localName}`)),n.push(...this.tags.map(e=>`#${e}`)),t&&t.showUnresolved&&(this.isResolved(t)||n.push(`// unresolved handle-connection: ${t.details}`)),n.join(\" \")}findSpecsForUnnamedHandles(){return this.particle.spec.handleConnections.filter(e=>!e.isOptional&&Xe.compareTypes({type:this.handle.type},{type:e.type})&&!this.particle.getConnectionByName(e.name))}}class Wt{constructor(e,t){this._targetSlot=void 0,this._providedSlots={},this._tags=[],d()(t),d()(t.recipe),d()(e),this._recipe=t.recipe,this._particle=t,this._name=e}remove(){this._particle.removeSlotConnection(this)}get recipe(){return this._recipe}get particle(){return this._particle}get name(){return this._name}getQualifiedName(){return`${this.particle.name}::${this.name}`}get targetSlot(){return this._targetSlot}set targetSlot(e){this._targetSlot=e}get providedSlots(){return this._providedSlots}get tags(){return this._tags}set tags(e){this._tags=e}getSlotSpec(){return this.particle.spec&&this.particle.spec.getSlotSpec(this.name)}connectToSlot(e){d()(e),d()(!this.targetSlot),d()(this.recipe instanceof Gt||this.recipe===e.recipe,\"Cannot connect to slot from different recipe\"),this._targetSlot=e,e.consumeConnections.push(this)}disconnectFromSlot(){this._targetSlot&&(this._targetSlot.removeConsumeConnection(this),this._targetSlot=void 0)}_clone(e,t){if(t.has(this))return t.get(this);const n=e.addSlotConnectionAsCopy(this.name);return n.tags=this.tags,t.set(this,n),n}_normalize(){const e={};for(const t of Object.keys(this._providedSlots).sort())e[t]=this._providedSlots[t];this._providedSlots=e,Object.freeze(this)}_compareTo(e){let t;return 0!==(t=$t(this.name,e.name))?t:0!==(t=Bt(this._targetSlot,e._targetSlot))?t:0!==(t=Bt(this._particle,e._particle))?t:0}_isValid(e){return!this._targetSlot||!this._targetSlot.sourceConnection||this._targetSlot===this._targetSlot.sourceConnection.providedSlots[this._targetSlot.name]||(e&&e.errors&&e.errors.set(this,`Invalid target slot '${this._targetSlot.name}' for slot connection '${this.name}' of particle ${this.particle.name}`),!1)}isResolved(e){return d()(Object.isFrozen(this)),this.name?this.particle?null!=this.getSlotSpec()&&!this.getSlotSpec().isRequired||this.targetSlot&&(this.targetSlot.id||this.targetSlot.sourceConnection.isConnected())?!this.targetSlot||(null==this.getSlotSpec()||this.getSlotSpec().provideSlotConnections.every(t=>!t.isRequired||0!==this.providedSlots[t.name].consumeConnections.length||(e&&(e.details=\"missing consuming slot\"),!1))):(e&&(e.details=\"missing target-slot\"),!1):(e&&(e.details=\"missing particle\"),!1):(e&&(e.details=\"missing name\"),!1)}isConnectedToInternalSlot(){return this.targetSlot&&!!this.targetSlot.sourceConnection}isConnectedToRemoteSlot(){return this.targetSlot&&!!this.targetSlot.id}isConnected(){return this.isConnectedToInternalSlot()||this.isConnectedToRemoteSlot()}toString(e,t){const n=[];n.push(\"consume\"),n.push(`${this.name}`),this.targetSlot&&n.push(`as ${e&&e.get(this.targetSlot)||this.targetSlot.localName}`),t&&t.showUnresolved&&(this.isResolved(t)||n.push(`// unresolved slot-connection: ${t.details}`));const r=[];return r.push(n.join(\" \")),Object.keys(this.providedSlots).forEach(t=>{const n=this.providedSlots[t],i=[];if(i.push(\"  provide\"),this.getSlotSpec()){const e=this.particle.getSlotSpecByName(t);d()(e,`Cannot find providedSlotSpec for ${t}`)}i.push(`${t} as ${e&&e.get(n)||n}`),r.push(i.join(\" \"))}),r.join(\"\\n\")}}class Vt{constructor(e,t){this._id=void 0,this._localName=void 0,this.spec=void 0,this._verbs=[],this._tags=[],this._connections={},this._unnamedConnections=[],this._consumedSlotConnections={},d()(e),this._recipe=e,this._name=t}_copyInto(e,t,n){const r=e.newParticle(this._name);r._id=this._id,r._verbs=[...this._verbs],r._tags=[...this._tags],r.spec=this.spec?this.spec.cloneWithResolutions(n):void 0,Object.keys(this._connections).forEach(e=>{r._connections[e]=this._connections[e]._clone(r,t)}),r._unnamedConnections=this._unnamedConnections.map(e=>e._clone(r,t)),r._cloneConnectionRawTypes(n);for(const[n,i]of Object.entries(this.consumedSlotConnections)){r.consumedSlotConnections[n]=i._clone(r,t),t.has(i.targetSlot)&&(d()(e instanceof Gt),r.consumedSlotConnections[n].connectToSlot(t.get(i.targetSlot)),-1===r.recipe.slots.indexOf(t.get(i.targetSlot))&&r.recipe.slots.push(t.get(i.targetSlot)));for(const[s,o]of Object.entries(i.providedSlots))if(t.has(o)){d()(e instanceof Gt);const i=t.get(o);i.sourceConnection=r.consumedSlotConnections[n],r.consumedSlotConnections[n].providedSlots[s]=i,-1===r.recipe.slots.indexOf(i)&&r.recipe.slots.push(i)}}return r}_cloneConnectionRawTypes(e){for(const t of Object.values(this._connections))t.cloneTypeWithResolutions(e);for(const t of this._unnamedConnections)t.cloneTypeWithResolutions(e)}_startNormalize(){this._localName=null,this._verbs.sort(),this._tags.sort();const e={};for(const t of Object.keys(this._connections).sort())e[t]=this._connections[t];this._connections=e;const t={};for(const e of Object.keys(this._consumedSlotConnections).sort())t[e]=this._consumedSlotConnections[e];this._consumedSlotConnections=t}_finishNormalize(){this._unnamedConnections.sort(Bt),Object.freeze(this)}_compareTo(e){let t;return 0!==(t=$t(this._id?this._id.toString():\"\",e._id?e._id.toString():\"\"))?t:0!==(t=$t(this._name,e._name))?t:0!==(t=$t(this._localName,e._localName))?t:0!==(t=jt(this._verbs,e._verbs,$t))?t:0!==(t=jt(this._tags,e._tags,$t))?t:0}matches(e){if(this.name&&e.name&&this.name!==e.name)return!1;for(const[t,n]of Object.entries(this.consumedSlotConnections)){if(null==e.consumedSlotConnections[t]||null==e.consumedSlotConnections[t].targetSlot)return!1;if(n.targetSlot&&n.targetSlot.id&&n.targetSlot.id!==e.consumedSlotConnections[t].targetSlot.id)return!1;for(const r of Object.keys(n.providedSlots)){const i=n.providedSlots[r],s=e.consumedSlotConnections[t].providedSlots[r];if(null==s||i.id&&s.id&&i.id!==s.id)return!1}}return!0}_isValid(e){return!this.spec||(!(!this.name&&!this.primaryVerb)||(e&&e.errors&&e.errors.set(this,\"Particle has no name and no verb\"),!1))}isResolved(e){if(d()(Object.isFrozen(this)),!this.spec)return e&&e.showUnresolved&&(e.details=\"missing spec\"),!1;if(this.spec.slotConnections.size>0){if(0===Object.values(this.consumedSlotConnections).filter(e=>void 0!==e.targetSlot).length)return e&&e.showUnresolved&&(e.details=\"unfullfilled slot connections\"),!1}if(!this.spec)return e&&e.showUnresolved&&(e.details=\"missing spec\"),!1;const t=this.getUnboundConnections().filter(e=>{let t=e.parentConnection;for(;null!==t;){if(!this.connections[t.name])return!1;t=t.parentConnection}return!0});return t.length>0?(e&&e.showUnresolved&&(e.details=`unresolved connections: ${t.map(e=>e.name).join(\", \")}`),!1):0===this.unnamedConnections.length||(e&&e.showUnresolved&&(e.details=`${this.unnamedConnections.length} unnamed connections`),!1)}get recipe(){return this._recipe}get localName(){return this._localName}set localName(e){this._localName=e}get id(){return this._id}set id(e){d()(!this._id,\"Particle ID can only be set once.\"),this._id=e}get name(){return this._name}set name(e){this._name=e}get connections(){return this._connections}get unnamedConnections(){return this._unnamedConnections}get consumedSlotConnections(){return this._consumedSlotConnections}get primaryVerb(){return this._verbs.length>0?this._verbs[0]:void 0}set verbs(e){this._verbs=e}set tags(e){this._tags=e}addUnnamedConnection(){const e=new qt(void 0,this);return this._unnamedConnections.push(e),e}addConnectionName(e){return d()(e,\"Cannot create connection with no name\"),d()(null==this._connections[e]),this._connections[e]=new qt(e,this),this._connections[e]}allConnections(){return Object.values(this._connections).concat(this._unnamedConnections)}ensureConnectionName(e){return this._connections[e]||this.addConnectionName(e)}getConnectionByName(e){return this._connections[e]}nameConnection(e,t){d()(!this._connections[t],`Connection \"${t}\" already has a handle`);const n=this._unnamedConnections.indexOf(e);d()(n>=0,`Cannot name '${t}' nonexistent unnamed connection.`),e._name=t;const r=this.spec.getConnectionByName(t);e.type=r.type,e.direction!==r.direction&&(d()(\"inout\"===e.direction,`Unnamed connection cannot adjust direction ${e.direction} to ${t}'s direction ${r.direction}`),e.direction=r.direction),this._connections[t]=e,this._unnamedConnections.splice(n,1)}getUnboundConnections(e){return this.spec.handleConnections.filter(t=>!t.isOptional&&!this.getConnectionByName(t.name)&&(!e||Xe.compareTypes({type:e},{type:t.type})))}addSlotConnection(e){d()(!(e in this._consumedSlotConnections),\"slot connection already exists\"),d()(!this.spec||this.spec.slotConnections.has(e),\"slot connection not in particle spec\");const t=new Wt(e,this);this._consumedSlotConnections[e]=t;const n=this.getSlotSpecByName(e);return n&&n.provideSlotConnections.forEach(e=>{const n=this.recipe.newSlot(e.name);n.sourceConnection=t,t.providedSlots[e.name]=n}),t}addSlotConnectionAsCopy(e){const t=new Wt(e,this);return this._consumedSlotConnections[e]=t,t}removeSlotConnection(e){this._consumedSlotConnections[e.name]=null,e.disconnectFromSlot()}remove(){this.recipe.removeParticle(this)}getSlotConnectionBySpec(e){return Object.values(this._consumedSlotConnections).find(t=>t.getSlotSpec()===e)}getSlotSpecByName(e){if(!this.spec)return;const t=this.spec.slotConnections.get(e);if(t)return t;for(const t of this.spec.slotConnections.values())for(const n of t.provideSlotConnections)if(n.name===e)return n}getSlotConnectionByName(e){return this._consumedSlotConnections[e]}getProvidedSlotByName(e,t){return this.consumedSlotConnections[e]&&this.consumedSlotConnections[e].providedSlots[t]}getSlotSpecs(){return this.spec?this.spec.slotConnections:new Map}toString(e,t){let n=[];this.name?(n.push(this.name),n.push(`as ${e&&e.get(this)||this.localName}`),this.primaryVerb&&this.primaryVerb!==this.name&&n.push(`// verb=${this.primaryVerb}`)):n.push(`&${this.primaryVerb}`),t&&t.showUnresolved&&(this.isResolved(t)||n.push(`// unresolved particle: ${t.details}`)),n=[n.join(\" \")];for(const r of this.unnamedConnections)n.push(r.toString(e,t).replace(/^|(\\n)/g,\"$1  \"));for(const r of Object.values(this.connections))n.push(r.toString(e,t).replace(/^|(\\n)/g,\"$1  \"));for(const r of Object.values(this._consumedSlotConnections))n.push(r.toString(e,t).replace(/^|(\\n)/g,\"$1  \"));return n.join(\"\\n\")}}class Kt{constructor(e,t){d()(e),this._phrase=e;const n=this.phrase.toLowerCase().split(/[^a-z0-9]/g);this._unresolvedTokens=[],(t||n).forEach(e=>this._unresolvedTokens.push(e)),this._resolvedTokens=n.slice();for(const e of this.unresolvedTokens){const t=this._resolvedTokens.indexOf(e);t>=0&&this._resolvedTokens.splice(t,1)}d()(n.length===this.unresolvedTokens.length+this.resolvedTokens.length)}_append(e,t,n){this._phrase.length>0&&(this._phrase=this.phrase.concat(\" \")),this._phrase=this._phrase.concat(e),n.forEach(e=>this._resolvedTokens.push(e)),t.forEach(e=>this._unresolvedTokens.push(e))}get phrase(){return this._phrase}get unresolvedTokens(){return this._unresolvedTokens}get resolvedTokens(){return this._resolvedTokens}resolveToken(e){const t=this.unresolvedTokens.indexOf(e.toLowerCase());d()(t>=0,`Cannot resolved nonexistent token ${e}`),this._unresolvedTokens.splice(t,1),this._resolvedTokens.push(e.toLowerCase())}isValid(){return this._unresolvedTokens.length>0||this._resolvedTokens.length>0}isResolved(){return d()(Object.isFrozen(this)),this._resolvedTokens.length>0}_normalize(){this._unresolvedTokens.sort(),this._resolvedTokens.sort(),Object.freeze(this)}_copyInto(e){return e.search?e.search._append(this.phrase,this.unresolvedTokens,this.resolvedTokens):(e.search=new Kt(this.phrase,this.unresolvedTokens),d()(e.search.resolvedTokens.length===this.resolvedTokens.length,`${e.search.resolvedTokens} is not same as ${this.resolvedTokens}`)),d()(this.resolvedTokens.every(t=>e.search.resolvedTokens.indexOf(t)>=0)&&this.unresolvedTokens.every(t=>e.search.unresolvedTokens.indexOf(t)>=0)),e.search}toString(e){const t=[];t.push(`search \\`${this.phrase}\\``);const n=[];return n.push(\"  tokens\"),this.unresolvedTokens.length>0&&n.push(this.unresolvedTokens.map(e=>`\\`${e}\\``).join(\" \")),this.resolvedTokens.length>0&&n.push(`// ${this.resolvedTokens.map(e=>`\\`${e}\\``).join(\" \")}`),e&&e.showUnresolved&&this.unresolvedTokens.length>0&&n.push(\"// unresolved search tokens\"),t.push(n.join(\" \")),t.join(\"\\n\")}}class Zt{constructor(e,t){this._id=void 0,this._localName=void 0,this._tags=[],this._sourceConnection=void 0,this._formFactor=void 0,this._consumeConnections=[],d()(e),this._recipe=e,this._name=t}get recipe(){return this._recipe}get id(){return this._id}set id(e){this._id=e}get localName(){return this._localName}set localName(e){this._localName=e}get name(){return this._name}set name(e){this._name=e}get tags(){return this._tags}set tags(e){this._tags=e}get formFactor(){return this._formFactor}set formFactor(e){this._formFactor=e}get sourceConnection(){return this._sourceConnection}set sourceConnection(e){this._sourceConnection=e}get consumeConnections(){return this._consumeConnections}get spec(){return this.sourceConnection&&this.sourceConnection.getSlotSpec()?this.sourceConnection.particle.getSlotSpecByName(this.name):{isSet:!1,tags:[]}}get handles(){const e=[];if(this.sourceConnection&&this.sourceConnection.getSlotSpec())for(const t of this.sourceConnection.particle.getSlotSpecByName(this.name).handles){const n=this.sourceConnection.particle.connections[t];(n||n.handle)&&e.push(n.handle)}return e}_copyInto(e,t){let n=void 0;return t.has(this)?t.get(this):(!this.sourceConnection&&this.id&&(n=e.findSlot(this.id)),null==n&&((n=e.newSlot(this.name))._id=this.id,n._formFactor=this.formFactor,n._localName=this._localName,n._tags=[...this._tags],n._sourceConnection=t.get(this._sourceConnection),n.sourceConnection&&(n.sourceConnection._providedSlots[n.name]=n)),this._consumeConnections.forEach(e=>{t.get(e)&&null==t.get(e).targetSlot&&t.get(e).connectToSlot(n)}),n)}_startNormalize(){this.localName=null,this._tags.sort()}_finishNormalize(){this._consumeConnections.forEach(e=>d()(Object.isFrozen(e))),this._consumeConnections.sort(Bt),Object.freeze(this)}_compareTo(e){let t;return 0!==(t=$t(this.id,e.id))?t:0!==(t=$t(this.localName,e.localName))?t:0!==(t=$t(this.formFactor,e.formFactor))?t:0!==(t=jt(this._tags,e._tags,$t))?t:0}findHandleByID(e){return this.handles.find(t=>t.id===e)}removeConsumeConnection(e){const t=this._consumeConnections.indexOf(e);d()(t>-1),this._consumeConnections.splice(t,1),0===this._consumeConnections.length&&this.remove()}remove(){this._recipe.removeSlot(this)}isResolved(e){return d()(Object.isFrozen(this)),e&&e.showUnresolved&&(e.details=[],this._sourceConnection||e.details.push(\"missing source-connection\"),this.id||e.details.push(\"missing id\"),e.details=e.details.join(\"; \")),Boolean(this._sourceConnection||this.id)}_isValid(e){return!0}toString(e,t){const n=[];n.push(\"slot\"),this.id&&n.push(`'${this.id}'`),this.tags.length>0&&n.push(this.tags.map(e=>`#${e}`).join(\" \")),n.push(`as ${e&&e.get(this)||this.localName}`);const r=t&&t.showUnresolved&&!this.isResolved(t);return r&&n.push(`// unresolved slot: ${t.details}`),this.id||r?n.join(\" \"):\"\"}}class Jt{constructor(e){this._requires=[],this._particles=[],this._handles=[],this._slots=[],this._localName=void 0,this.annotation=void 0,this._connectionConstraints=[],this._obligations=[],this._verbs=[],this._search=null,this._patterns=[],this._name=e}newConnectionConstraint(e,t,n){const r=new Ut(e,t,n,\"constraint\");return this._connectionConstraints.push(r),r}newObligation(e,t,n){const r=new Ut(e,t,n,\"obligation\");return this._obligations.push(r),r}removeObligation(e){const t=this._obligations.indexOf(e);d()(t>-1),this._obligations.splice(t,1)}removeConstraint(e){const t=this._connectionConstraints.indexOf(e);d()(t>=0),this._connectionConstraints.splice(t,1)}clearConnectionConstraints(){this._connectionConstraints.length=0}newRequireSection(){const e=new Gt(this);return this._requires.push(e),e}newParticle(e){const t=new Vt(this,e);return this._particles.push(t),t}removeParticle(e){const t=this._particles.indexOf(e);d()(t>-1),this._particles.splice(t,1);for(const t of Object.values(e._consumedSlotConnections))t.remove()}newHandle(){const e=new Ht(this);return this._handles.push(e),e}removeHandle(e){d()(0===e.connections.length);const t=this._handles.indexOf(e);d()(t>-1),this._handles.splice(t,1)}newSlot(e){const t=new Zt(this,e);return this._slots.push(t),t}addSlot(e){-1===this.slots.indexOf(e)&&this.slots.push(e)}removeSlot(e){d()(0===e.consumeConnections.length);let t=this._slots.indexOf(e);d()(t>-1),this._slots.splice(t,1);for(const n of this.requires)-1!==(t=n.slots.indexOf(e))&&n.slots.splice(t,1)}isResolved(){return d()(Object.isFrozen(this),\"Recipe must be normalized to be resolved.\"),!(this._obligations.length>0)&&(0===this._connectionConstraints.length&&this.requires.every(e=>e.isEmpty())&&(null===this._search||this._search.isResolved())&&this._handles.every(e=>e.isResolved())&&this._particles.every(e=>e.isResolved())&&this.modality.isResolved()&&this.allRequiredSlotsPresent()&&this._slots.every(e=>e.isResolved())&&this.handleConnections.every(e=>e.isResolved())&&this.slotConnections.every(e=>e.isResolved()))}isCompatible(e){return this.particles.every(t=>!t.spec||t.spec.isCompatible(e))}get modality(){return this.particles.filter(e=>Boolean(e.spec&&e.spec.slotConnections.size>0)).map(e=>e.spec.modality).reduce((e,t)=>e.intersection(t),pe.all)}allRequiredSlotsPresent(){for(const e of this.particles){if(0===e.spec.slotConnections.size)continue;let t=!1;for(const[n,r]of e.spec.slotConnections){if(r.isRequired&&!e.consumedSlotConnections[n])return!1;if(e.consumedSlotConnections[n])for(const t of r.provideSlotConnections)if(t.isRequired&&!e.getProvidedSlotByName(n,t.name))return!1;e.consumedSlotConnections[n]&&(t=!0)}if(!t)return!1}return!0}_findDuplicate(e,t){const n=new Set,r=e.find(e=>{if(e.id){if(n.has(e.id))return e;n.add(e.id)}});return r&&t&&t.errors&&t.errors.set(r,`Has Duplicate ${r instanceof Ht?\"Handle\":\"Slot\"} '${r.id}'`),r}_isValid(e){return!this._findDuplicate(this._handles,e)&&!this._findDuplicate(this._slots,e)&&this._handles.every(t=>t._isValid(e))&&this._particles.every(t=>t._isValid(e))&&this._slots.every(t=>t._isValid(e))&&this.handleConnections.every(t=>t._isValid(e))&&this.slotConnections.every(t=>t._isValid(e))&&(!this.search||this.search.isValid())}get requires(){return this._requires}get name(){return this._name}set name(e){this._name=e}get localName(){return this._localName}set localName(e){this._localName=e}get particles(){return this._particles}set particles(e){this._particles=e}get handles(){return this._handles}set handles(e){this._handles=e}get slots(){return this._slots}set slots(e){this._slots=e}get connectionConstraints(){return this._connectionConstraints}get obligations(){return this._obligations}get verbs(){return this._verbs}set verbs(e){this._verbs=e}get search(){return this._search}set search(e){this._search=e}setSearchPhrase(e){d()(!this._search,\"Cannot override search phrase\"),e&&(this._search=new Kt(e))}get slotConnections(){const e=[];return this._particles.forEach(t=>{e.push(...Object.values(t.consumedSlotConnections))}),e}get handleConnections(){const e=[];return this._particles.forEach(t=>{e.push(...Object.values(t.connections)),e.push(...t._unnamedConnections)}),e}isEmpty(){return 0===this.particles.length&&0===this.handles.length&&0===this.slots.length&&0===this._connectionConstraints.length}findHandle(e){for(const t of this.handles)if(t.id===e)return t;return null}findSlot(e){for(const t of this.slots)if(t.id===e)return t;return null}get patterns(){return this._patterns}set patterns(e){this._patterns=e}set description(e){const t=e.find(e=>\"pattern\"===e.name);t&&t.patterns.forEach(e=>this._patterns.push(e)),e.forEach(e=>{if(\"pattern\"!==e.name){const t=this.handles.find(t=>t.localName===e.name);d()(t,`Cannot set description pattern for nonexistent handle ${e.name}.`),t.pattern=e.pattern}})}async digest(){return It(this.toString())}normalize(e){if(Object.isFrozen(this))return e&&e.errors&&e.errors.set(this,\"already normalized\"),!1;if(!this._isValid()){this._findDuplicate(this._handles,e),this._findDuplicate(this._slots,e);const t=t=>t.forEach(t=>!t._isValid(e));return t(this._handles),t(this._particles),t(this._slots),t(this.handleConnections),t(this.slotConnections),!1}for(const e of this._particles)e._startNormalize();for(const e of this._handles)e._startNormalize();for(const e of this._slots)e._startNormalize();const t=this.handleConnections;for(const e of t)e._normalize();t.sort(Bt);const n=this.slotConnections;for(const e of n)e._normalize();n.sort(Bt),this.search&&this.search._normalize();for(const e of this.requires)e.normalize();for(const e of this._particles)e._finishNormalize();for(const e of this._handles)e._finishNormalize();for(const e of this._slots)e._finishNormalize();const r=new Set,i=new Set,s=new Set,o=[],a=[],l=[];let c=t.filter(e=>!(e.type&&e.type instanceof Ke));c=c.concat(t.filter(e=>!!e.type&&!!(e.type instanceof Ke)));for(const e of c)i.has(e.particle)||(o.push(e.particle),i.add(e.particle)),e.handle&&!r.has(e.handle)&&(a.push(e.handle),r.add(e.handle));for(const e of n)e.targetSlot&&!s.has(e.targetSlot)&&(l.push(e.targetSlot),s.add(e.targetSlot)),Object.values(e.providedSlots).forEach(e=>{s.has(e)||(l.push(e),s.add(e))});const h=this._handles.filter(e=>!r.has(e));h.sort(Bt),a.push(...h);const u=this._particles.filter(e=>!i.has(e));u.sort(Bt),o.push(...u);const d=this._slots.filter(e=>!s.has(e));return d.sort(Bt),l.push(...d),this._particles=o,this._handles=a,this._slots=l,this._connectionConstraints.sort(Bt),this._verbs.sort(),this._patterns.sort(),Object.freeze(this._particles),Object.freeze(this._handles),Object.freeze(this._slots),Object.freeze(this._connectionConstraints),Object.freeze(this),!0}clone(e){const t=new Jt(this.name);return null==e&&(e=new Map),this._copyInto(t,e),t._cloneMap=e,t}mergeInto(e){const t=new Map,n=e._handles.length,r=e._particles.length,i=e._slots.length;return this._copyInto(e,t),{handles:e._handles.slice(n),particles:e._particles.slice(r),slots:e._slots.slice(i),cloneMap:t}}_copyInto(e,t){const n=new Map;function r(r){const i=r._copyInto(e,t,n);t.set(r,i)}e._name=this.name,e._verbs=e._verbs.concat(...this._verbs),this._handles.forEach(r),this._particles.forEach(r),this._slots.forEach(r),this._connectionConstraints.forEach(r),this._obligations.forEach(r),e.verbs=e.verbs.slice(),this.search&&this.search._copyInto(e);for(const n of this.requires){const r=e.newRequireSection();n._copyInto(r,t),r._cloneMap=t}e.patterns=e.patterns.concat(this.patterns)}updateToClone(e){const t={};return Object.keys(e).forEach(n=>t[n]=this._cloneMap.get(e[n])),t}_makeLocalNameMap(){const e=new Set;for(const t of this.particles)e.add(t.localName);for(const t of this.handles)e.add(t.localName);for(const t of this.slots)e.add(t.localName);const t=new Map;let n=0;for(const r of this.particles){let i=r.localName;if(!i)do{i=`particle${n++}`}while(e.has(i));t.set(r,i)}n=0;for(const r of this.handles){let i=r.localName;if(!i)do{i=`handle${n++}`}while(e.has(i));t.set(r,i)}n=0;for(const r of this.slots){let i=r.localName;if(!i)do{i=`slot${n++}`}while(e.has(i));t.set(r,i)}return t}toString(e){const t=this._makeLocalNameMap(),n=[],r=this.verbs.length>0?` ${this.verbs.map(e=>`&${e}`).join(\" \")}`:\"\";n.push(`recipe${this.name?` ${this.name}`:\"\"}${r}`),e&&e.showUnresolved&&this.search&&n.push(this.search.toString(e).replace(/^|(\\n)/g,\"$1  \"));for(const t of this._connectionConstraints){let r=t.toString().replace(/^|(\\n)/g,\"$1  \");e&&e.showUnresolved&&(r=r.concat(\" // unresolved connection-constraint\")),n.push(r)}n.push(...this.handles.map(n=>n.toString(t,e)).filter(e=>e).map(e=>e.replace(/^|(\\n)/g,\"$1  \")));for(const r of this.slots){const i=r.toString(t,e);i&&n.push(i.replace(/^|(\\n)/g,\"$1  \"))}for(const r of this.requires)r.isEmpty()||n.push(r.toString(t,e).replace(/^|(\\n)/g,\"$1  \"));for(const r of this.particles)n.push(r.toString(t,e).replace(/^|(\\n)/g,\"$1  \"));if(this.patterns.length>0||this.handles.find(e=>void 0!==e.pattern)){n.push(`  description \\`${this.patterns[0]}\\``);for(let e=1;e<this.patterns.length;++e)n.push(`    pattern \\`${this.patterns[e]}\\``);this.handles.forEach(e=>{e.pattern&&n.push(`    ${e.localName} \\`${e.pattern}\\``)})}if(this._obligations.length>0){n.push(\"  obligations\");for(const r of this._obligations){const i=r.toString(t,e).replace(/^|(\\n)/g,\"$1    \");n.push(i)}}return n.join(\"\\n\")}getFreeHandles(){return this.handles.filter(e=>0===e.connections.length)}get allSpecifiedConnections(){return[].concat(...this.particles.filter(e=>e.spec&&e.spec.connections).map(e=>e.spec.connections.map(t=>({particle:e,connSpec:t}))))}getFreeConnections(e){return this.allSpecifiedConnections.filter(({particle:t,connSpec:n})=>!n.isOptional&&\"descriptions\"!==n.name&&\"host\"!==n.direction&&!t.connections[n.name]&&(!e||Xe.compareTypes({type:e},{type:n.type})))}findHandleByID(e){return this.handles.find(t=>t.id===e)}getUnnamedUntypedConnections(){return this.handleConnections.find(e=>!e.type||!e.name||e.isOptional)}getParticlesByImplFile(e){return this.particles.filter(t=>t.spec&&e.has(t.spec.implFile))}findSlotByID(e){let t=this.slots.find(t=>t.id===e);if(null==t)if(this instanceof Gt)t=this.parent.slots.find(t=>t.id===e);else for(const n of this.requires)if(void 0!==(t=n.slots.find(t=>t.id===e)))break;return t}}class Gt extends Jt{constructor(e,t){super(t),this.parent=e}toString(e,t){null==e&&(e=this._makeLocalNameMap());const n=[];n.push(\"require\"),t&&t.showUnresolved&&this.search&&n.push(this.search.toString(t).replace(/^|(\\n)/g,\"$1  \"));for(const e of this.connectionConstraints){let r=e.toString().replace(/^|(\\n)/g,\"$1  \");t&&t.showUnresolved&&(r=r.concat(\" // unresolved connection-constraint\")),n.push(r)}n.push(...this.handles.map(n=>n.toString(e,t)).filter(e=>e).map(e=>e.replace(/^|(\\n)/g,\"$1  \")));for(const r of this.slots){const i=r.toString(e,t);i&&n.push(i.replace(/^|(\\n)/g,\"$1  \"))}for(const r of this.particles)n.push(r.toString(e,t).replace(/^|(\\n)/g,\"$1  \"));if(this.patterns.length>0||this.handles.find(e=>void 0!==e.pattern)){n.push(`  description \\`${this.patterns[0]}\\``);for(let e=1;e<this.patterns.length;++e)n.push(`    pattern \\`${this.patterns[e]}\\``);this.handles.forEach(e=>{e.pattern&&n.push(`    ${e.localName} \\`${e.pattern}\\``)})}if(this.obligations.length>0){n.push(\"  obligations\");for(const r of this.obligations){const i=r.toString(e,t).replace(/^|(\\n)/g,\"$1    \");n.push(i)}}return n.join(\"\\n\")}}class Yt{constructor(e,t,n,r){this.recipe=e,this.particles=t,this.handles=n,this.reverse=new Map;for(const e of Object.keys(t))this.reverse.set(t[e],e);for(const e of n.keys())this.reverse.set(n.get(e),e);for(const e of Object.keys(r))this.reverse.set(r[e],e)}}class Xt{static makeShape(e,t,n,r){r=r||new Jt;const i={},s=new Map,o={};return e.forEach(e=>i[e]=r.newParticle(e)),t.forEach(e=>s.set(e,r.newHandle())),Object.keys(n).forEach(e=>{Object.keys(n[e]).forEach(t=>{const r=n[e][t];let a=\"=\";r.direction&&(a={\"->\":\"out\",\"<-\":\"in\",\"=\":\"=\"}[r.direction]);const l=r.tags||[];r.localName&&(s.get(r.handle).localName=r.localName);const c=i[e].addConnectionName(t);c.direction=a,s.get(r.handle).tags=l,c.connectToHandle(s.get(r.handle)),o[e+\":\"+t]=i[e].connections[t]})}),new Yt(r,i,s,o)}static recipeToShape(e){const t={};let n=0;e.particles.forEach(e=>t[e.name]=e);const r=new Map;e.handles.forEach(e=>r.set(\"h\"+n++,e));const i={};return e.handleConnections.forEach(e=>i[e.particle.name+\":\"+e.name]=e),new Yt(e,t,r,i)}static find(e,t){function n(e,t,n,i){const{forward:s,reverse:o,score:a}=n;let l=!1;for(const n of e.particles)if(n.spec)for(const e of n.spec.handleConnections){if(o.has(e))continue;if(n.name!==t.particle.name)continue;if(t.name&&t.name!==e.name)continue;const r={in:[\"in\",\"inout\"],out:[\"out\",\"inout\"],\"=\":[\"in\",\"out\",\"inout\"],inout:[\"inout\"],host:[\"host\"],\"`consume\":[\"consume\"],\"`provide\":[\"provide\"]};if(e.direction&&(d()(Object.keys(r).includes(t.direction),`${t.direction} not in ${Object.keys(r)}`),!r[t.direction].includes(e.direction)))continue;const c=n.connections[e.name];if(t.handle&&c&&c.handle&&t.handle.localName&&t.handle.localName!==c.handle.localName)continue;if(o.has(n)){if(o.get(n)!==t.particle)continue}else if(s.has(t.particle))continue;if(t.handle&&c&&c.handle){if(o.has(c.handle)){if(o.get(c.handle)!==t.handle)continue}else if(s.has(t.handle)&&null!==s.get(t.handle))continue;if(\"create\"!==t.handle.fate||\"create\"!==c.handle.fate&&\"create\"!==c.handle.originalFate){if(Boolean(t.handle.immediateValue)!==Boolean(c.handle.immediateValue))continue;if(c.handle.immediateValue){if(!c.handle.immediateValue.equals(t.handle.immediateValue))continue}else if(t.handle.id!==c.handle.id&&t.handle.id!==c.handle.originalId)continue}}const h={forward:new Map(s),reverse:new Map(o),score:a};d()(!h.reverse.has(n)||h.reverse.get(n)===t.particle),d()(!h.forward.has(t.particle)||h.forward.get(t.particle)===n),h.forward.set(t.particle,n),h.reverse.set(n,t.particle),t.handle&&(c&&c.handle?(h.forward.set(t.handle,c.handle),h.reverse.set(c.handle,t.handle)):h.forward.has(t.handle)||(h.forward.set(t.handle,null),h.score-=2)),h.forward.set(t,e),h.reverse.set(e,t),i.push(h),l=!0}if(!1===l){if(n.forward.get(t.particle))return;const s=[];r(e,t.particle,n,s),s.forEach(e=>{t.handle&&!e.forward.has(t.handle)&&(e.forward.set(t.handle,null),e.score-=2),e.forward.set(t,null),e.score-=1,i.push(e)})}}function r(e,t,n,r){const{forward:i,reverse:s,score:o}=n;let a=!1;for(const n of e.particles){if(s.has(n))continue;if(n.name!==t.name)continue;let e=!0;for(const r of Object.keys(n.connections)){const i=n.connections[r];if(!i.handle)continue;const s=t.connections[r];if(s&&s.handle&&s.handle.localName&&s.handle.localName!==i.handle.localName){e=!1;break}}if(!e)continue;const l={forward:new Map(i),reverse:new Map(s),score:o};d()(!l.forward.has(t)||l.forward.get(t)===n),d()(!l.reverse.has(n)||l.reverse.get(n)===t),l.forward.set(t,n),l.reverse.set(n,t),r.push(l),a=!0}if(!1===a){const e={forward:new Map,reverse:new Map,score:0};i.forEach((t,n)=>{d()(!e.forward.has(n)||e.forward.get(n)===t),e.forward.set(n,t)}),s.forEach((t,n)=>{d()(!e.reverse.has(n)||e.reverse.get(n)===t),e.reverse.set(n,t)}),e.forward.has(t)||(e.forward.set(t,null),e.score=n.score-1),r.push(e)}}function i(e,n,r){if(1===n.length){const t=[],{forward:i,reverse:s,score:o}=e;for(const e of r){let r=!0;for(const t of e.tags)if(!n[0].tags.includes(t)){r=!1;break}if(!r)continue;const a={forward:new Map(i),reverse:new Map(s),score:o+1};a.forward.set(e,n[0]),a.reverse.set(n[0],e),t.push(a)}return t}const s=n.pop(),o=i(e,n,r);let a=[];for(const e of o){const n=[...t.handles.values()].filter(t=>null===e.forward.get(t));n.length>0?a=a.concat(i(e,[s],n)):a.concat(e)}return a}let s=[{forward:new Map,reverse:new Map,score:0}];for(const r of t.recipe.handleConnections){const t=[];for(const i of s)n(e,r,i,t);s=t}for(const n of t.recipe.particles){if(Object.keys(n.connections).length>0)continue;if(n.unnamedConnections.length>0)continue;const t=[];for(const i of s)r(e,n,i,t);s=t}const o=e.handles.filter(e=>0===e.connections.length);if(o.length>0){let e=[];for(const n of s){const r=[...t.handles.values()].filter(e=>null===n.forward.get(e));e=r.length>0?e.concat(i(n,o,r)):e.concat(n)}s=e}return s.map(({forward:e,score:n})=>{const r={};return e.forEach((e,n)=>r[t.reverse.get(n)]=e),{match:r,score:n}})}static constructImmediateValueHandle(e,t,n){if(d()(e.type instanceof Ke),!(e.type instanceof Ke&&e.type.interfaceInfo.restrictType(t)))return null;const r=e.type.clone(new Map);r.maybeEnsureResolved();const i=e.recipe.newHandle();return i.id=n.toString(),i.mappedType=r,i.fate=\"copy\",i.immediateValue=t,i}static directionCounts(e){const t={in:0,out:0,inout:0,unknown:0};for(const n of e.connections){let e=n.direction;void 0===t[e]&&(e=\"unknown\"),t[e]++}return t.in+=t.inout,t.out+=t.inout,t}static matchesRecipe(e,t){const n=Xt.recipeToShape(t);return Xt.find(e,n).some(e=>0===e.score)}}\n// @license\nclass Qt{constructor(e){if(this.items=new Map,e)for(let{id:t,value:n,keys:r}of e)r||(r=[]),this.items.set(t,{value:n,keys:new Set(r)})}add(e,t,n){d()(n.length>0&&\"object\"==typeof n,\"add requires a list of keys\");let r=this.items.get(e),i=!1;if(r){let e=!1;for(const t of n)r.keys.has(t)||(e=!0),r.keys.add(t);this._equals(r.value,t)||(d()(e,\"cannot add without new keys. incoming=\"+n.join(\",\")+\" existing=\"+[...r.keys].join(\",\")),r.value=t,i=!0)}else r={value:t,keys:new Set(n)},this.items.set(e,r),i=!0;return i}_equals(e,t){if(Boolean(e)!==Boolean(t))return!1;if(!e)return!0;const n=typeof e;if(n!==typeof t)return!1;if(\"object\"===n){const n=Object.keys(e);return n.length===Object.keys(t).length&&n.every(n=>this._equals(e[n],t[n]))}return JSON.stringify(e)===JSON.stringify(t)}remove(e,t){const n=this.items.get(e);if(!n)return!1;for(const e of t)n.keys.delete(e);const r=0===n.keys.size;return r&&this.items.delete(e),r}toLiteral(){const e=[];for(const[t,{value:n,keys:r}]of this.items.entries())e.push({id:t,value:n,keys:[...r]});return e}toList(){return[...this.items.values()].map(e=>e.value)}has(e){return this.items.has(e)}getKeys(e){const t=this.items.get(e);return t?[...t.keys]:[]}getValue(e){const t=this.items.get(e);return t?t.value:null}get size(){return this.items.size}}class en{}!function(e){e.change=\"Change\"}(Et||(Et={}));class tn{constructor(e){this.arcId=e,this._debug=!1,d()(void 0!==e,\"Arcs with storage must have ids\")}set debug(e){this._debug=e}async shutdown(){}}class nn{constructor(e){Object.assign(this,e)}}class rn{constructor(e,t,n,r){this.referenceMode=!1,d()(n,\"id must be provided when constructing StorageProviders\"),d()(!e.hasUnresolvedVariable,\"Storage types must be concrete\"),this._type=e,this.listeners=new Map,this.name=t,this.version=0,this.id=n,this.source=null,this._storageKey=r,this.nextLocalID=0}enableReferenceMode(){this.referenceMode=!0}get storageKey(){return this._storageKey}get type(){return this._type}reportExceptionInHost(e){throw e}on(e,t,n){d()(void 0!==n,\"must provide a target to register a storage event handler\");const r=Et[e],i=this.listeners.get(r)||new Map;i.set(t,{target:n}),this.listeners.set(r,i)}off(e,t){const n=Et[e],r=this.listeners.get(n);r&&r.delete(t)}async _fire(e,t){const n=Et[e],r=this.listeners.get(n);if(!r||0===r.size)return;const i=[];for(const[e]of r.entries())i.push(e);await 0;for(const e of i)e(t)}_compareTo(e){let t;return 0!==(t=$t(this.name,e.name))?t:0!==(t=Pt(this.version,e.version))?t:0!==(t=$t(this.source,e.source))?t:0!==(t=$t(this.id,e.id))?t:0}toString(e){const t=[],n=[];return n.push(\"store\"),this.name&&n.push(`${this.name}`),n.push(`of ${this.type.toString()}`),this.id&&n.push(`'${this.id}'`),e&&e.length&&n.push(`${e.join(\" \")}`),this.source&&n.push(`in '${this.source}'`),t.push(n.join(\" \")),this.description&&t.push(`  description \\`${this.description}\\``),t.join(\"\\n\")}get apiChannelMappingId(){return this.id}dispose(){}async modelForSynchronization(){return this.toLiteral()}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class sn{constructor(e=[],t={}){this.particleDescriptions=e,this.storeDescById=t,this.seenHandles=new Set,this.seenParticles=new Set,this.excludeValues=!1}getDescription(e){if(e.patterns.length>0){let t=[];for(const n of e.patterns)t.push(this.patternToSuggestion(n,{_recipe:e}));if((t=t.filter(e=>Boolean(e))).length>0)return this._capitalizeAndPunctuate(this._joinDescriptions(t))}const t=new Set(e.particles);let n=this.particleDescriptions.filter(e=>t.has(e._particle)&&this._isSelectedDescription(e));if(n.find(e=>e._particle.spec.slotConnections.size>0)&&(n=n.filter(e=>e._particle.spec.slotConnections.size>0)),(n=n.sort(sn.sort)).length>0)return this._combineSelectedDescriptions(n)}_isSelectedDescription(e){return!!e.pattern}getHandleDescription(e){const t=this._selectHandleConnection(e)||e.connections[0];return this._formatDescription(t)}_combineSelectedDescriptions(e,t={}){const n=[];e.map(e=>{this.seenParticles.has(e._particle)||n.push(this.patternToSuggestion(e.pattern,e))});const r=this._joinDescriptions(n);if(r)return t.skipFormatting?r:this._capitalizeAndPunctuate(r)}_joinDescriptions(e){const t=e.filter(e=>e),n=t.length;if(n>0){const e=[\"\",\"\",\" and \",\", and \"][Math.min(3,n)],r=t.pop();return`${t.join(\", \")}${e}${r}`}}_joinTokens(e){return e.join(\"\")}_capitalizeAndPunctuate(e){d()(e);const t=e.length-1;return`${e[0].toUpperCase()}${e.slice(1,t)}${e[t]}${e[t].match(/[a-z0-9()' >\\]]/i)?\".\":\"\"}`}patternToSuggestion(e,t){const n=this._initTokens(e,t).map(e=>this.tokenToString(e));if(0===n.filter(e=>null==e).length)return this._joinTokens(n)}_initTokens(e,t){e=e.replace(/</g,\"&lt;\");let n=[];for(;e.length>0;){const r=e.match(/\\${[a-zA-Z0-9.]+}(?:\\.[_a-zA-Z]+)?/g);let i,s;r?(i=r[0],s=e.indexOf(i)):(i=\"\",s=e.length),d()(s>=0);const o=e.substring(0,s);o.length>0&&n.push({text:o}),i.length>0&&(n=n.concat(this._initSubTokens(i,t))),e=e.substring(s+i.length)}return n}_initSubTokens(e,t){const n=e.match(/\\${([a-zA-Z0-9.]+)}(?:\\.([_a-zA-Z]+))?/),r=n[1].split(\".\"),i=3===n.length?n[2]:void 0;if(!t._particle){const e=r.shift();if(e[0]!==e[0].toUpperCase())return console.warn(`Invalid particle name '${e}' - must start with a capital letter.`),[];const n=this.particleDescriptions.filter(n=>n._particle.name===e&&t._recipe.particles.find(e=>e===n._particle));if(0===n.length)return console.warn(`Cannot find particles with name ${e}.`),[];t=n[n.length-1]}const s=t._particle;if(0===r.length)return[{particleName:s.spec.name,particleDescription:t}];const o=s.connections[r[0]];if(o)return d()(o.handle&&o.handle.id,\"Missing id???\"),[{fullName:n[0],handleName:o.name,storeId:o.handle.id,properties:r.splice(1),extra:i,_handleConn:o,value:t._connections[o.name].value}];if(2!==r.length)return 1===r.length?console.warn(`Unknown handle connection name '${r[0]}'`):console.warn(`Slot connections tokens must have exactly 2 names, found ${r.length} in '${r.join(\".\")}'`),[];const a=s.consumedSlotConnections[r[0]].providedSlots[r[1]];return d()(a,`Could not find handle ${r.join(\".\")}`),[{fullName:n[0],consumeSlotName:r[0],provideSlotName:r[1],extra:i,_providedSlotConn:a}]}tokenToString(e){if(e.text)return e.text;if(e.particleName)return this._particleTokenToString(e);if(e.handleName)return this._handleTokenToString(e);if(e.consumeSlotName&&e.provideSlotName)return this._slotTokenToString(e);throw new Error(\"no handle or slot name\")}_particleTokenToString(e){return this._combineSelectedDescriptions([e.particleDescription],{skipFormatting:!0})}_handleTokenToString(e){switch(e.extra){case\"_type_\":return e._handleConn.type.toPrettyString().toLowerCase();case\"_values_\":return this._formatStoreValue(e.handleName,e.value);case\"_name_\":return this._formatDescription(e._handleConn);default:{if(d()(!e.extra,`Unrecognized extra ${e.extra}`),e._handleConn.type instanceof Ke){return d()(e.value.interfaceValue,`Missing interface type value for '${e._handleConn.type}'.`),it.fromLiteral(e.value.interfaceValue).pattern}if(e.properties&&e.properties.length>0)return this._propertyTokenToString(e.handleName,e.value,e.properties);let t=this._formatDescriptionPattern(e._handleConn)||this._formatStoreDescription(e._handleConn);const n=this._formatStoreValue(e.handleName,e.value);if(!t){const t=e._handleConn.type;if(n&&!this.excludeValues&&!(t instanceof qe)&&!(t instanceof We))return n}return t=t||this._formatHandleType(e._handleConn),!n||this.excludeValues||this.seenHandles.has(e.storeId)?t:(this.seenHandles.add(e.storeId),this._combineDescriptionAndValue(e,t,n))}}}_combineDescriptionAndValue(e,t,n){return t===n?t:`${t} (${n})`}_slotTokenToString(e){switch(e.extra){case\"_empty_\":return 0===e._providedSlotConn.consumeConnections.length;default:d()(!e.extra,`Unrecognized slot extra ${e.extra}`)}const t=e._providedSlotConn.consumeConnections.map(e=>{const t=e.particle,n=this.particleDescriptions.find(e=>e._particle===t);return this.seenParticles.add(t),this.patternToSuggestion(t.spec.pattern,n)});return this._joinDescriptions(t)}_propertyTokenToString(e,t,n){if(!t)return\"\";d()(t.entityValue,`Cannot return property ${n.join(\",\")} for non EntityType.`);t.entityValue;if(t.entityValue){let r=t.entityValue;for(const e of n)r&&(r=r[e]);if(r)return this._formatEntityProperty(e,n,r)}}_formatEntityProperty(e,t,n){return n}_formatStoreValue(e,t){if(t){if(t.collectionValues)return this._formatCollection(e,t.collectionValues);if(t.bigCollectionValues)return this._formatBigCollection(e,t.bigCollectionValues);if(t.entityValue)return this._formatSingleton(e,t);throw new Error(`invalid store type for handle ${e}`)}}_formatCollection(e,t){return t[0].rawData.name?t.length>2?`${t[0].rawData.name} plus ${t.length-1} other items`:t.map(e=>e.rawData.name).join(\", \"):`${t.length} items`}_formatBigCollection(e,t){return`collection of items like ${t.rawData.name}`}_formatSingleton(e,t){const n=t.entityValue;if(t.valueDescription){let e,r=t.valueDescription;for(;e=r.match(/\\${([a-zA-Z0-9.]+)}/);)r=r.replace(e[0],n[e[1]]);return r}if(n.name)return n.name}_formatDescription(e){return this._formatDescriptionPattern(e)||this._formatStoreDescription(e)||this._formatHandleType(e)}_formatDescriptionPattern(e){let t=e;if(!t.spec.isOutput){const n=this._selectHandleConnection(e.handle);n&&(t=n)}const n=this.particleDescriptions.find(e=>e._particle===t.particle),r=n?n._connections[t.name]:null;if(r&&r.pattern)return this.patternToSuggestion(r.pattern,n)}_formatStoreDescription(e){if(e.handle){d()(e.handle.id,`no id for ${e.name}?`);const t=this.storeDescById[e.handle.id],n=this._formatHandleType(e);if(t&&t!==n)return t}}_formatHandleType(e){return(e.handle&&e.handle.type.isResolved()?e.handle.type:e.type).toPrettyString().toLowerCase()}_selectHandleConnection(e){const t=e.connections.filter(e=>{const t=e.spec,n=this.particleDescriptions.find(t=>t._particle===e.particle);return!!t.pattern||!!n._connections[e.name].pattern});if(t.sort((e,t)=>{const n=e.spec.isOutput;if(n!==t.spec.isOutput)return n?-1:1;const r=this.particleDescriptions.find(t=>t._particle===e.particle);return this.particleDescriptions.find(e=>e._particle===t.particle)._rank-r._rank}),t.length>0)return t[0]}static sort(e,t){const n=e=>\"root\"===e.name||e.tags.includes(\"root\"),r=Boolean([...e._particle.spec.slotConnections.values()].find(e=>n(e)));if(r!==Boolean([...t._particle.spec.slotConnections.values()].find(e=>n(e))))return r?-1:1;if(e._rank!==t._rank)return t._rank-e._rank;let i=0,s=0;return e._particle.spec.slotConnections.forEach(e=>{e.isSet||++i}),t._particle.spec.slotConnections.forEach(e=>{e.isSet||++s}),s-i}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class on{constructor(e,t=[]){this.particleDescriptions=t,this.storeDescById={};for(const{id:t}of e.activeRecipe.handles){const n=e.findStoreById(t);n&&n instanceof rn&&(this.storeDescById[t]=e.getStoreDescription(n))}this.arcRecipeName=e.activeRecipe.name,this.arcRecipes=e.recipeDeltas}static async create(e,t){const n=await on.initDescriptionHandles(e,t);return new on(e,n)}getArcDescription(e=sn){const t=[].concat(...this.arcRecipes.map(e=>e.patterns)),n=[].concat(...this.arcRecipes.map(e=>e.particles)),r=new e(this.particleDescriptions,this.storeDescById).getDescription({patterns:t,particles:n});if(r)return r}getRecipeSuggestion(e=sn){const t=new e(this.particleDescriptions,this.storeDescById),n=t.getDescription(this.arcRecipes[this.arcRecipes.length-1]);return n||t._capitalizeAndPunctuate(this.arcRecipeName||on.defaultDescription)}getHandleDescription(e){d()(e.connections.length>0,\"handle has no connections?\");const t=new sn(this.particleDescriptions,this.storeDescById);return t.excludeValues=!0,t.getHandleDescription(e)}static async initDescriptionHandles(e,t){const n=[].concat(...e.allDescendingArcs.map(e=>e.activeRecipe.particles));return await Promise.all(n.map(n=>on._createParticleDescription(n,e,t)))}static async _createParticleDescription(e,t,n){let r={_particle:e,_connections:{}};n&&(r._rank=n.calcParticleRelevance(e));const i=await on._getPatternByNameFromDescriptionHandle(e,t);(r={...r,...i}).pattern=r.pattern||e.spec.pattern;for(const n of Object.values(e.connections)){const s=e.spec.handleConnectionMap.get(n.name),o=i[n.name]||s.pattern,a=t.findStoreById(n.handle.id);r._connections[n.name]={pattern:o,_handleConn:n,value:await on._prepareStoreValue(a)}}return r}static async _getPatternByNameFromDescriptionHandle(e,t){const n=e.connections.descriptions;if(n&&n.handle&&n.handle.id){const e=t.findStoreById(n.handle.id);if(e){const t={};for(const n of await e.toList())t[n.rawData.key]=n.rawData.value;return t}}return{}}static async _prepareStoreValue(e){if(e)if(e.type instanceof qe){const t=e,n=await t.toList();if(n&&n.length>0)return{collectionValues:n}}else if(e.type instanceof We){const t=e,n=await t.stream(1),{value:r,done:i}=await t.cursorNext(n);if(t.cursorClose(n),!i&&r[0].rawData.name)return{bigCollectionValues:r[0]}}else if(e.type instanceof Ue){const t=e,n=await t.get();if(n&&n.rawData)return{entityValue:n.rawData,valueDescription:e.type.entitySchema.description.value}}else if(e.type instanceof Ke){const t=e,n=await t.get();if(n)return{interfaceValue:n}}}}on.defaultDescription=\"i'm feeling lucky\";\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass an{constructor(){this.debouncedMessages=[],this.messageListeners=new Map,this.timer=null}send(e){this.ensureNoCycle(e),this.debouncedMessages.push(e),this.debouncedMessages.length>10?this._empty():this.timer||(this.timer=setTimeout(()=>this._empty(),100))}listen(e,t,n){d()(t),d()(e);const r=`${\"string\"==typeof e?e:e.id.toString()}/${t}`;let i=this.messageListeners.get(r);i||this.messageListeners.set(r,i=[]),i.push(n)}forArc(e){return new ln(e,this)}_handleMessage(e){const t=this.messageListeners.get(`${e.arcId}/${e.messageType}`);if(t)for(const n of t)n(e);else console.warn(`No one is listening to ${e.messageType} message`)}_empty(){this._flush(this.debouncedMessages),this.debouncedMessages=[],clearTimeout(this.timer),this.timer=null}_flush(e){throw new Error(\"Not implemented in an abstract class\")}ensureNoCycle(e,t=[]){e&&\"object\"==typeof e&&(d()(-1===t.indexOf(e),\"Message cannot contain a cycle\"),t.push(e),(Array.isArray(e)?e:Object.values(e)).forEach(e=>this.ensureNoCycle(e,t)),t.pop())}}class ln{constructor(e,t){this.channel=t,this.arcId=e.id.toString()}send(e){this.channel.send({meta:{arcId:this.arcId},...e})}listen(e,t){this.channel.listen(this.arcId,e,t)}static instantiateListener(e,t,n){return new e(t,n)}}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst cn=\"object\"==typeof window?window:global;cn._arcDebugPromise||(cn._arcDebugPromise=new Promise(e=>{cn._arcDebugPromiseResolve=e}));class hn{static get onceConnected(){return cn._arcDebugPromise}static markConnected(){cn._arcDebugPromiseResolve()}}var un=n(88),dn=n.n(un);\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass fn extends an{constructor(){super(),this.server=new dn.a.Server({port:8787}),this.server.on(\"connection\",e=>{this.socket=e,this.socket.on(\"message\",e=>{\"init\"===e?hn.markConnected():this._handleMessage(JSON.parse(e))})})}_flush(e){this.socket&&this.socket.send(JSON.stringify(e))}}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nlet pn=null,mn=!1,gn=null,yn=new Promise(e=>gn=e);hn.onceConnected.then(()=>{_n.ensure(),gn(pn),mn=!0});class _n{static get isConnected(){return mn}static get onceConnected(){return yn}static get(){return pn}static ensure(){pn||(pn=new fn)}}const vn=[];let bn,wn;\"object\"==typeof document?(bn=42,wn=(()=>1e3*performance.now())):(bn=process.pid,wn=(()=>{const e=process.hrtime();return 1e6*e[0]+e[1]/1e3}));let Sn=0;function kn(e){return e?\"function\"==typeof e?kn(e()):e.toTraceInfo?kn(e.toTraceInfo()):e:{}}const Cn=[];function xn(e){e.pid=bn,e.tid=0,e.args||delete e.args,e.ov||delete e.ov,e.cat||(e.cat=\"\"),0===Cn.length&&vn.push(e),Promise.resolve().then(()=>{for(const{callback:t,predicate:n}of Cn)n&&!n(e)||t(e)})}const Tn={exports:{}},En=Tn.exports;function An(){const e={wait:async e=>e,start(){return this},end(){return this},step(){return this},addArgs(){},endWith:async e=>e};function t(e){let t=(e=kn(e)).args;const n=wn();return{addArgs(e){t={...t||{},...e}},end(r={},i){(r=kn(r)).args&&(t={...t||{},...r.args}),r={...e,...r},this.endTs=wn(),xn({ph:\"X\",ts:n,dur:this.endTs-n,cat:r.cat,name:r.name,ov:r.overview,args:t,flowId:i&&i.id(),seq:r.sequence})},beginTs:n}}Tn.exports.wrap=((e,t)=>t),Tn.exports.start=(t=>e),Tn.exports.flow=(t=>e),Tn.exports.enabled&&(Tn.exports.wrap=((e,t)=>(...n)=>{const r=Tn.exports.start(e);try{return t(...n)}finally{r.end()}}),Tn.exports.start=(e=>{let n,r=t(e);const i={cat:e.cat,name:e.name+\" (async)\",overview:e.overview,sequence:e.sequence};return{async wait(e,s){const o=!!n;o||(n=Tn.exports.flow(i)),r.end(s,n),o?n.step({ts:r.beginTs,...i}):n.start({ts:r.endTs}),r=null;try{return await e}finally{r=t(i)}},addArgs(e){r.addArgs(e)},end(e){r.end(e,n),n&&n.end({ts:r.beginTs})},async endWith(e,t){if(Promise.resolve(e)!==e)return this.end(t),e;e=this.wait(e,null);try{return await e}finally{this.end(t)}}}}),Tn.exports.flow=(e=>{e=kn(e);const t=Sn++;let n=!1;return{start(r){const i=r&&r.ts||wn();return n=!0,xn({ph:\"s\",ts:i,cat:e.cat,name:e.name,ov:e.overview,args:e.args,id:t,seq:e.sequence}),this},end(r){if(!n)return this;const i=r&&r.ts||wn();return r=kn(r),xn({ph:\"f\",bp:\"e\",ts:i,cat:e.cat,name:e.name,ov:e.overview,args:r&&r.args,id:t,seq:e.sequence}),this},step(r){if(!n)return this;const i=r&&r.ts||wn();return r=kn(r),xn({ph:\"t\",ts:i,cat:e.cat,name:e.name,ov:e.overview,args:r&&r.args,id:t,seq:e.sequence}),this},id:()=>t}}),Tn.exports.save=(()=>({traceEvents:vn})),Tn.exports.download=(()=>{const e=document.createElement(\"a\");e.download=\"trace.json\",e.href=\"data:text/plain;base64,\"+btoa(JSON.stringify(Tn.exports.save())),e.click()}),Tn.exports.now=wn,Tn.exports.stream=((e,t)=>{vn.length=0,Cn.push({callback:e,predicate:t})}),Tn.exports.__clearForTests=(()=>{vn.length=0,Cn.length=0}))}Tn.exports.enabled=!1,Tn.exports.enable=(()=>{Tn.exports.enabled||(Tn.exports.enabled=!0,An())}),An();\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nlet On=!1;_n.onceConnected.then(e=>{!function(e){On||(En.enable(),e.send({messageType:\"trace-time-sync\",messageBody:{traceTime:En.now(),localTime:Date.now()}}),En.stream(t=>e.send({messageType:\"trace\",messageBody:t}),e=>e.ov),On=!0)}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */(e)});class In{constructor(e,t){if(this.arcDevtoolsChannel=null,e.isStub)return;const n=_n.isConnected;_n.onceConnected.then(r=>{n||r.send({messageType:\"warning\",messageBody:\"pre-existing-arc\"}),this.arcDevtoolsChannel=r.forArc(e),t&&t.forEach(t=>ln.instantiateListener(t,e,this.arcDevtoolsChannel)),this.arcDevtoolsChannel.send({messageType:\"arc-available\",messageBody:{speculative:e.isSpeculative,inner:e.isInnerArc}}),this.sendEnvironmentMessage(e)})}recipeInstantiated({particles:e,activeRecipe:t}){if(!this.arcDevtoolsChannel)return;const n=({id:e,name:t})=>({id:e,name:t}),r=[];e.forEach(e=>Object.values(e.consumedSlotConnections).forEach(e=>{e.targetSlot&&r.push({particleId:e.particle.id.toString(),consumed:n(e.targetSlot),provided:Object.values(e.providedSlots).map(e=>n(e))})})),this.arcDevtoolsChannel.send({messageType:\"recipe-instantiated\",messageBody:{slotConnections:r,activeRecipe:t}})}sendEnvironmentMessage(e){const t=[];!function e(n){t.push(n),n.imports.forEach(e)}(e.context),this.arcDevtoolsChannel.send({messageType:\"arc-environment\",messageBody:{recipes:e.context.allRecipes.map(e=>({name:e.name,text:e.toString(),file:t.find(t=>t.recipes.includes(e)).fileName})),particles:e.context.allParticles.map(e=>({name:e.name,spec:e.toString(),file:t.find(t=>t.particles.includes(e)).fileName}))}})}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass Rn{constructor(e,t,n){this._channel=e,this._id=t,this._other=n,this._onmessage=void 0}postMessage(e){this._channel._post(this._other,e)}set onmessage(e){this._onmessage=e}close(){this.postMessage=(()=>{})}}class Nn{constructor(e){this.data=e}}class $n{constructor(){this.port1=new Rn(this,0,1),this.port2=new Rn(this,1,0),this._ports=[this.port1,this.port2]}async _post(e,t){if(t=JSON.parse(JSON.stringify(t)),this._ports[e]._onmessage)try{await 0,await this._ports[e]._onmessage(new Nn(t))}catch(e){console.error(\"Exception in particle code\\n\",e)}}}const Pn=(e,t)=>t([e]);\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class jn{constructor(e,t){this.arcDevtoolsChannel=t.forArc(e)}handlePecMessage(e,t,n,r){const i=this._extractStackFrames(r);this.arcDevtoolsChannel.send({messageType:\"PecLog\",messageBody:{name:e,pecMsgBody:t,pecMsgCount:n,timestamp:Date.now(),stack:i}})}_extractStackFrames(e){const t=[];if(!e)return t;if(e.includes(\"(file:///\")){for(const n of e.split(\"\\n    at \").slice(2)){const e=n.match(/^(.*) \\((.*)\\)$/),r=e?e[1]:\"<unknown>\";let i=e?e[2]:n;(i=i.replace(/:[0-9]+$/,\"\")).startsWith(\"file\")&&(i=i.replace(/^.*\\/arcs[^\\/]*\\//,\"\")),t.push({method:r,location:i,target:null,targetClass:\"noLink\"})}return t}return Pn&&Pn(e,e=>e.slice(1).map(e=>{const n=e.match(/^ {4}at (.*) \\((.*)\\)$/),r=n?n[1]:\"<unknown>\";let i=n?n[2]:e.replace(/^ *at */,\"\");const s={method:r};(i=n[2].replace(/:[0-9]+$/,\"\")).startsWith(\"http\")?(s.location=i.replace(/^.*\\/arcs[^\\/]*\\//,\"\"),s.target=i,s.targetClass=\"link\"):i.startsWith(\"webpack\")?(s.location=i.slice(11),s.target=`webpack:///./${s.location}`,s.targetClass=\"link\"):(s.location=i,s.target=null,s.targetClass=\"noLink\"),t.push(s)}),{sync:!1,cacheGlobally:!0}),t}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */var Bn,Mn=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},Dn=function(e,t){return function(n,r){t(n,r,e)}};!function(e){e[e.Mapped=0]=\"Mapped\",e[e.LocalMapped=1]=\"LocalMapped\",e[e.RemoteMapped=2]=\"RemoteMapped\",e[e.Direct=3]=\"Direct\",e[e.ObjectMap=4]=\"ObjectMap\",e[e.List=5]=\"List\",e[e.ByLiteral=6]=\"ByLiteral\"}(Bn||(Bn={}));const zn=new Map;function Fn(e,t){zn.has(e)||zn.set(e,new Map),zn.get(e).has(t)||zn.get(e).set(t,[])}function Ln(e,t,n,r){Fn(e,t),zn.get(e).get(t)[n]=r}function Un(e,t,n){Ln(e.constructor,t,n,{type:Bn.Direct})}function Hn(e,t,n){Ln(e.constructor,t,n,{type:Bn.Mapped})}function qn(e){return(t,n,r)=>{const i={type:Bn.ByLiteral,converter:e};Ln(t.constructor,n,r,i)}}function Wn(e,t){return(n,r,i)=>{const s={type:Bn.ObjectMap,key:{type:e},value:{type:t}};Ln(n.constructor,r,i,s)}}function Vn(e,t,n){Ln(e.constructor,t,n,{type:Bn.LocalMapped})}function Kn(e,t,n){Ln(e.constructor,t,n,{type:Bn.RemoteMapped})}function Zn(e,t){Fn(e.constructor,t)}function Jn(e,t,n){Ln(e.constructor,t,n,{type:Bn.Direct,initializer:!0})}function Gn(e,t,n){d()(zn.get(e.constructor)),d()(zn.get(e.constructor).get(t)),d()(zn.get(e.constructor).get(t)[n]),zn.get(e.constructor).get(t)[n].identifier=!0}function Yn(e,t,n){d()(zn.get(e.constructor)),d()(zn.get(e.constructor).get(t)),d()(zn.get(e.constructor).get(t)[n]),zn.get(e.constructor).get(t)[n].ignore=!0}class Xn{constructor(e){this._prefix=e,this._nextIdentifier=0,this._idMap=new Map,this._reverseIdMap=new Map}_newIdentifier(){return this._prefix+this._nextIdentifier++}createMappingForThing(e,t){let n;return d()(!this._reverseIdMap.has(e)),n=t||(e.apiChannelMappingId?e.apiChannelMappingId:this._newIdentifier()),d()(!this._idMap.has(n),`${t?\"requestedId\":e.apiChannelMappingId?\"apiChannelMappingId\":\"newIdentifier()\"} ${n} already in use`),this.establishThingMapping(n,e),n}maybeCreateMappingForThing(e){return this.hasMappingForThing(e)?this.identifierForThing(e):this.createMappingForThing(e)}async establishThingMapping(e,t){let n;Array.isArray(t)&&([t,n]=t),this._idMap.set(e,t),t instanceof Promise?(d()(null==n),await this.establishThingMapping(e,await t)):(this._reverseIdMap.set(t,e),n&&await n())}hasMappingForThing(e){return this._reverseIdMap.has(e)}identifierForThing(e){return d()(this._reverseIdMap.has(e),`Missing thing [${e}]`),this._reverseIdMap.get(e)}thingForIdentifier(e){return d()(this._idMap.has(e),`Missing id: ${e}`),this._idMap.get(e)}}class Qn{constructor(e,t){this._port=e,this._mapper=new Xn(t),this._port.onmessage=(async e=>this._processMessage(e)),this._debugAttachment=null,this._attachStack=!1,this.messageCount=0,this._testingHook()}_testingHook(){}close(){this._port.close()}async _processMessage(e){d()(void 0!==this[\"before\"+e.data.messageType]);const t=this.messageCount++;this._debugAttachment&&this._debugAttachment.handlePecMessage(\"on\"+e.data.messageType,e.data.messageBody,t,e.data.stack),this[\"before\"+e.data.messageType](e.data.messageBody)}send(e,t){const n={messageType:e,messageBody:t,stack:this._attachStack?(new Error).stack:void 0},r=this.messageCount++;this._debugAttachment&&this._debugAttachment.handlePecMessage(e,t,r,(new Error).stack),this._port.postMessage(n)}}function er(e){return e.toString().match(/.*?\\(([^)]*)\\)/)[1].split(\",\").map(e=>e.replace(/\\/\\*.*\\*\\//,\"\").trim()).filter(e=>e)}function tr(e,t,n){switch(e.type){case Bn.Mapped:return n.identifierForThing(t);case Bn.LocalMapped:return n.maybeCreateMappingForThing(t);case Bn.RemoteMapped:case Bn.Direct:return t;case Bn.ObjectMap:{const r={};return t.forEach((t,i)=>r[tr(e.key,i,n)]=tr(e.value,t,n)),r}case Bn.List:return t.map(t=>tr(e.value,t,n));case Bn.ByLiteral:return t.toLiteral();default:throw new Error(`Can't yet send MappingType ${e.type}`)}}function nr(e,t,n){switch(e.type){case Bn.Mapped:return n.thingForIdentifier(t);case Bn.LocalMapped:return t;case Bn.RemoteMapped:return n.thingForIdentifier(t);case Bn.Direct:return t;case Bn.ObjectMap:{const r=new Map;for(const i of Object.keys(t))r.set(nr(e.key,i,n),nr(e.value,t[i],n));return r}case Bn.List:return t.map(t=>nr(e.value,t,n));case Bn.ByLiteral:return e.converter.fromLiteral(t);default:throw new Error(`Can't yet recieve MappingType ${e.type}`)}}class rr extends Qn{constructor(e,t){super(e,\"o\"),_n.onceConnected.then(e=>{this.DevToolsConnected(),this._debugAttachment=new jn(t,e)})}Stop(){}DefineHandle(e,t,n){}InstantiateParticle(e,t,n,r){}UIEvent(e,t,n){}SimpleCallback(e,t){}AwaitIdle(e){}StartRender(e,t,n,r){}StopRender(e,t){}GetBackingStoreCallback(e,t,n,r,i,s){}ConstructArcCallback(e,t){}CreateHandleCallback(e,t,n,r,i){}MapHandleCallback(e,t,n){}CreateSlotCallback(e,t,n){}InnerArcRender(e,t,n,r){}DevToolsConnected(){}}var ir;Mn([Zn],rr.prototype,\"Stop\",null),Mn([Dn(0,function(e,t,n){Ln(e.constructor,t,n,{type:Bn.Direct,initializer:!0,redundant:!0})}),Dn(1,qn(Le)),Dn(2,Un)],rr.prototype,\"DefineHandle\",null),Mn([Dn(0,Jn),Dn(1,Gn),Dn(1,Un),Dn(2,qn(it)),Dn(3,Wn(Bn.Direct,Bn.Mapped))],rr.prototype,\"InstantiateParticle\",null),Mn([Dn(0,Hn),Dn(1,Un),Dn(2,Un)],rr.prototype,\"UIEvent\",null),Mn([Dn(0,Kn),Dn(1,Un)],rr.prototype,\"SimpleCallback\",null),Mn([Dn(0,Un)],rr.prototype,\"AwaitIdle\",null),Mn([Dn(0,Hn),Dn(1,Un),Dn(2,Wn(Bn.Direct,Bn.Direct)),Dn(3,(ir=Bn.Direct,(e,t,n)=>{const r={type:Bn.List,value:{type:ir}};Ln(e.constructor,t,n,r)}))],rr.prototype,\"StartRender\",null),Mn([Dn(0,Hn),Dn(1,Un)],rr.prototype,\"StopRender\",null),Mn([Dn(0,Jn),Dn(1,Kn),Dn(2,qn(Le)),Dn(3,Un),Dn(4,Gn),Dn(4,Un),Dn(5,Un)],rr.prototype,\"GetBackingStoreCallback\",null),Mn([Dn(0,Kn),Dn(1,Vn)],rr.prototype,\"ConstructArcCallback\",null),Mn([Dn(0,Jn),Dn(1,Kn),Dn(2,qn(Le)),Dn(3,Un),Dn(4,Gn),Dn(4,Un)],rr.prototype,\"CreateHandleCallback\",null),Mn([Dn(0,Yn),Dn(0,Jn),Dn(1,Kn),Dn(2,Un)],rr.prototype,\"MapHandleCallback\",null),Mn([Dn(0,Yn),Dn(0,Jn),Dn(1,Kn),Dn(2,Un)],rr.prototype,\"CreateSlotCallback\",null),Mn([Dn(0,Hn),Dn(1,Un),Dn(2,Un),Dn(3,Un)],rr.prototype,\"InnerArcRender\",null),Mn([Zn],rr.prototype,\"DevToolsConnected\",null);let sr=class extends Qn{constructor(e){super(e,\"i\")}Render(e,t,n){}InitializeProxy(e,t){}SynchronizeProxy(e,t){}HandleGet(e,t){}HandleToList(e,t){}HandleSet(e,t,n,r){}HandleClear(e,t,n){}HandleStore(e,t,n,r){}HandleRemove(e,t,n,r){}HandleRemoveMultiple(e,t,n,r){}HandleStream(e,t,n,r){}StreamCursorNext(e,t,n){}StreamCursorClose(e,t){}Idle(e,t){}GetBackingStore(e,t,n){}ConstructInnerArc(e,t){}ArcCreateHandle(e,t,n,r){}ArcMapHandle(e,t,n){}ServiceRequest(e,t,n){}ArcCreateSlot(e,t,n,r,i){}ArcLoadRecipe(e,t,n){}ReportExceptionInHost(e){}onDevToolsConnected(){this._attachStack=!0}};var or,ar;Mn([Dn(0,Hn),Dn(1,Un),Dn(2,Un)],sr.prototype,\"Render\",null),Mn([Dn(0,Hn),Dn(1,Vn)],sr.prototype,\"InitializeProxy\",null),Mn([Dn(0,Hn),Dn(1,Vn)],sr.prototype,\"SynchronizeProxy\",null),Mn([Dn(0,Hn),Dn(1,Vn)],sr.prototype,\"HandleGet\",null),Mn([Dn(0,Hn),Dn(1,Vn)],sr.prototype,\"HandleToList\",null),Mn([Dn(0,Hn),Dn(1,Un),Dn(2,Un),Dn(3,Un)],sr.prototype,\"HandleSet\",null),Mn([Dn(0,Hn),Dn(1,Un),Dn(2,Un)],sr.prototype,\"HandleClear\",null),Mn([Dn(0,Hn),Dn(1,Vn),Dn(2,Un),Dn(3,Un)],sr.prototype,\"HandleStore\",null),Mn([Dn(0,Hn),Dn(1,Vn),Dn(2,Un),Dn(3,Un)],sr.prototype,\"HandleRemove\",null),Mn([Dn(0,Hn),Dn(1,Vn),Dn(2,Un),Dn(3,Un)],sr.prototype,\"HandleRemoveMultiple\",null),Mn([Dn(0,Hn),Dn(1,Vn),Dn(2,Un),Dn(3,Un)],sr.prototype,\"HandleStream\",null),Mn([Dn(0,Hn),Dn(1,Vn),Dn(2,Un)],sr.prototype,\"StreamCursorNext\",null),Mn([Dn(0,Hn),Dn(1,Un)],sr.prototype,\"StreamCursorClose\",null),Mn([Dn(0,Un),Dn(1,Wn(Bn.Mapped,Bn.Direct))],sr.prototype,\"Idle\",null),Mn([Dn(0,Vn),Dn(1,Un),Dn(2,qn(Le))],sr.prototype,\"GetBackingStore\",null),Mn([Dn(0,Vn),Dn(1,Hn)],sr.prototype,\"ConstructInnerArc\",null),Mn([Dn(0,Vn),Dn(1,Kn),Dn(2,qn(Le)),Dn(3,Un)],sr.prototype,\"ArcCreateHandle\",null),Mn([Dn(0,Vn),Dn(1,Kn),Dn(2,Hn)],sr.prototype,\"ArcMapHandle\",null),Mn([Dn(0,Hn),Dn(1,Un),Dn(2,Vn)],sr.prototype,\"ServiceRequest\",null),Mn([Dn(0,Vn),Dn(1,Kn),Dn(2,Hn),Dn(3,Un),Dn(4,Un)],sr.prototype,\"ArcCreateSlot\",null),Mn([Dn(0,Kn),Dn(1,Un),Dn(2,Vn)],sr.prototype,\"ArcLoadRecipe\",null),Mn([Dn(0,qn(le))],sr.prototype,\"ReportExceptionInHost\",null),sr=Mn([(or=rr,e=>{const t=(e,t)=>{const n=zn.get(e);for(const r of n.keys()){const i=er(e.prototype[r]),s=n.get(r),o=s.findIndex(e=>e.initializer),a=s.findIndex(e=>e.identifier),l=function(...e){const t={};for(let n=0;n<s.length;n++)n!==o&&(t[i[n]]=tr(s[n],e[n],this._mapper));-1!==o&&(s[o].redundant?(d()(-1===a),t.identifier=this._mapper.maybeCreateMappingForThing(e[o])):t.identifier=this._mapper.createMappingForThing(e[o],e[a])),this.send(r,t)},c=async function(e){const t=[],n=[];for(let r=0;r<s.length;r++){if(r===o&&(-1!==a||s[r].ignore))continue;const l=r===o?\"identifier\":i[r],c=nr(s[r],e[l],this._mapper);c instanceof Promise?(n.push({promise:c,position:t.length}),t.push(()=>nr(s[r],e[l],this._mapper))):t.push(c)}n.length>0&&(await Promise.all(n.map(e=>e.promise)),n.forEach(e=>t[e.position]=t[e.position]()));const l=this[\"on\"+r](...t);o>-1&&(d()(e.identifier),await this._mapper.establishThingMapping(e.identifier,l))};Object.defineProperty(e.prototype,r,{get:()=>l}),Object.defineProperty(t.prototype,\"before\"+r,{get:()=>c})}};t(e,or),t(or,e)})],sr);\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass lr{constructor(e,t,n,r){this.handlers=new Map,this.requestedContentTypes=new Set,this._isRendered=!1,this.apiPort=e,this.slotName=n,this.particle=t,this.providedSlots=r}get isRendered(){return this._isRendered}render(e){this.apiPort.Render(this.particle,this.slotName,e),Object.keys(e).forEach(e=>{this.requestedContentTypes.delete(e)}),this._isRendered=0===this.requestedContentTypes.size&&Object.keys(e).length>0}registerEventHandler(e,t){this.handlers.has(e)||this.handlers.set(e,[]),this.handlers.get(e).push(t)}clearEventHandlers(e){this.handlers.set(e,[])}fireEvent(e){for(const t of this.handlers.get(e.handler)||[])t(e)}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */!function(e){e[e.none=0]=\"none\",e[e.pending=1]=\"pending\",e[e.full=2]=\"full\"}(ar||(ar={}));class cr{constructor(e,t,n,r,i,s){this.version=void 0,this.listenerAttached=!1,this.keepSynced=!1,this.synchronized=ar.none,this.observers=[],this.updates=[],this.barrier=null,this.id=e,this.type=t,this.port=n,this.scheduler=i,this.name=s,this.updates=[],this.pec=r}static newProxy(e,t,n,r,i,s){return t instanceof qe?new hr(e,t,n,r,i,s):t instanceof We?new dr(e,t,n,r,i,s):new ur(e,t,n,r,i,s)}reportExceptionInHost(e){Pn?Pn(e.cause.stack,t=>{e.cause.stack=t,this.port.ReportExceptionInHost(e)}):this.port.ReportExceptionInHost(e)}register(e,t){if(t.canRead&&(this.observers.push({particle:e,handle:t}),this.listenerAttached||(this.port.InitializeProxy(this,e=>this._onUpdate(e)),this.listenerAttached=!0),t.options.keepSynced&&(this.keepSynced||(this.port.SynchronizeProxy(this,e=>this._onSynchronize(e)),this.keepSynced=!0),t.options.notifySync&&this.synchronized===ar.full))){const n=this._getModelForSync();this.scheduler.enqueue(e,t,[\"sync\",e,n])}}_onSynchronize({version:e,model:t}){if(void 0!==this.version&&e<=this.version)return void console.warn(`StorageProxy '${this.id}' received stale model version ${e}; `+`current is ${this.version}`);if(!this._synchronizeModel(e,t))return;for(this.synchronized=ar.full;this.updates.length>0&&this.updates[0].version<=e;)this.updates.shift();const n=this._getModelForSync();this._notify(\"sync\",n,e=>e.keepSynced&&e.notifySync),this._processUpdates()}_onUpdate(e){if(this.observers.find(({handle:e})=>!e.options.keepSynced&&e.options.notifyUpdate)){const t=this._processUpdate(e,!1);this._notify(\"update\",t,e=>!e.keepSynced&&e.notifyUpdate)}this.keepSynced&&(e.version<=this.version?console.warn(`StorageProxy '${this.id}' received stale update version ${e.version}; `+`current is ${this.version}`):(this.updates.push(e),this.updates.sort((e,t)=>e.version-t.version),this._processUpdates()))}_notify(e,t,n=(e=>!0)){for(const{handle:r,particle:i}of this.observers)n(r.options)&&this.scheduler.enqueue(i,r,[e,i,t])}_processUpdates(){const e=e=>e.version===this.version+1||!(!this.barrier||e.barrier!==this.barrier);for(;this.updates.length>0&&e(this.updates[0]);){const e=this.updates.shift(),t=this._processUpdate(e);this.version=e.version,t&&this._notify(\"update\",t,e=>e.keepSynced&&e.notifyUpdate)}if(this.updates.length>0){if(this.synchronized!==ar.none){this.synchronized=ar.none,this.port.SynchronizeProxy(this,e=>this._onSynchronize(e));for(const{handle:e,particle:t}of this.observers)e.options.notifyDesync&&this.scheduler.enqueue(t,e,[\"desync\",t,{}])}}else this.synchronized!==ar.full&&(this.synchronized=ar.full)}generateBarrier(){return this.pec.idGenerator.newChildId(ct.fromString(this.id),\"barrier\").toString()}}class hr extends cr{constructor(){super(...arguments),this.model=new Qt}_getModelForSync(){return this.model.toList()}_synchronizeModel(e,t){return this.version=e,this.model=new Qt(t),!0}_processUpdate(e,t=!0){if(this.synchronized===ar.full)for(const{handle:t}of this.observers)if(e.originatorId===t._particleId)return null;const n=[],r=[];if(\"add\"in e)for(const{value:r,keys:i,effective:s}of e.add)(t&&this.model.add(r.id,r,i)||!t&&s)&&n.push(r);else{if(!(\"remove\"in e))throw new Error(`StorageProxy received invalid update event: ${JSON.stringify(e)}`);for(const{value:n,keys:i,effective:s}of e.remove){const e=this.model.getValue(n.id);(t&&this.model.remove(n.id,i)||!t&&s)&&r.push(e)}}if(n.length||r.length){const t={originatorId:e.originatorId};return n.length&&(t.add=n),r.length&&(t.remove=r),t}return null}async toList(){return this.synchronized===ar.full?Promise.resolve(this.model.toList()):new Promise(e=>this.port.HandleToList(this,e))}async get(e){return this.synchronized===ar.full?Promise.resolve(this.model.getValue(e)):new Promise((t,n)=>this.port.HandleToList(this,n=>t(n.find(t=>t.id===e))))}async store(e,t,n){const r=e.id,i={value:e,keys:t};if(this.port.HandleStore(this,()=>{},i,n),this.synchronized!==ar.full)return Promise.resolve();if(!this.model.add(r,e,t))return Promise.resolve();const s={originatorId:n,add:[e]};return this._notify(\"update\",s,e=>e.notifyUpdate),Promise.resolve()}async clear(e){this.synchronized!==ar.full&&this.port.HandleRemoveMultiple(this,()=>{},[],e);let t=this.model.toList().map(e=>({id:e.id,keys:this.model.getKeys(e.id)}));return this.port.HandleRemoveMultiple(this,()=>{},t,e),(t=(t=t.map(({id:e,keys:t})=>({rawData:this.model.getValue(e).rawData,id:e,keys:t}))).filter(e=>this.model.remove(e.id,e.keys))).length>0&&this._notify(\"update\",{originatorId:e,remove:t},e=>e.notifyUpdate),Promise.resolve()}async remove(e,t,n){if(this.synchronized!==ar.full){const t={id:e,keys:[]};return this.port.HandleRemove(this,()=>{},t,n),Promise.resolve()}const r=this.model.getValue(e);if(!r)return Promise.resolve();0===t.length&&(t=this.model.getKeys(e));const i={id:e,keys:t};if(this.port.HandleRemove(this,()=>{},i,n),!this.model.remove(e,t))return Promise.resolve();const s={originatorId:n,remove:[r]};return this._notify(\"update\",s,e=>e.notifyUpdate),Promise.resolve()}}class ur extends cr{constructor(){super(...arguments),this.model=null}_getModelForSync(){return this.model}_synchronizeModel(e,t){return null==this.barrier&&(this.version=e,this.model=0===t.length?null:t[0].value,d()(void 0!==this.model),!0)}_processUpdate(e,t=!0){if(d()(\"data\"in e),!t)return e;if(null!=this.barrier){if(e.barrier===this.barrier&&(this.barrier=null,this.synchronized!==ar.full)){this.synchronized=ar.full;const e=this._getModelForSync();this._notify(\"sync\",e,e=>e.keepSynced&&e.notifySync)}return null}const n=this.model;return this.model=e.data,{...e,oldData:n}}async get(){return this.synchronized===ar.full?Promise.resolve(this.model):new Promise(e=>this.port.HandleGet(this,e))}async set(e,t){if(d()(void 0!==e),JSON.stringify(this.model)===JSON.stringify(e))return Promise.resolve();let n;n=this.listenerAttached?this.generateBarrier():null;const r=this.model;this.model=JSON.parse(JSON.stringify(e)),this.barrier=n,this.port.HandleSet(this,e,t,n);const i={originatorId:t,data:e,oldData:r};return this._notify(\"update\",i,e=>e.notifyUpdate),Promise.resolve()}async clear(e){if(null==this.model)return Promise.resolve();const t=this.generateBarrier(),n=this.model;this.model=null,this.barrier=t,this.port.HandleClear(this,e,t);const r={originatorId:e,data:null,oldData:n};return this._notify(\"update\",r,e=>e.notifyUpdate),Promise.resolve()}}class dr extends cr{register(e,t){t.canRead&&this.scheduler.enqueue(e,t,[\"sync\",e,{}])}_getModelForSync(){throw new Error(\"_getModelForSync not implemented for BigCollectionProxy\")}_processUpdate(){throw new Error(\"_processUpdate not implemented for BigCollectionProxy\")}_synchronizeModel(){throw new Error(\"_synchronizeModel not implemented for BigCollectionProxy\")}async get(e){throw new Error(\"unimplemented\")}async store(e,t,n){return new Promise(r=>this.port.HandleStore(this,r,{value:e,keys:t},n))}async remove(e,t,n){return new Promise(t=>this.port.HandleRemove(this,t,{id:e,keys:[]},n))}async stream(e,t){return new Promise(n=>this.port.HandleStream(this,n,e,t))}async cursorNext(e){return new Promise(t=>this.port.StreamCursorNext(this,t,e))}async cursorClose(e){return this.port.StreamCursorClose(this,e),Promise.resolve()}}class fr{constructor(){this._scheduled=!1,this._queues=new Map,this._idleResolver=null,this._idle=null,this._scheduled=!1,this._queues=new Map}enqueue(e,t,n){this._queues.has(e)||this._queues.set(e,new Map);const r=this._queues.get(e);r.has(t)||r.set(t,[]),r.get(t).push(n),this._schedule()}get busy(){return this._queues.size>0}_updateIdle(){this._idleResolver&&!this.busy&&(this._idleResolver(),this._idle=null,this._idleResolver=null)}get idle(){return this.busy?(this._idle||(this._idle=new Promise(e=>this._idleResolver=e)),this._idle):Promise.resolve()}_schedule(){this._scheduled||(this._scheduled=!0,setTimeout(()=>{this._scheduled=!1,this._dispatch()},0))}_dispatch(){for(;this._queues.size>0;){const e=[...this._queues.keys()][0],t=this._queues.get(e);this._queues.delete(e);for(const[e,n]of t.entries())for(const t of n)try{e._notify(...t)}catch(t){console.error(\"Error dispatching to particle\",t),e.storage.reportExceptionInHost(new ce(t,e._particleId,\"StorageProxyScheduler::_dispatch\"))}}this._updateIdle()}}var pr,mr=n(75),gr=n.n(mr);\n/**\n * @license\n * Copyright (c) 2019 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nfunction yr(e){const t=\"schema-primitive\"===e.kind?e.type:e.kind;switch(t){case\"Text\":return\"string\";case\"URL\":return\"Url\";case\"Number\":return\"double\";case\"Boolean\":return\"bool\";case\"Bytes\":case\"Object\":case\"schema-union\":case\"schema-tuple\":case\"schema-reference\":throw new Error(`'${t}' not yet supported for schema to proto-json conversion`);case\"schema-collection\":throw new Error(\"Nested collections not yet supported for schema to proto-json conversion\");default:throw new Error(`Unknown type '${t}' in schema`)}}class _r{constructor(e){d()(e.names.length>0,\"At least one schema name is required for proto conversion\");const t=gr.a.Root.fromJSON(function(e){let t=0,n=!1;const r={};for(const[i,s]of Object.entries(e.fields).sort()){let e;t++,e=\"schema-collection\"===s.kind?{rule:\"repeated\",type:yr(s.schema),id:t}:{type:yr(s),id:t},n=n||\"Url\"===e.type,r[i]=e}const i={nested:{[e.name]:{fields:r}}};return n&&(i.nested.Url={fields:{href:{type:\"string\",id:1}}}),i}(e));this.schema=e,this.message=t.lookupType(e.name)}encode(e){const t=this.message.create(),n=(e,t)=>\"URL\"===e.type?{href:t}:t;for(const[r,i]of Object.entries(e.toLiteral())){const e=this.schema.fields[r];\"schema-collection\"===e.kind?t[r]=[...i].map(t=>n(e.schema,t)):t[r]=n(e,i)}return this.message.encode(t).finish()}decode(e){const t=this.message.decode(e),n=(e,t)=>\"URL\"===e.type?t.href:t,r={};for(const[e,i]of Object.entries(t.toJSON())){const t=this.schema.fields[e];\"schema-collection\"===t.kind?r[e]=i.map(e=>n(t.schema,e)):r[e]=n(t,i)}return new(this.schema.entityClass())(r)}}function vr(e){return t=>{throw new Error(e+\": \"+t)}}class br extends _t{constructor(){super(...arguments),this.handleMap=new Map,this.revHandleMap=new Map,this.converters=new Map}async initialize(e){this.memory=new WebAssembly.Memory({initial:256,maximum:256}),this.heap=new Uint8Array(this.memory.buffer);const t={memory:this.memory,__memory_base:1024,table:new WebAssembly.Table({initial:35,maximum:35,element:\"anyfunc\"}),__table_base:0,DYNAMICTOP_PTR:4096,_emscripten_get_heap_size:()=>this.heap.length,_emscripten_resize_heap:e=>!1,_emscripten_memcpy_big:(e,t,n)=>{this.heap.set(this.heap.subarray(t,t+n),e)},abort:vr(\"abort\"),_abort:vr(\"_abort\"),___assert_fail:vr(\"assert\"),___setErrNo:vr(\"setErrNo\"),abortOnCannotGrowMemory:vr(\"abortOnCannotGrowMemory\"),_handleSet:async(e,t)=>(async function(e,t){const n=new e.entityClass({num:t});await e.set(n)})(this.revHandleMap.get(e),t),_console:e=>console.log(`<${this.spec.name}> ${this.readString(e)}`),_consoleN:(e,t)=>console.log(`<${this.spec.name}> ${this.readString(e)} ${t}`)};this.wasm=await WebAssembly.instantiate(e,{env:t}),this.exports=this.wasm.instance.exports,this.innerParticle=this.exports._newParticle(),console.log(\"---------------------------------------------------\")}async setHandles(e){for(const[t,n]of e){d()(n instanceof pt),d()(\"Number\"===n.entityClass.schema.fields.num.type);const e=this.storeString(t),r=this.exports._newHandle(this.innerParticle,e);this.handleMap.set(n,r),this.revHandleMap.set(r,n)}this.exports._initParticle(this.innerParticle)}async onHandleSync(e,t){if(!t)return;let n=this.converters.get(t.schema);n||(n=new _r(t.schema),this.converters.set(t.schema,n));const r=n.encode(t);r[0]=255&t.num;const i=this.storeBuffer(r);this.exports._syncHandle(this.innerParticle,this.handleMap.get(e),i,r.length),this.exports._free(i)}async onHandleUpdate(e,t){}async onHandleDesync(e){}renderSlot(e,t){}renderHostedSlot(e,t,n){}fireEvent(e,t){}storeBuffer(e){const t=this.exports._malloc(e.length);for(let n=0;n<e.length;n++)this.heap[t+n]=e[n];return t}storeString(e){const t=this.exports._malloc(e.length+1);for(let n=0;n<e.length;n++)this.heap[t+n]=e.charCodeAt(n);return this.heap[t+e.length]=0,t}readString(e){let t=\"\";for(;e<this.heap.length&&0!==this.heap[e];)t+=String.fromCharCode(this.heap[e++]);return t}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class wr{constructor(e,t,n,r){this.particles=[],this.pendingLoads=[],this.scheduler=new fr,this.keyedProxies={};const i=this;this.apiPort=new class extends sr{onDefineHandle(e,t,n){return cr.newProxy(e,t,this,i,i.scheduler,n)}onGetBackingStoreCallback(e,t,n,r,s){const o=cr.newProxy(r,t,this,i,i.scheduler,n);return o.storageKey=s,[o,()=>e(o,s)]}onCreateHandleCallback(e,t,n,r){const s=cr.newProxy(r,t,this,i,i.scheduler,n);return[s,()=>e(s)]}onMapHandleCallback(e,t){return[t,()=>e(t)]}onCreateSlotCallback(e,t){return[t,()=>e(t)]}onInnerArcRender(e,t,n,r){e.renderHostedSlot(t,n,r)}onStop(){global.close&&global.close()}async onInstantiateParticle(e,t,n){return i.instantiateParticle(e,t,n)}onSimpleCallback(e,t){e(t)}onConstructArcCallback(e,t){e(t)}onAwaitIdle(e){i.idle.then(t=>{setTimeout(()=>{this.Idle(e,i.relevance)},0)})}onUIEvent(e,t,n){e.fireEvent(t,n)}onStartRender(e,t,n,r){e.addSlotProxy(new lr(this,e,t,n)),e.renderSlot(t,r)}onStopRender(e,t){d()(e.hasSlotProxy(t),`Stop render called for particle ${e.spec.name} slot ${t} without start render being called.`),e.removeSlotProxy(t)}}(e),this.pecId=t,this.idGenerator=n,this.loader=r,r.setParticleExecutionContext(this)}generateID(){return this.idGenerator.newChildId(this.pecId).toString()}innerArcHandle(e,t){const n=this;return{createHandle:async(r,i,s)=>new Promise((o,a)=>n.apiPort.ArcCreateHandle(e=>{const r=yt(e,n.idGenerator,i,t);o(r),s&&e.register(s,r)},e,r,i)),mapHandle:async t=>new Promise((r,i)=>n.apiPort.ArcMapHandle(e=>{r(e)},e,t)),createSlot:async(t,r,i)=>new Promise((s,o)=>n.apiPort.ArcCreateSlot(e=>s(e),e,t,r,i)),loadRecipe:async t=>new Promise((r,i)=>n.apiPort.ArcLoadRecipe(e,t,e=>{e.error?i(e.error):r(e)}))}}getStorageProxy(e,t){return this.keyedProxies[e]||(this.keyedProxies[e]=new Promise((n,r)=>{this.apiPort.GetBackingStore((e,t)=>{this.keyedProxies[t]=e,n(e)},e,t)})),this.keyedProxies[e]}defaultCapabilitySet(){return{constructInnerArc:async e=>new Promise((t,n)=>this.apiPort.ConstructInnerArc(n=>t(this.innerArcHandle(n,e.id)),e)),serviceRequest:(e,t,n)=>{this.apiPort.ServiceRequest(e,t,n)}}}async instantiateParticle(e,t,n){let r;const i=new Promise(e=>r=e);let s;if(this.pendingLoads.push(i),t.implFile&&t.implFile.endsWith(\".wasm\"))(s=await this.loadWasmParticle(t)).setCapabilities({});else{const e=await this.loader.loadParticleClass(t);(s=new e).setCapabilities(this.defaultCapabilitySet())}this.particles.push(s);const o=new Map,a=[];return n.forEach((n,r)=>{const i=t.handleConnectionMap.get(r),l=yt(n,this.idGenerator,r,e,i.isInput,i.isOutput);o.set(r,l),a.push({proxy:n,particle:s,handle:l})}),[s,async()=>{await s.setHandles(o),a.forEach(({proxy:e,particle:t,handle:n})=>e.register(t,n));const e=this.pendingLoads.indexOf(i);this.pendingLoads.splice(e,1),r()}]}async loadWasmParticle(e){const t=await this.loader.loadBinary(e.implFile);d()(t&&t.byteLength>0),br.spec=e;const n=new br;return await n.initialize(t),br.spec=null,n}get relevance(){const e=new Map;return this.particles.forEach(t=>{0!==t.relevances.length&&(e.set(t,t.relevances),t.relevances.length=0)}),e}get busy(){return!!(this.pendingLoads.length>0||this.scheduler.busy)||this.particles.filter(e=>e.busy).length>0}get idle(){if(!this.busy)return Promise.resolve();const e=this.particles.filter(async e=>e.busy).map(async e=>e.idle);return Promise.all([this.scheduler.idle,...this.pendingLoads,...e]).then(()=>this.idle)}}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class Sr extends Ct{constructor(e){super(),this._fileMap=e,e.hasOwnProperty(\"*\")&&(this._cannedResponse=e[\"*\"])}loadResource(e){return this._fileMap.hasOwnProperty(e)?this._fileMap[e]:this._cannedResponse||super.loadResource(e)}path(e){return this._fileMap.hasOwnProperty(e)||this._cannedResponse?e:super.path(e)}join(e,t){return this._fileMap.hasOwnProperty(e)||this._cannedResponse?t:super.join(e,t)}clone(){return new Sr(this._fileMap)}}\n// @license\n!function(e){e.Permuted=\"permuted\",e.Independent=\"independent\"}(pr||(pr={}));class kr{constructor(e,t){this._arc=e,this._args=t}get arc(){return this._arc}getResults(e){return e.generated}async generate(e){return[]}}class Cr{constructor(e){this.descendants=[],d()(e),this.tactic=e}onAction(e){this.currentAction=e}onResult(e){this.currentResult=e,this.updateList=[]}onResultDone(){this.runUpdateList(this.currentResult.result,this.updateList),this.currentResult=void 0,this.updateList=void 0}onActionDone(){this.currentAction=void 0}static walk(e,t,n){return t.onAction(n),e.forEach(e=>{t.onResult(e),t.onResultDone()}),t.onActionDone(),t.descendants}visit(e,...t){const n=e(this.currentResult.result,...t);this.isEmptyResult(n)||this.updateList.push({continuation:n,context:t})}runUpdateList(e,t){const n=[];if(t.length)switch(this.tactic){case pr.Permuted:{let r=[[]];t.forEach(({continuation:e,context:t})=>{const n=[];\"function\"==typeof e&&(e=[e]),e.forEach(e=>{r.forEach(r=>{const i=r.slice();i.push({continuation:e,context:t}),n.push(i)})}),r=n});for(let t of r){const r=new Map,i=e.clone(r);let s=0;0!==(t=t.filter(e=>null!==e.continuation)).length&&(t.forEach(({continuation:e,context:t})=>{s=e(i,...t.map(e=>r.get(e)||e))}),n.push({result:i,score:s}))}break}case pr.Independent:t.forEach(({continuation:t,context:r})=>{\"function\"==typeof t&&(t=[t]);let i=0;t.forEach(t=>{null==t&&(t=(()=>0));const s=new Map,o=e.clone(s);i=t(o,...r.map(e=>s.get(e)||e)),n.push({result:o,score:i})})});break;default:throw new Error(`${this.tactic} not supported`)}for(const e of n)this.createDescendant(e.result,e.score)}createWalkerDescendant(e,t,n,r){d()(this.currentResult,\"no current result\"),d()(this.currentAction,\"no current action\"),this.currentResult.score&&(t+=this.currentResult.score),this.descendants.push({result:e,score:t,derivation:[{parent:this.currentResult,strategy:this.currentAction}],hash:n,valid:r})}isEmptyResult(e){return!e||(e.constructor===Array&&e.length<=0||(d()(\"function\"==typeof e||e.length),!1))}}Cr.Permuted=pr.Permuted,Cr.Independent=pr.Independent;class xr extends Cr{onResult(e){super.onResult(e);const t=e.result;if(this.onRecipe&&this.visit(this.onRecipe.bind(this)),this.onParticle)for(const e of t.particles)this.visit(this.onParticle.bind(this),e);if(this.onPotentialHandleConnection)for(const e of t.particles)if(e.spec)for(const t of e.spec.handleConnectionMap.values())e.connections[t.name]||this.visit(this.onPotentialHandleConnection.bind(this),e,t);if(this.onHandleConnection)for(const e of t.handleConnections)this.visit(this.onHandleConnection.bind(this),e);if(this.onHandle)for(const e of t.handles)this.visit(this.onHandle.bind(this),e);if(this.onPotentialSlotConnection)for(const e of t.particles)for(const[t,n]of e.getSlotSpecs())e.getSlotConnectionByName(t)||this.visit(this.onPotentialSlotConnection.bind(this),e,n);if(this.onSlotConnection)for(const e of t.slotConnections)this.visit(this.onSlotConnection.bind(this),e);if(this.onSlot)for(const e of t.slots)this.visit(this.onSlot.bind(this),e);if(this.onObligation)for(const e of t.obligations)this.visit(this.onObligation.bind(this),e);if(this.onRequiredParticle)for(const e of t.requires)for(const t of e.particles)this.visit(this.onRequiredParticle.bind(this),t)}createDescendant(e,t){const n=e.normalize(),r=n?e.digest():null;super.createWalkerDescendant(e,t,r,n)}}class Tr{static getClonedSlot(e,t){let n=e.updateToClone({selectedSlot:t}).selectedSlot;return n||(t.id&&(n=e.findSlotByID(t.id)),null==n&&((n=e instanceof Gt?e.parent.newSlot(t.name):e.newSlot(t.name)).id=t.id)),n}static connectSlotConnection(e,t){const n=e.recipe;if(!e.targetSlot){const r=Tr.getClonedSlot(n,t);e.connectToSlot(r)}d()(!t.id||!e.targetSlot.id||t.id===e.targetSlot.id,`Cannot override slot id '${e.targetSlot.id}' with '${t.id}'`),e.targetSlot.id=t.id||e.targetSlot.id,e.targetSlot.tags=[...t.tags]}static findAllSlotCandidates(e,t,n){const r=e.getSlotConnectionByName(t.name);return{local:r&&r.targetSlot?[]:Tr._findSlotCandidates(e,t,e.recipe.slots),remote:Tr._findSlotCandidates(e,t,n.pec.slotComposer.getAvailableContexts())}}static _findSlotCandidates(e,t,n){const r=n.filter(n=>this.slotMatches(e,t,n));return r.sort((e,t)=>e.name<t.name),r}static slotMatches(e,t,n){if(!Tr.specMatch(t,n.spec))return!1;const r=e.getSlotConnectionBySpec(t);return!!Tr.tagsOrNameMatch(t,n.spec,r,n)&&!!Tr.handlesMatch(e,n)}static specMatch(e,t){return e&&t&&e.isSet===t.isSet}static handlesMatch(e,t){return 0===t.handles.length||!!Object.values(e.connections).find(e=>t.handles.includes(e.handle)||e.handle&&e.handle.id&&t.handles.map(e=>e.id).includes(e.handle.id))}static tagsOrNameMatch(e,t,n,r){const i=[].concat(e.tags||[],n?n.tags:[],n&&n.targetSlot?n.targetSlot.tags:[]),s=[].concat(t.tags||[],r?r.tags:[],r?r.name:t.name?t.name:[]);return!!(i.length>0&&i.some(e=>s.includes(e)))||e.name===(r?r.name:t.name)}static replaceOldSlot(e,t,n){if(t&&(!t.id||t.id!==n.id)){if(void 0!==t.sourceConnection){if(void 0===n.sourceConnection)return!1;const e=Tr.getClonedSlot(t.sourceConnection.recipe,n);t.sourceConnection.providedSlots[t.name]=e}for(;t.consumeConnections.length>0;){const e=t.consumeConnections[0];e.disconnectFromSlot(),Tr.connectSlotConnection(e,n)}}return!0}}class Er extends xr{constructor(e,t){super(e),this.arc=t}onHandle(e,t){const n=this.arc;if(0===t.connections.length||t.id&&t.storageKey||!t.type||!t.fate)return;let r;if(t.id){if(!t.storageKey){let e;switch(t.fate){case\"use\":e=n.findStoreById(t.id);break;case\"map\":case\"copy\":e=n.context.findStoreById(t.id);break;case\"create\":case\"?\":break;default:throw new Error(`unexpected fate ${t.fate}`)}r=e?[e]:[]}}else{Xt.directionCounts(t);switch(t.fate){case\"use\":r=n.findStoresByType(t.type,{tags:t.tags});break;case\"map\":case\"copy\":r=n.context.findStoresByType(t.type,{tags:t.tags,subtype:!0});break;case\"create\":case\"?\":r=[];break;default:throw new Error(`unexpected fate ${t.fate}`)}}return 1===(r=r.filter(n=>{for(const r of e.handles)if(n.id===r.id&&r!==t)return!1;return!0})).length?(e,t)=>(t.mapToStorage(r[0]),0):void 0}onSlotConnection(e,t){const n=this.arc;if(t.isConnected())return;const r=t.getSlotSpec(),i=t.particle,{local:s,remote:o}=Tr.findAllSlotCandidates(i,r,n),a=[...s,...o];if(1!==a.length)return;const l=a[0];return(e,t)=>(Tr.connectSlotConnection(t,l),1)}onPotentialSlotConnection(e,t,n){const r=this.arc,{local:i,remote:s}=Tr.findAllSlotCandidates(t,n,r),o=[...i,...s];if(1!==o.length)return;const a=o[0];return(e,t,n)=>{const r=t.addSlotConnection(n.name);return Tr.connectSlotConnection(r,a),1}}onObligation(e,t){const n=t.from.instance,r=t.to.instance;for(const e of Object.values(n.connections))for(const t of Object.values(r.connections))if(e.handle&&e.handle===t.handle)return(e,t)=>(e.removeObligation(t),1)}}class Ar extends kr{async generate(e){return Er.walk(this.getResults(e),new Er(Er.Permuted,this.arc),this)}}class Or{constructor(e){this.resolver=new Ar(e)}async resolve(e){e=e.clone();const t={errors:new Map};if(!e.normalize(t))return console.warn(`could not normalize a recipe: ${[...t.errors.values()].join(\"\\n\")}.\\n${e.toString()}`),null;const n=await this.resolver.generate({generated:[{result:e,score:1}],terminal:[]});return 0===n.length?null:n[0].result}}class Ir{static register(e,t){Ir.registry[e]=t}static async request(e){let{service:t,invoke:n,call:r}=e;r&&([t,n]=r.split(\".\"));const i=Ir.registry[t];return i&&i[n]?await i[n](e):null}}Ir.registry={},Object.freeze(Ir),Ir.register(\"test\",{classify:async e=>({data:\"it's a pig, that don't fly straight\"})});\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass Rr{constructor(e,t,n){this.nextIdentifier=0,this.idleVersion=0,this.close=(()=>{e.close(),this._apiPort.close()}),this.arc=n,this.slotComposer=t;const r=this;this._apiPort=new class extends rr{onRender(e,t,n){r.slotComposer&&r.slotComposer.renderSlot(e,t,n)}onInitializeProxy(e,t){e.on(\"change\",e=>this.SimpleCallback(t,e),{})}async onSynchronizeProxy(e,t){const n=await e.modelForSynchronization();this.SimpleCallback(t,n)}async onHandleGet(e,t){const n=await e.get();this.SimpleCallback(t,n)}async onHandleToList(e,t){const n=await e.toList();this.SimpleCallback(t,n)}onHandleSet(e,t,n,r){e.set(t,n,r)}onHandleClear(e,t,n){e.clear(t,n)}async onHandleStore(e,t,n,r){await e.store(n.value,n.keys,r),this.SimpleCallback(t,{})}async onHandleRemove(e,t,n,r){await e.remove(n.id,n.keys,r),this.SimpleCallback(t,{})}async onHandleRemoveMultiple(e,t,n,r){await e.removeMultiple(n,r),this.SimpleCallback(t,{})}async onHandleStream(e,t,n,r){this.SimpleCallback(t,await e.stream(n,r))}async onStreamCursorNext(e,t,n){this.SimpleCallback(t,await e.cursorNext(n))}onStreamCursorClose(e,t){e.cursorClose(t)}onIdle(e,t){e===r.idleVersion&&(r.idlePromise=void 0,r.idleResolve(t))}async onGetBackingStore(e,t,n){t||(t=r.arc.storageProviderFactory.baseStorageKey(n,r.arc.storageKey||\"volatile\"));const i=await r.arc.storageProviderFactory.baseStorageFor(n,t);this.GetBackingStoreCallback(i,e,n.collectionOf(),n.toString(),i.id,t)}onConstructInnerArc(e,t){const n=r.arc.createInnerArc(t);this.ConstructArcCallback(e,n)}async onArcCreateHandle(e,t,n,r){const i=await t.createStore(n,r,null,[],\"volatile\");this.CreateHandleCallback(i,e,n,r,i.id)}onArcMapHandle(e,t,n){d()(r.arc.findStoreById(n.id),`Cannot map nonexistent handle ${n.id}`),this.MapHandleCallback({},e,n.id)}onArcCreateSlot(e,t,n,i,s){let o;r.slotComposer&&(o=r.slotComposer.createHostedSlot(t,n,i,s)),this.CreateSlotCallback({},e,o)}async onArcLoadRecipe(e,t,n){const i=await Ii.parse(t,{loader:e.loader,fileName:\"\"}),s={providedSlotIds:{}};let o=void 0,a=i.recipes[0];if(a){for(const t of a.slots)if(t.id=t.id||`slotid-${e.generateID()}`,t.sourceConnection){const e=t.sourceConnection.particle.localName;e&&(s.providedSlotIds[`${e}.${t.name}`]=t.id)}const t=[];for(const e of a.handles){const n=r.arc.findStoreById(e.id)||i.findStoreById(e.id);n?e.mapToStorage(n):t.push(e)}if(t.length>0){let n=a;for(const t of[new Or(e),new Or(r.arc)])n=await t.resolve(n)||n;n===a?o=`Recipe couldn't load due to missing handles [recipe=${a}, missingHandles=${t.join(\"\\n\")}].`:a=n}if(!o){const n={errors:new Map};t.length>0||a.normalize(n)?a.isResolved()?(i.stores.forEach(async e=>{e instanceof Ei?r.arc._registerStore(await e.inflate(),[]):r.arc._registerStore(e,[])}),e.instantiate(a)):o=`Recipe is not resolvable:\\n${a.toString({showUnresolved:!0})}`:o=`Recipe ${a} could not be normalized:\\n${[...n.errors.values()].join(\"\\n\")}`}}else o=\"No recipe defined\";this.SimpleCallback(n,o?{error:o}:s)}onReportExceptionInHost(e){e.particleName||(e.particleName=r.arc.loadedParticleInfo.get(e.particleId).spec.name),function(e){for(const t of ue)t(e)}(e)}async onServiceRequest(e,t,n){const r=await Ir.request(t);this.SimpleCallback(n,r)}}(e,n)}stop(){this._apiPort.Stop()}get idle(){return null==this.idlePromise&&(this.idlePromise=new Promise((e,t)=>{this.idleResolve=e})),this.idleVersion=this.nextIdentifier,this._apiPort.AwaitIdle(this.nextIdentifier++),this.idlePromise}get messageCount(){return this._apiPort.messageCount}sendEvent(e,t,n){this._apiPort.UIEvent(e,t,n)}instantiate(e,t){t.forEach((e,t)=>{this._apiPort.DefineHandle(e,e.type.resolvedType(),t)}),this._apiPort.InstantiateParticle(e,e.id.toString(),e.spec,t)}startRender({particle:e,slotName:t,providedSlots:n,contentTypes:r}){this._apiPort.StartRender(e,t,n,r)}stopRender({particle:e,slotName:t}){this._apiPort.StopRender(e,t)}innerArcRender(e,t,n,r){this._apiPort.InnerArcRender(e,t,n,r)}}class Nr{constructor(){this.next=Promise.resolve(),this.depth=0}get locked(){return 0!==this.depth}async acquire(){let e;const t=this.next.then(()=>(this.depth++,()=>{e(),this.depth--}));return this.next=new Promise(t=>{e=t}),t}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class $r{constructor({id:e,context:t,pecFactory:n,slotComposer:r,loader:i,storageKey:s,storageProviderFactory:o,speculative:a,innerArc:l,stub:c,listenerClasses:h}){this._activeRecipe=new Jt,this._recipeDeltas=[],this.dataChangeCallbacks=new Map,this.storesById=new Map,this.storageKeys={},this.storeTags=new Map,this.storeDescriptions=new Map,this.innerArcsByParticle=new Map,this.instantiateMutex=new Nr,this.idGenerator=lt.newSession(),this.loadedParticleInfo=new Map,this._context=t||new Ii({id:e}),this.pecFactory=n||function(e){return(t,n)=>{const r=new $n,i=e instanceof Sr?e.clone():new Ct;return new wr(r.port1,t,n,i),r.port2}}(i).bind(null),\"string\"==typeof e?(console.error(`Arc created with string ID ${e}!!! This should be an object of type Id instead. This warning will turn into an `+\"exception soon (end of April 2019).\"),this.id=ht.fromString(e)):this.id=e,this.isSpeculative=!!a,this.isInnerArc=!!l,this.isStub=!!c,this._loader=i,this.storageKey=s;const u=this.generateID(),d=this.pecFactory(u,this.idGenerator);this.pec=new Rr(d,r,this),this.storageProviderFactory=o||new xi(this.id),this.listenerClasses=h,this.debugHandler=new In(this,h)}get loader(){return this._loader}get modality(){return this.pec.slotComposer&&this.pec.slotComposer.modality?this.pec.slotComposer.modality:this.activeRecipe.modality}dispose(){for(const e of this.innerArcs)e.dispose();if(this.pec.stop(),this.pec.close(),!this.isInnerArc&&this.pec.slotComposer){const e=this.allDescendingArcs;this.pec.slotComposer.consumers.forEach(t=>d()(e.includes(t.arc))),this.pec.slotComposer.dispose()}}async _waitForIdle(){for(;;){const e=this.pec.messageCount,t=this.innerArcs;if(await Promise.all([this.pec.idle,...t.map(async e=>e.idle)]),this.innerArcs.length===t.length&&this.pec.messageCount===e+2)break}}get idle(){return this.waitForIdlePromise||(this.waitForIdlePromise=this._waitForIdle().then(()=>this.waitForIdlePromise=null)),this.waitForIdlePromise}findInnerArcs(e){return this.innerArcsByParticle.get(e)||[]}get innerArcs(){return[].concat(...this.innerArcsByParticle.values())}get allDescendingArcs(){return[this].concat(...this.innerArcs.map(e=>e.allDescendingArcs))}createInnerArc(e){const t=this.generateID(\"inner\"),n=new $r({id:t,pecFactory:this.pecFactory,slotComposer:this.pec.slotComposer,loader:this._loader,context:this.context,innerArc:!0,speculative:this.isSpeculative,listenerClasses:this.listenerClasses});let r=this.innerArcsByParticle.get(e);return r||(r=[],this.innerArcsByParticle.set(e,r)),r.push(n),n}async _serializeHandle(e,t,n){const r=e.type.getContainedType()||e.type;r instanceof Ke&&(t.interfaces+=r.interfaceInfo.toString()+\"\\n\");const i=this.storageProviderFactory.parseStringAsKey(e.storageKey),s=[...this.storeTags.get(e)||new Set].map(e=>`#${e}`).join(\" \"),o=this.activeRecipe.findHandle(e.id),a=o?o.originalId:null;let l=`'${e.id}'`;switch(a&&(l+=`!!'${a}'`),i.protocol){case\"firebase\":case\"pouchdb\":t.handles+=`store ${n} of ${e.type.toString()} ${l} @${null===e.version?0:e.version} ${s} at '${e.storageKey}'\\n`;break;case\"volatile\":{let r=[];if(s.includes(\"volatile\")||(r=(await e.toLiteral()).model.map(e=>{const{id:t,value:n}=e,r=e.index;if(null==n)return null;let i;if(n.rawData){i={$id:t};for(const e of Object.keys(n.rawData))i[e]=n.rawData[e]}else i=n;return void 0!==r&&(i.$index=r),i})),e.referenceMode&&r.length>0){const i=r[0].storageKey;if(!t.dataResources.has(i)){const r=`${n}_Data`;t.dataResources.set(i,r),e instanceof rn&&(await e.ensureBackingStore(),await this._serializeHandle(e.backingStore,t,r))}const s=t.dataResources.get(i);r.forEach(e=>{e.storageKey=s})}t.resources+=`resource ${n}Resource\\n`;const i=\"  \";t.resources+=i+\"start\\n\";const o=JSON.stringify(r);t.resources+=o.split(\"\\n\").map(e=>i+e).join(\"\\n\"),t.resources+=\"\\n\",t.handles+=`store ${n} of ${e.type.toString()} ${l} @${e.version||0} ${s} in ${n}Resource\\n`;break}default:throw new Error(`unknown storageKey protocol ${i.protocol}`)}}async _serializeHandles(){const e={handles:\"\",resources:\"\",interfaces:\"\",dataResources:new Map};let t=0;const n=new Set,r=new Set,i=new Set(this.context.stores.map(e=>e.id));for(const e of this._activeRecipe.handles)if(\"map\"===e.fate)n.add(this.context.findManifestUrlForHandleId(e.id));else{if(e.immediateValue)continue;r.add(e.id)}for(const t of n.values())e.resources+=`import '${t}'\\n`;for(const n of this._stores)r.has(n.id)&&!i.has(n.id)&&await this._serializeHandle(n,e,`Store${t++}`);return e.resources+e.interfaces+e.handles}_serializeParticles(){const e=[];e.push(...this._activeRecipe.particles.map(e=>e.spec)),e.push(...this._activeRecipe.handles.filter(e=>e.immediateValue).map(e=>e.immediateValue));const t=[];return e.forEach(e=>{for(const n of e.handleConnections)n.type instanceof Ke&&t.push(n.type.interfaceInfo.toString());t.push(e.toString())}),t.join(\"\\n\")}_serializeStorageKey(){return this.storageKey?`storageKey: '${this.storageKey}'\\n`:\"\"}async serialize(){return await this.idle,`\\nmeta\\n  name: '${this.id}'\\n  ${this._serializeStorageKey()}\\n\\n${await this._serializeHandles()}\\n\\n${this._serializeParticles()}\\n\\n@active\\n${this.activeRecipe.toString()}`}async persistSerialization(e){const t=this.storageProviderFactory,n=t.parseStringAsKey(this.storageKey).childKeyForArcInfo(),r=new Ge,i=await t.connectOrConstruct(\"store\",r,n.toString());i.referenceMode=!1,await i.set(r.newInstance(this.id,e))}static async deserialize({serialization:e,pecFactory:t,slotComposer:n,loader:r,fileName:i,context:s,listenerClasses:o}){const a=await Ii.parse(e,{loader:r,fileName:i,context:s}),l=new $r({id:ct.fromString(a.meta.name),storageKey:a.meta.storageKey,slotComposer:n,pecFactory:t,loader:r,storageProviderFactory:a.storageProviderFactory,context:s,listenerClasses:o});await Promise.all(a.stores.map(async e=>{const t=a.storeTags.get(e);e instanceof Ei&&(e=await e.inflate()),l._registerStore(e,t)}));const c=a.activeRecipe.clone(),h={errors:new Map};return d()(c.normalize(h),`Couldn't normalize recipe ${c.toString()}:\\n${[...h.errors.values()].join(\"\\n\")}`),await l.instantiate(c),l}get context(){return this._context}get activeRecipe(){return this._activeRecipe}get allRecipes(){return[this.activeRecipe].concat(this.context.allRecipes)}get recipes(){return[this.activeRecipe]}get recipeDeltas(){return this._recipeDeltas}loadedParticleSpecs(){return[...this.loadedParticleInfo.values()].map(({spec:e})=>e)}async _instantiateParticle(e){e.id=this.generateID(\"particle\");const t={spec:e.spec,stores:new Map};this.loadedParticleInfo.set(e.id.toString(),t),await this._provisionSpecUrl(e.spec);for(const[n,r]of Object.entries(e.connections)){const e=this.findStoreById(r.handle.id);d()(e,`can't find store of id ${r.handle.id}`),d()(void 0!==t.spec.handleConnectionMap.get(n),\"can't connect handle to a connection that doesn't exist\"),t.stores.set(n,e)}this.pec.instantiate(e,t.stores)}async _provisionSpecUrl(e){e.implBlobUrl||this.loader&&this.loader.provisionObjectUrl&&e.setImplBlobUrl(await this.loader.provisionObjectUrl(e.implFile))}generateID(e=\"\"){return this.idGenerator.newChildId(this.id,e)}get _stores(){return[...this.storesById.values()]}async cloneForSpeculativeExecution(){const e=new $r({id:this.generateID(),pecFactory:this.pecFactory,context:this.context,loader:this._loader,speculative:!0,innerArc:this.isInnerArc,listenerClasses:this.listenerClasses}),t=new Map;for(const n of this._stores){const r=await e.storageProviderFactory.construct(n.id,n.type,\"volatile\");await r.cloneFrom(n),t.set(n,r),this.storeDescriptions.has(n)&&e.storeDescriptions.set(r,this.storeDescriptions.get(n))}this.loadedParticleInfo.forEach((n,r)=>{const i=new Map;n.stores.forEach((e,n)=>i.set(n,t.get(e))),e.loadedParticleInfo.set(r,{spec:n.spec,stores:i})});const{cloneMap:n}=this._activeRecipe.mergeInto(e._activeRecipe);this._recipeDeltas.forEach(t=>e._recipeDeltas.push({particles:t.particles.map(e=>n.get(e)),handles:t.handles.map(e=>n.get(e)),slots:t.slots.map(e=>n.get(e)),patterns:t.patterns}));for(const[t,r]of this.innerArcsByParticle.entries())e.innerArcsByParticle.set(n.get(t),await Promise.all(r.map(async e=>e.cloneForSpeculativeExecution())));for(const n of t.values())e._registerStore(n,[]);return e}async instantiate(e){d()(e.isResolved(),`Cannot instantiate an unresolved recipe: ${e.toString({showUnresolved:!0})}`),d()(e.isCompatible(this.modality),`Cannot instantiate recipe ${e.toString()} with [${e.modality.names}] modalities in '${this.modality.names}' arc`);const t=await this.instantiateMutex.acquire();try{await this._doInstantiate(e)}finally{t()}}async _doInstantiate(e){const{handles:t,particles:n,slots:r}=e.mergeInto(this._activeRecipe);this._recipeDeltas.push({particles:n,handles:t,slots:r,patterns:e.patterns}),r.forEach(e=>e.id=e.id||`slotid-${this.generateID().toString()}`);for(const e of t){if([\"copy\",\"create\"].includes(e.fate)){let t=e.type;\"create\"===e.fate&&d()(t.maybeEnsureResolved(),`Can't assign resolved type to ${t}`),t=t.resolvedType(),d()(t.isResolved(),`Can't create handle for unresolved type ${t}`);const n=await this.createStore(t,null,this.generateID().toString(),e.tags,e.immediateValue?\"volatile\":null);if(e.immediateValue){const t=e.immediateValue,r=e.type;d()(r instanceof Ke&&r.interfaceInfo.particleMatches(t));const i=t.clone().toLiteral();i.id=n.id,await n.set(i)}else if(\"copy\"===e.fate){const t=this.findStoreById(e.id);let r;r=t instanceof Ei?await t.inflate():t,d()(r,`Cannot find store ${e.id}`),d()(null!==r.version,`Copied store ${e.id} doesn't have version.`),await n.cloneFrom(r),this._tagStore(n,this.findStoreTags(r));const i=this.getStoreDescription(r);i&&this.storeDescriptions.set(n,i)}e.id=n.id,e.fate=\"use\",e.storageKey=n.storageKey;continue}if(this.storesById.has(e.id))continue;let t=e.storageKey;t||(t=this.keyForId(e.id)),d()(t,`couldn't find storage key for handle '${e}'`);const n=e.type.resolvedType();d()(n.isResolved());const r=await this.storageProviderFactory.connect(e.id,n,t);d()(r,`store '${e.id}' was not found`),this._registerStore(r,e.tags)}await Promise.all(n.map(e=>this._instantiateParticle(e))),this.pec.slotComposer&&await this.pec.slotComposer.initializeRecipe(this,n),this.debugHandler.recipeInstantiated({particles:n,activeRecipe:this.activeRecipe.toString()})}async createStore(e,t,n,r,i){d()(e instanceof Le,`can't createStore with type ${e} that isn't a Type`),e instanceof Ve&&(e=new qe(e)),null==n&&(n=this.generateID().toString()),null==i&&this.storageKey&&(i=this.storageProviderFactory.parseStringAsKey(this.storageKey).childKeyForHandle(n).toString());(null==i||(e=>e&&e.includes(\"volatile\"))(r))&&(i=\"volatile\");const s=await this.storageProviderFactory.construct(n,e,i);return d()(s,`failed to create store with id [${n}]`),s.name=t,this._registerStore(s,r),s}_registerStore(e,t){d()(!this.storesById.has(e.id),`Store already registered '${e.id}'`),t=t||[],t=Array.isArray(t)?t:[t],this.storesById.set(e.id,e),this.storeTags.set(e,new Set(t)),this.storageKeys[e.id]=e.storageKey,e.on(\"change\",()=>this._onDataChange(),this)}_tagStore(e,t){d()(this.storesById.has(e.id)&&this.storeTags.has(e),`Store not registered '${e.id}'`);const n=this.storeTags.get(e);(t=t||new Set).forEach(e=>n.add(e))}_onDataChange(){for(const e of this.dataChangeCallbacks.values())e()}onDataChange(e,t){this.dataChangeCallbacks.set(t,e)}clearDataChange(e){this.dataChangeCallbacks.delete(e)}static _typeToKey(e){const t=e.getContainedType();if(t){const e=this._typeToKey(t);if(e)return`list:${e}`}else{if(e instanceof Ue)return e.entitySchema.name;if(e instanceof Ke)return e.interfaceInfo;if(e instanceof He&&e.isResolved())return $r._typeToKey(e.resolvedType())}return null}findStoresByType(e,t){const n=$r._typeToKey(e);let r=[...this.storesById.values()].filter(t=>{if(n){const e=$r._typeToKey(t.type);if(n===e)return!0}else{if(e instanceof He&&!e.isResolved()&&t.type instanceof Ue)return!0;const n=e.getContainedType();if(n&&n instanceof He&&!n.isResolved()&&e.tag===t.type.tag)return!0}return!1});return t&&t.tags&&t.tags.length>0&&(r=r.filter(e=>0===t.tags.filter(t=>!this.storeTags.get(e).has(t)).length)),r.filter(t=>!!Ht.effectiveType(e,[{type:t.type,direction:t.type instanceof Ke?\"host\":\"inout\"}]))}findStoreById(e){const t=this.storesById.get(e);return null==t?this._context.findStoreById(e):t}findStoreTags(e){return this.storeTags.has(e)?this.storeTags.get(e):new Set(this._context.findStoreTags(e))}getStoreDescription(e){return d()(e,\"Cannot fetch description for nonexistent store\"),this.storeDescriptions.get(e)||e.description}getVersionByStore({includeArc:e=!0,includeContext:t=!1}){const n={};return e&&this.storesById.forEach((e,t)=>n[t]=e.version),t&&this._context.allStores.forEach(e=>n[e.id]=e.version),n}keyForId(e){return this.storageKeys[e]}toContextString(){const e=[];return[...this.storesById.values()].sort(Bt).forEach(t=>{e.push(t.toString([...this.storeTags.get(t)]))}),this._activeRecipe.isEmpty()||e.push(this._activeRecipe.toString()),e.join(\"\\n\")}get apiChannelMappingId(){return this.id.toString()}get idGeneratorForTesting(){return this.idGenerator}}class Pr{constructor(){this.map=new Map,this.nextID=0}getOrCreateCache(e){return this.map.has(e)||this.map.set(e,new Map),this.map.get(e)}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */var jr='\\n  icon {\\n    font-family: \"Material Icons\";\\n    font-size: 24px;\\n    font-style: normal;\\n    -webkit-font-feature-settings: \"liga\";\\n    -webkit-font-smoothing: antialiased;\\n    cursor: pointer;\\n    user-select: none;\\n    flex-shrink: 0;\\n    /* partial FOUC prevention */\\n    display: inline-block;\\n    width: 24px;\\n    height: 24px;\\n    overflow: hidden;\\n  }\\n  icon[hidden] {\\n    /* required because of display rule above,\\n    display rule required for overflow: hidden */\\n    display: none;\\n  }\\n';\n/*\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/const Br=function(e,t,n){n=n||[];for(const r in t){const i=t[r];if(i){const t=e.childNodes[r];n[i.key]=t.nodeType===Node.TEXT_NODE?t.parentElement:t,i.sub&&Br(t,i.sub,n)}}return n},Mr=function(e,t,n){if(zr(e,t,n,\"textContent\",e.textContent))return e.textContent=\"\",!0},Dr=function(e,t,n){if(e.hasAttributes()){let r=!1;for(let i,s=e.attributes,o=s.length-1;o>=0&&(i=s[o]);o--)(Fr(e,t,n,i.name,i.value)||zr(e,t,n,i.name,i.value)||Lr(e,t,n,i.name,i.value))&&(e.removeAttribute(i.name),r=!0);return r}},zr=function(e,t,n,r,i){if(\"{{\"===i.slice(0,2)){\"class\"===r&&(r=\"className\");let e=i.slice(2,-2);const s=e.split(\":\");return 2===s.length&&(r=s[0],e=s[1]),Ur(n,t,\"mustaches\",r,e),\"$\"===e[0]&&Ur(n,\"xlate\",e,!0),!0}},Fr=function(e,t,n,r,i){if(\"on-\"===r.slice(0,3))return\"{{\"===i.slice(0,2)&&(i=i.slice(2,-2),console.warn(`Xen: event handler for '${r}' expressed as a mustache, which is not supported. Using literal value '${i}' instead.`)),Ur(n,t,\"events\",r.slice(3),i),!0},Lr=function(e,t,n,r,i){if(\"xen:forward\"===r)return Ur(n,t,\"events\",\"xen:forward\",i),!0},Ur=function(e,t,n,r,i){const s=e[t]||(e[t]=Object.create(null));(s[n]||(s[n]={}))[r]=i},Hr=new class{constructor(e){this.cb=e}annotate(e,t,n){return this.notes=t,this.opts=n||0,this.key=this.opts.key||0,t.locator=this._annotateSubtree(e),t}_annotateSubtree(e){let t;for(let n,r=0,i=e.firstChild,s=null;i;r++){const o=this._annotateNode(i);o&&((t=t||{})[r]=o),(n=s?s.nextSibling:e.firstChild)===i?(s=i,i=i.nextSibling):(i=n,r--)}return t}_annotateNode(e){const t=this.key++,n=this.cb(e,t,this.notes,this.opts),r=this._annotateSubtree(e);if(n||r){const e=Object.create(null);return e.key=t,r&&(e.sub=r),e}}}(function(e,t,n,r){if(r.annotator&&r.annotator(e,t,n,r))return!0;switch(e.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:return;case Node.ELEMENT_NODE:return Dr(e,t,n);case Node.TEXT_NODE:return Mr(e,t,n)}}),qr=function(e,t,n){for(const r in e){const i=t[r],s=e[r]&&e[r].events;if(i&&s)for(const e in s)n(i,e,s[e])}},Wr=function(e,t,n,r){const i=t.slice(-1);if(\"style%\"===t||\"style\"===t||\"xen:style\"===t)\"string\"==typeof n?e.style.cssText=n:Object.assign(e.style,n);else if(\"$\"==i){const r=t.slice(0,-1);\"boolean\"==typeof n||void 0===n?Vr(e,r,Boolean(n)):e.setAttribute(r,n)}else\"textContent\"===t?n&&(n.$template||n.template)?Kr(e,n,r):e.textContent=n||\"\":\"unsafe-html\"===t?e.innerHTML=n||\"\":\"value\"===t?e.value!==n&&(e.value=n):e[t]=n},Vr=function(e,t,n){e[(void 0===n?!e.hasAttribute(t):n)?\"setAttribute\":\"removeAttribute\"](t,\"\")},Kr=function(e,t,n){let{template:r,models:i}=t;if(r)r=Yr(r);else{r=e.getRootNode().querySelector(`template[${t.$template}]`)}Zr(e,n,r,i)},Zr=function(e,t,n,r){let i,s=e.firstElementChild;for(n&&r&&r&&r.forEach((r,o)=>{if(i=s&&s.nextElementSibling,!s){const r=Jr(n).events(t);(s=r.root.firstElementChild)&&(s._subtreeDom=r,e.appendChild(s),!n._shapeWarning&&r.root.firstElementChild&&(n._shapeWarning=!0,console.warn(\"xen-template: subtemplate has multiple root nodes: only the first is used.\",n)))}s&&(s._subtreeDom.set(r),s=i)});s;)i=s.nextElementSibling,s.remove(),s=i},Jr=function(e,t){const n=function(e,t,n){return e._notes||(e._notes=Hr.annotate(e.content,{},t,n))}(e=Yr(e),t),r=document.importNode(e.content,!0),i=r.firstElementChild,s=Br(r,n.locator);return{root:r,notes:n,map:s,firstElement:i,$(e){return this.root.querySelector(e)},set:function(e){return e&&function(e,t,n,r){if(n)for(const i in e){const s=t[i];if(s){s.scope=n;const t=e[i].mustaches;for(const e in t){const i=t[e];i in n&&Wr(s,e,n[i],r)}}}}(n,s,e,this.controller),this},events:function(e){return e&&\"function\"!=typeof e&&(e=function(e,t,n,r){t.addEventListener(n,function(t){if(e[r])return e[r](t,t.detail)})}.bind(this,e)),this.controller=e,e&&qr(n,s,e),this},forward:function(){return qr(n,s,(e,t,n)=>{e.addEventListener(t,r=>{const i={eventName:t,handlerName:n,detail:r.detail,target:r.target};Gr(e,\"xen:forward\",i,{bubbles:!0})})}),this},appendTo:function(e){return this.root?e.appendChild(this.root):console.warn(\"Xen: cannot appendTo, template stamped no DOM\"),this.root=e,this}}},Gr=(e,t,n,r)=>{const i=r||{};i.detail=n;const s=new CustomEvent(t,i);return e.dispatchEvent(s),s.detail},Yr=e=>\"string\"==typeof e?Xr(e):e,Xr=e=>Object.assign(document.createElement(\"template\"),{innerHTML:e}),Qr={createTemplate:Xr,setBoolAttribute:Vr,stamp:Jr};\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass ei{constructor(e,t=null){this.slotConsumers=[],this.id=e,this.sourceSlotConsumer=t}addSlotConsumer(e){this.slotConsumers.push(e),e.slotContext=this}clearSlotConsumers(){this.slotConsumers.forEach(e=>e.slotContext=null),this.slotConsumers.length=0}}class ti extends ei{constructor(e,t,n){super(e,t),this._containerAvailable=!1,d()(t),this.storeId=n,t.addHostedSlotContexts(this)}onRenderSlot(e,t,n){this.sourceSlotConsumer.arc.pec.innerArcRender(this.sourceSlotConsumer.consumeConn.particle,this.sourceSlotConsumer.consumeConn.name,this.id,e.formatHostedContent(t))}addSlotConsumer(e){super.addSlotConsumer(e),this.containerAvailable&&e.startRender()}get containerAvailable(){return this._containerAvailable}set containerAvailable(e){if(this._containerAvailable!==e){this._containerAvailable=e;for(const t of this.slotConsumers)e?t.startRender():t.stopRender()}}}class ni extends ei{constructor(e,t,n,r,i,s=null){super(e,s),this.tags=[],d()(Boolean(r)!==Boolean(i),\"Exactly one of either container or slotSpec may be set\"),d()(Boolean(i)==Boolean(i),\"Spec and source slot can only be set together\"),this.name=t,this.tags=n||[],this._container=r,this.spec=i||new rt({name:t}),this.sourceSlotConsumer&&this.sourceSlotConsumer.directlyProvidedSlotContexts.push(this),this.handles=this.spec&&this.sourceSlotConsumer?this.spec.handles.map(e=>this.sourceSlotConsumer.consumeConn.particle.connections[e].handle).filter(e=>void 0!==e):[]}onRenderSlot(e,t,n){e.setContent(t,n)}get container(){return this._container}get containerAvailable(){return Boolean(this._container)}static createContextForContainer(e,t,n,r){return new ni(e,t,r,n,null)}isSameContainer(e){return this.spec.isSet?Boolean(this.container)===Boolean(e)&&(!this.container||Object.keys(this.container).length===Object.keys(e).length&&Object.keys(this.container).every(t=>Object.keys(e).some(e=>e===t))&&Object.values(this.container).every(t=>Object.values(e).some(e=>e===t))):!e&&!this.container||this.container===e}set container(e){if(this.isSameContainer(e))return;const t=this.container;this._container=e,this.slotConsumers.forEach(e=>e.onContainerUpdate(this.container,t))}addSlotConsumer(e){super.addSlotConsumer(e),this.container&&e.onContainerUpdate(this.container,null)}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class ri{constructor(e,t,n){this.directlyProvidedSlotContexts=[],this.hostedSlotContexts=[],this._renderingBySubId=new Map,this.innerContainerBySlotId={},this.arc=e,this.consumeConn=t,this.containerKind=n}getRendering(e){return this._renderingBySubId.get(e)}get renderings(){return[...this._renderingBySubId.entries()]}addRenderingBySubId(e,t){this._renderingBySubId.set(e,t)}addHostedSlotContexts(e){e.containerAvailable=Boolean(this.slotContext.containerAvailable),this.hostedSlotContexts.push(e)}get allProvidedSlotContexts(){return[...this.generateProvidedContexts()]}findProvidedContext(e){return this.generateProvidedContexts(e).next().value}*generateProvidedContexts(e=(e=>!0)){for(const t of this.directlyProvidedSlotContexts)e(t)&&(yield t);for(const t of this.hostedSlotContexts)for(const n of t.slotConsumers)yield*n.generateProvidedContexts(e)}onContainerUpdate(e,t){d()(this.slotContext instanceof ni,\"Container can only be updated in non-hosted context\");const n=this.slotContext;if(Boolean(e)!==Boolean(t)&&(e?this.startRender():this.stopRender()),this.hostedSlotContexts.forEach(t=>t.containerAvailable=Boolean(e)),e!==t){const e=new Map;n&&n.spec.isSet?Object.keys(n.container||{}).forEach(t=>e.set(t,n.container[t])):e.set(void 0,n.container);for(const[t,n]of e){this._renderingBySubId.has(t)||this._renderingBySubId.set(t,{});const e=this.getRendering(t);e.container&&this.isSameContainer(e.container,n)||(e.container&&this.clearContainer(e),e.container=this.createNewContainer(n,t))}for(const[t,n]of this.renderings)e.has(t)||(this.deleteContainer(n.container),this._renderingBySubId.delete(t))}}createProvidedContexts(){return this.consumeConn.getSlotSpec().provideSlotConnections.map(e=>new ni(this.consumeConn.providedSlots[e.name].id,e.name,[],null,e,this))}updateProvidedContexts(){this.allProvidedSlotContexts.forEach(e=>{e.container=e.sourceSlotConsumer.getInnerContainer(e.id)})}startRender(){if(this.consumeConn&&this.startRenderCallback){const e=new Map(this.allProvidedSlotContexts.map(e=>[e.name,e.id]));this.startRenderCallback({particle:this.consumeConn.particle,slotName:this.consumeConn.name,providedSlots:e,contentTypes:this.constructRenderRequest()})}}stopRender(){this.consumeConn&&this.stopRenderCallback&&this.stopRenderCallback({particle:this.consumeConn.particle,slotName:this.consumeConn.name})}setContent(e,t){e&&Object.keys(e).length>0&&this.description&&(e.descriptions=this._populateHandleDescriptions()),this.eventHandler=t;for(const[t,n]of this.renderings)this.setContainerContent(n,this.formatContent(e,t),t)}_populateHandleDescriptions(){if(!this.consumeConn)return null;const e=new Map;return Object.values(this.consumeConn.particle.connections).map(t=>{t.handle&&(e[`${t.name}.description`]=this.description.getHandleDescription(t.handle).toString())}),e}getInnerContainer(e){return this.innerContainerBySlotId[e]}_initInnerSlotContainer(e,t,n){t?(this.innerContainerBySlotId[e]||(this.innerContainerBySlotId[e]={}),d()(!this.innerContainerBySlotId[e][t],`Multiple ${e}:${t} inner slots cannot be provided`),this.innerContainerBySlotId[e][t]=n):this.innerContainerBySlotId[e]=n}_clearInnerSlotContainers(e){e.forEach(e=>{e?Object.values(this.innerContainerBySlotId).forEach(t=>delete t[e]):this.innerContainerBySlotId={}})}isSameContainer(e,t){return!e&&!t||e===t}constructRenderRequest(){return[]}dispose(){}createNewContainer(e,t){return null}deleteContainer(e){}clearContainer(e){}setContainerContent(e,t,n){}formatContent(e,t){return null}formatHostedContent(e){return null}static clear(e){}static findRootContainers(e){return{}}}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */const ii=()=>ui.getRuntime().getCacheService().getOrCreateCache(\"templateByName\");let si;class oi extends ri{constructor(e,t,n){super(e,t,n),this._observer=this._initMutationObserver()}constructRenderRequest(){const e=[\"model\"],t=[this.templatePrefix];return oi.hasTemplate(t.join(\"::\"))||e.push(\"template\"),e}static hasTemplate(e){return[...ii().keys()].find(t=>t.startsWith(e))}isSameContainer(e,t){return e.parentNode===t}createNewContainer(e,t){d()(e,\"contextContainer cannot be null\");const n=document.createElement(this.containerKind||\"div\");return this.consumeConn&&n.setAttribute(\"particle-host\",this.consumeConn.getQualifiedName()),e.appendChild(n),n.attachShadow({mode:\"open\"}),n.shadowRoot}deleteContainer(e){(e=e.host||e).parentNode&&e.parentNode.removeChild(e)}formatContent(e,t){d()(this.slotContext instanceof ni,\"Content formatting can only be done for provided SlotContext\");const n=this.slotContext.spec,r={};if(Object.keys(e).indexOf(\"model\")>=0)if(e.model){let i;if(!(i=n.isSet&&this.consumeConn.getSlotSpec().isSet?this._modelForSetSlotConsumedAsSetSlot(e.model,t):n.isSet&&!this.consumeConn.getSlotSpec().isSet?this._modelForSetSlotConsumedAsSingletonSlot(e.model,t):this._modelForSingletonSlot(e.model,t)))return;r.model={...i,...e.descriptions}}else r.model=void 0;return e.templateName&&(r.templateName=\"string\"==typeof e.templateName?e.templateName:e.templateName[t],e.template&&(r.template=\"string\"==typeof e.template?e.template:e.template[r.templateName])),r}_modelForSingletonSlot(e,t){return d()(!t,\"subId should be absent for a Singleton Slot\"),e}_modelForSetSlotConsumedAsSetSlot(e,t){return d()(e.items&&e.items.every(e=>e.subId),\"model for a Set Slot consumed as a Set Slot needs to have items array, with every element having subId\"),e.items.find(e=>e.subId===t)}_modelForSetSlotConsumedAsSingletonSlot(e,t){return d()(e.subId,\"model for a Set Slot consumed as a Singleton Slot needs to have subId\"),t===e.subId?e:null}setContainerContent(e,t,n){if(e.container){if(!t||0===Object.keys(t).length)return this.clearContainer(e),void(e.model=null);this._setTemplate(e,this.templatePrefix,t.templateName,t.template),e.model=t.model,this._onUpdate(e)}}clearContainer(e){e.liveDom&&(e.liveDom.root.textContent=\"\"),e.liveDom=null}dispose(){this._observer&&this._observer.disconnect(),this.renderings.forEach(([e,{container:t}])=>this.deleteContainer(t))}static clear(e){e.textContent=\"\"}static clearCache(){ii().clear()}static findRootContainers(e){const t={};return Array.from(e.querySelectorAll(\"[slotid]\")).forEach(e=>{const n=e.getAttribute(\"slotid\");d()(!t[n],`Duplicate root slot ${n}`),t[n]=e}),t}createTemplateElement(e){return Object.assign(document.createElement(\"template\"),{innerHTML:e})}get templatePrefix(){return this.consumeConn.getQualifiedName()}_setTemplate(e,t,n,r){n&&(e.templateName=[t,n].filter(e=>e).join(\"::\"),r&&(ii().has(e.templateName)&&this.clearContainer(e),ii().set(e.templateName,this.createTemplateElement(r))))}_onUpdate(e){if(this._observe(e.container),e.templateName){const t=ii().get(e.templateName);d()(t,`No template for ${e.templateName}`),this._stampTemplate(e,t)}this._updateModel(e)}_observe(e){d()(e,\"Cannot observe without a container\"),this._observer&&this._observer.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[\"subid\"]})}_stampTemplate(e,t){if(!e.liveDom){si||(si=Qr.createTemplate(`<style>${jr}</style>`)),Qr.stamp(si).appendTo(e.container);const n=this._eventMapper.bind(this,this.eventHandler);e.liveDom=Qr.stamp(t).events(n).appendTo(e.container)}}_eventMapper(e,t,n,r){t.addEventListener(n,i=>{i.stopPropagation(),\"xen:forward\"===n&&(t=i.detail.target,r=i.detail.handlerName);const{altKey:s,ctrlKey:o,metaKey:a,shiftKey:l,code:c,key:h,repeat:u}=i,d={key:t.key,value:t.value,keys:{altKey:s,ctrlKey:o,metaKey:a,shiftKey:l,code:c,key:h,repeat:u}};e({detail:d,handler:r,data:d})})}_updateModel(e){e.liveDom&&e.liveDom.set(e.model)}initInnerContainers(e){Array.from(e.querySelectorAll(\"[slotid]\")).forEach(t=>{if(!this.isDirectInnerSlot(e,t))return;const n=this.getNodeValue(t,\"slotid\"),r=this.findProvidedContext(e=>e.id===n);if(!r)return void console.warn(`Slot ${this.consumeConn.getSlotSpec().name} has unexpected inner slot ${n}`);const i=this.getNodeValue(t,\"subid\");d()(Boolean(i)===r.spec.isSet,`Sub-id ${i} for slot ${r.name} doesn't match set spec: ${r.spec.isSet}`),r.sourceSlotConsumer._initInnerSlotContainer(n,i,t)})}getNodeValue(e,t){return e[t]||e.getAttribute(t)}isDirectInnerSlot(e,t){if(t===e)return!0;const n=e=>e.parentNode;let r=n(t);for(;r;){if(r===e)return!0;if(r.getAttribute&&r.getAttribute(\"slotid\"))return!1;r=n(r)}return!1}_initMutationObserver(){return this.consumeConn?new MutationObserver(async e=>{this._observer.disconnect();const t=new Map;for(const[n,{container:r}]of this.renderings)e.some(e=>this.isDirectInnerSlot(r,e.target))&&t.set(n,r);const n=[...t.values()];n.length>0&&(this._clearInnerSlotContainers([...t.keys()]),n.forEach(e=>this.initInnerContainers(e)),this.updateProvidedContexts(),n.forEach(e=>this._observe(e)))}):null}formatHostedContent(e){if(e.templateName){if(\"string\"!=typeof e.templateName)throw new Error(\"TODO: Implement this!\");e.templateName=`${this.consumeConn.getQualifiedName()}::${e.templateName}`}return e}}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class ai extends oi{constructor(e,t){super(e,t),this._content={},this.contentAvailable=new Promise(e=>this._contentAvailableResolve=e)}setContent(e,t){super.setContent(e,t),e?(this._content.templateName=e.templateName,e.template&&(this._content.template=e.template),this._content.model=e.model,this._contentAvailableResolve()):this._content={}}createNewContainer(e,t){return e}isSameContainer(e,t){return e===t}getInnerContainer(e){const t=Array.from(this.renderings,([e,{model:t}])=>t)[0],n=this.findProvidedContext(t=>t.id===e);if(n){if(n.spec.isSet&&t&&t.items&&t.items.models){const e={};for(const n of t.items.models)d()(n.id),e[n.id]=n.id;return e}return e}console.warn(`Cannot find provided spec for ${e} in ${this.consumeConn.getQualifiedName()}`)}createTemplateElement(e){return e}static findRootContainers(e){return e}static clear(e){}_onUpdate(e){}_stampTemplate(e){}_initMutationObserver(){return null}_observe(){}}\n/**\n * @license\n * Copyright (c) 2019 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class li{constructor(e,t){this.slotConsumerClass=e,this.descriptionFormatter=t}static createHeadlessHandler(){return new li(ai)}}li.headlessHandler=new li(ai),li.domHandler=new li(oi,class extends sn{constructor(){super(...arguments),this.nextID=0}_isSelectedDescription(e){return super._isSelectedDescription(e)||!!e.template&&!!e.model}_combineSelectedDescriptions(e,t){const n=new Map;for(const r of e){if(this.seenParticles.has(r._particle))continue;let{template:e,model:i}=this._retrieveTemplateAndModel(r,n.size,t||{});Object.keys(i).map(t=>this._initSubTokens(i[t],r).map(n=>{const r=this.tokenToString(n);if(null==r)return!1;if(r&&r.template&&r.model)e=e.replace(`{{${t}}}`,r.template),delete i[t],i={...i,...r.model};else{const n=`${t}${++this.nextID}`;e=e.replace(`{{${t}}}`,`{{${n}}}`),delete i[t],i[n]=r}return!0}).every(e=>!!e)).every(e=>!!e)&&n.set(r,{template:e,model:i})}const r=[];if(e.forEach(e=>{n.has(e)&&r.push(n.get(e))}),r.length>0){const e=this._joinDescriptions(r);return t&&t.skipFormatting||(e.template+=\".\"),e}}_retrieveTemplateAndModel(e,t,n){if(e._template_&&e._model_)return{template:e._template_,model:JSON.parse(e._model_)};d()(e.pattern,\"Description must contain template and model, or pattern\");let r=\"\";const i={};return this._initTokens(e.pattern,e).forEach((e,s)=>{if(e.text)r=r.concat(`${0!==t||0!==s||n.skipFormatting?e.text:e.text[0].toUpperCase()+e.text.slice(1)}`);else{const t=e.fullName.replace(/[.{}_$]/g,\"\");let o=\"\";0!==s||n.skipFormatting||(r=r.concat(\"<style>\\n            [firstletter]::first-letter { text-transform: capitalize; }\\n            [firstletter] {display: inline-block}\\n            </style>\"),o=\" firstletter\"),r=r.concat(`<span${o}>{{${t}}}</span>`),i[t]=e.fullName}}),{template:r,model:i}}_capitalizeAndPunctuate(e){if(\"string\"==typeof e)return{template:super._capitalizeAndPunctuate(e),model:{}};const t=e.template.match(/<[a-zA-Z0-9]+>{{([a-zA-Z0-9]*)}}<\\/[a-zA-Z0-9]+>/);if(t&&t.length>1&&e.model[t[1]]){const n=e.model[t[1]];n.length>0&&(e.model[t[1]]=`${n[0].toUpperCase()}${n.substr(1)}`)}return e.template+=\".\",e}_joinDescriptions(e){if(e.every(e=>\"string\"==typeof e))return super._joinDescriptions(e);const t={template:\"\",model:{}},n=e.length;return e.forEach((e,r)=>{let i;\"string\"==typeof e&&(e={template:e,model:{}}),t.template+=e.template,t.model={...t.model,...e.model},r<n-2?i=\", \":r===n-2&&(i=[\"\",\"\",\" and \",\", and \"][Math.min(3,n)]),i&&(t.template+=i)}),t}_joinTokens(e){if(e.every(e=>\"string\"==typeof e))return super._joinTokens(e);const t=(e=e.map(e=>\"object\"!=typeof e?{template:`<span>{{text${++this.nextID}}}</span>`,model:{[`text${this.nextID}`]:e}}:e)).filter(e=>e&&!!e.template&&!!e.model);return{template:t.map(e=>e.template).join(\"\"),model:t.map(e=>e.model).reduce((e,t)=>({...e,...t}),{})}}_combineDescriptionAndValue(e,t,n){if(t.template&&t.model)return{template:`${t.template} (${n.template})`,model:{...t.model,...n.model}};const r=`${e.handleName}Description${++this.nextID}`;return{template:`<span>{{${r}}}</span> (${n.template})`,model:{[r]:t,...n.model}}}_formatEntityProperty(e,t,n){const r=`${e}${t.join(\"\")}Value${++this.nextID}`;return{template:`<b>{{${r}}}</b>`,model:{[`${r}`]:n}}}_formatCollection(e,t){const n=`${e}${++this.nextID}`;return t[0].rawData.name?t.length>2?{template:`<b>{{${n}FirstName}}</b> plus <b>{{${n}OtherCount}}</b> other items`,model:{[`${n}FirstName`]:t[0].rawData.name,[`${n}OtherCount`]:t.length-1}}:{template:t.map((e,t)=>`<b>{{${n}${t}}}</b>`).join(\", \"),model:Object.assign({},...t.map((e,t)=>({[`${n}${t}`]:e.rawData.name})))}:{template:`<b>{{${n}Length}}</b> items`,model:{[`${n}Length`]:t.length}}}_formatBigCollection(e,t){return{template:`collection of items like {{${e}FirstName}}`,model:{[`${e}FirstName`]:t.rawData.name}}}_formatSingleton(e,t){const n=super._formatSingleton(e,t);if(n)return{template:`<b>{{${e}Var}}</b>`,model:{[`${e}Var`]:n}}}});\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nclass ci{constructor(e){if(this._consumers=[],this._contexts=[],d()(e.modalityHandler,`Missing or invalid modality handler: ${e.modalityHandler}`),e.rootContainer=e.rootContainer||e.rootContext||(e.containers||Object).root,d()(void 0!==e.rootContainer!=(!0===e.noRoot),\"Root container is mandatory unless it is explicitly skipped\"),this._containerKind=e.containerKind,e.modalityName&&(this.modality=pe.create([e.modalityName])),this.modalityHandler=e.modalityHandler,e.noRoot)return;const t=e.containers||this.modalityHandler.slotConsumerClass.findRootContainers(e.rootContainer)||{};0===Object.keys(t).length&&(t.root=e.rootContainer),Object.keys(t).forEach(e=>{this._contexts.push(ni.createContextForContainer(`rootslotid-${e}`,e,t[e],[`${e}`]))})}get consumers(){return this._consumers}get containerKind(){return this._containerKind}getSlotConsumer(e,t){return this.consumers.find(n=>n.consumeConn.particle===e&&n.consumeConn.name===t)}findContainerByName(e){const t=this.findContextsByName(e);if(0===t.length)console.warn(`No containers for '${e}'`);else if(1===t.length)return t[0].container;console.warn(`Ambiguous containers for '${e}'`)}findContextsByName(e){return this._contexts.filter(e=>e instanceof ni).filter(t=>t.name===e)}findContextById(e){return this._contexts.find(({id:t})=>t===e)}createHostedSlot(e,t,n,r){const i=this.getSlotConsumer(t,n);d()(i,`Transformation particle ${t.name} with consumed ${n} not found`);const s=e.generateID().toString();return this._contexts.push(new ti(s,i,r)),s}_addSlotConsumer(e){e.startRenderCallback=e.arc.pec.startRender.bind(e.arc.pec),e.stopRenderCallback=e.arc.pec.stopRender.bind(e.arc.pec),this._consumers.push(e)}async initializeRecipe(e,t){const n=[];t.forEach(t=>{Object.values(t.consumedSlotConnections).forEach(r=>{if(!r.targetSlot)return void d()(!r.getSlotSpec().isRequired,`No target slot for particle's ${t.name} required consumed slot: ${r.name}.`);const i=new this.modalityHandler.slotConsumerClass(e,r,this._containerKind),s=i.createProvidedContexts();this._contexts=this._contexts.concat(s),n.push(i)})}),n.forEach(e=>{this._addSlotConsumer(e);const t=this.findContextById(e.consumeConn.targetSlot.id);d()(t,`No context found for ${e.consumeConn.getQualifiedName()}`),t.addSlotConsumer(e)});const r=this.consumers.map(e=>e.arc),i=[...new Set(r).values()],s=await Promise.all(i.map(e=>on.create(e))),o=new Map(s.map((e,t)=>[i[t],e]));for(const e of this.consumers)e.description=o.get(e.arc)}renderSlot(e,t,n){const r=this.getSlotConsumer(e,t);d()(r,`Cannot find slot (or hosted slot) ${t} for particle ${e.name}`),r.slotContext.onRenderSlot(r,n,async n=>{if(r.arc.pec.sendEvent(e,t,n),n.data&&n.data.key)for(const e of r.hostedSlotContexts)if(e.storeId)for(const t of e.slotConsumers){const r=t.arc.findStoreById(e.storeId);d()(r),r.get().then(e=>{e&&e.id===n.data.key&&t.arc.pec.sendEvent(t.consumeConn.particle,t.consumeConn.name,n)})}})}getAvailableContexts(){return this._contexts}dispose(){this.consumers.forEach(e=>e.dispose()),this._contexts.forEach(e=>{e.clearSlotConsumers(),e instanceof ni&&e.container&&this.modalityHandler.slotConsumerClass.clear(e.container)}),this._contexts=this._contexts.filter(e=>!e.sourceSlotConsumer),this._consumers.length=0}}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class hi extends ci{constructor(e={}){void 0===e.modalityHandler&&(e.modalityHandler=li.createHeadlessHandler()),super({rootContainer:{root:\"root-context\"},...e})}renderSlot(e,t,n){super.renderSlot(e,t,n);const r=this.getSlotConsumer(e,t);r&&r.updateProvidedContexts()}get contexts(){return this._contexts}}\n/**\n * @license\n * Copyright (c) 2018 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class ui{static getRuntime(){return null==di&&(di=new ui),di}static clearRuntimeForTesting(){null!==di&&(di.destroy(),di=null)}static newForNodeTesting(e){return new ui(new Ct,hi,e)}constructor(e,t,n){this.cacheService=new Pr,this.loader=e,this.composerClass=t,this.context=n||new Ii({id:\"manifest:default\"})}getCacheService(){return this.cacheService}destroy(){}newArc(e,t,n){const r=lt.newSession().newArcId(e),i=t+r.toString();return new $r({id:r,storageKey:i,loader:this.loader,slotComposer:new this.composerClass,context:this.context,...n})}static async getArcDescription(e){return(await on.create(e)).getArcDescription()}static async parseManifest(e,t){return Ii.parse(e,t)}static async loadManifest(e,t,n){return Ii.load(e,t,n)}}let di=null;class fi extends en{constructor(e){super();let t=e.split(\"://\");this.protocol=t[0],d()(\"volatile\"===this.protocol,`can't construct volatile key for protocol ${this.protocol} (input key ${e})`),t=t[1]?t.slice(1).join(\"://\").split(\"^^\"):[],this.arcId=t[0],this.location=t[1],d()(this.toString()===e,`Expected ${e}, but got ${this.toString()} volatile key base.`)}base(){return\"volatile\"}get arcId(){return this._arcId}set arcId(e){this._arcId=e}childKeyForHandle(e){return new fi(\"volatile\")}childKeyForArcInfo(){return new fi(`${this.protocol}://${this.arcId}^^arc-info`)}childKeyForSuggestions(e,t){return new fi(`${this.protocol}://${this.arcId}^^${e}/suggestions/${t}`)}childKeyForSearch(e){return new fi(`${this.protocol}://${this.arcId}^^${e}/search`)}toString(){return void 0!==this.location&&void 0!==this.arcId?`${this.protocol}://${this.arcId}^^${this.location}`:void 0!==this.arcId?`${this.protocol}://${this.arcId}`:`${this.protocol}`}}const pi=()=>ui.getRuntime().getCacheService().getOrCreateCache(\"volatileStorageCache\");class mi extends rn{constructor(){super(...arguments),this.backingStore=null,this.pendingBackingStore=null}static newProvider(e,t,n,r,i){return e instanceof qe?new gi(e,t,n,r,i):e instanceof We?new vi(e,t,n,r,i):new yi(e,t,n,r,i)}async ensureBackingStore(){if(this.backingStore)return this.backingStore;if(!this.pendingBackingStore){const e=this.storageEngine.baseStorageKey(this.backingType());this.pendingBackingStore=this.storageEngine.baseStorageFor(this.backingType(),e),this.pendingBackingStore.then(e=>this.backingStore=e)}return this.pendingBackingStore}}class gi extends mi{constructor(e,t,n,r,i){super(e,n,r,i),this._model=new Qt,this.storageEngine=t,d()(null!==this.version)}backingType(){return this.type.getContainedType()}clone(){const e=new gi(this.type,this.storageEngine,this.name,this.id,null);return e.cloneFrom(this),e}async cloneFrom(e){this.referenceMode=e.referenceMode;const t=await e.toLiteral();if(this.referenceMode&&t.model.length>0){await Promise.all([this.ensureBackingStore(),e.ensureBackingStore()]),t.model=t.model.map(({id:e,value:t})=>({id:e,value:{id:t.id,storageKey:this.backingStore.storageKey}}));const n=await e.backingStore.getMultiple(t.model.map(({id:e})=>e));await this.backingStore.storeMultiple(n,[this.storageKey])}this.fromLiteral(t)}async modelForSynchronization(){const e=await this._toList();return{version:this.version,model:e}}async toLiteral(){return{version:this.version,model:this._model.toLiteral()}}fromLiteral({version:e,model:t}){this.version=e,this._model=new Qt(t)}async _toList(){if(this.referenceMode){const e=(await this.toLiteral()).model;if(0===e.length)return[];const t=new Set;e.forEach(e=>t.add(e.value.storageKey)),d()(1===t.size,\"multiple storageKeys in reference set of collection not yet supported.\");t.values().next().value;await this.ensureBackingStore();const n=e.map(e=>e.value.id),r=await this.backingStore.getMultiple(n),i=[];for(let t=0;t<r.length;t++)i.push({id:n[t],value:r[t],keys:e[t].keys});return i}return(await this.toLiteral()).model}async toList(){return(await this._toList()).map(e=>e.value)}async getMultiple(e){return d()(!this.referenceMode,\"getMultiple not implemented for referenceMode stores\"),e.map(e=>this._model.getValue(e))}async storeMultiple(e,t,n=null){d()(!this.referenceMode,\"storeMultiple not implemented for referenceMode stores\"),e.map(e=>this._model.add(e.id,e,t)),this.version++}async get(e){if(this.referenceMode){const t=this._model.getValue(e);return null==t?null:(await this.ensureBackingStore(),await this.backingStore.get(t.id))}return this._model.getValue(e)}traceInfo(){return{items:this._model.size}}async store(e,t,n=null){d()(null!=t&&t.length>0,\"keys required\");const r={value:e,keys:t,effective:void 0};if(this.referenceMode){const n=this.type.getContainedType(),i=this.backingStore?this.backingStore.storageKey:this.storageEngine.baseStorageKey(n);r.effective=this._model.add(e.id,{id:e.id,storageKey:i},t),await this.ensureBackingStore(),await this.backingStore.store(e,t)}else r.effective=this._model.add(e.id,e,t);this.version++,await this._fire(\"change\",new nn({add:[r],version:this.version,originatorId:n}))}async removeMultiple(e,t=null){0===e.length&&(e=this._model.toList().map(e=>({id:e.id,keys:[]}))),e.forEach(e=>{0===e.keys.length&&(e.keys=this._model.getKeys(e.id)),e.value=this._model.getValue(e.id),null!==e.value&&(e.effective=this._model.remove(e.id,e.keys))}),this.version++,this._fire(\"change\",new nn({remove:e,version:this.version,originatorId:t}))}async remove(e,t=[],n=null){0===t.length&&(t=this._model.getKeys(e));const r=this._model.getValue(e);if(null!==r){const i=this._model.remove(e,t);this.version++,await this._fire(\"change\",new nn({remove:[{value:r,keys:t,effective:i}],version:this.version,originatorId:n}))}}clearItemsForTesting(){this._model=new Qt}}class yi extends mi{constructor(e,t,n,r,i){super(e,n,r,i),this.localKeyId=0,this.storageEngine=t,this._stored=null,this.backingStore=null}backingType(){return this.type}clone(){const e=new yi(this.type,this.storageEngine,this.name,this.id,null);return e.cloneFrom(this),e}async cloneFrom(e){this.referenceMode=e.referenceMode,e.referenceMode&&e.localModified&&await e._persistChanges();const t=await e.toLiteral();if(this.referenceMode&&t.model.length>0){await Promise.all([this.ensureBackingStore(),e.ensureBackingStore()]),t.model=t.model.map(({id:e,value:t})=>({id:e,value:{id:t.id,storageKey:this.backingStore.storageKey}}));const n=await e.backingStore.getMultiple(t.model.map(({id:e})=>e));await this.backingStore.storeMultiple(n,[this.storageKey])}await this.fromLiteral(t)}async modelForSynchronization(){if(this.referenceMode&&null!==this._stored){const e=this._stored;await this.ensureBackingStore();const t=await this.backingStore.get(e.id);return{version:this.version,model:[{id:e.id,value:t}]}}return super.modelForSynchronization()}async toLiteral(){const e=this._stored,t=null!=e?[{id:e.id,value:e,keys:[]}]:[];return{version:this.version,model:t}}fromLiteral({version:e,model:t}){const n=0===t.length?null:t[0].value;this.referenceMode&&n&&n.rawData&&d()(!1,`shouldn't have rawData ${JSON.stringify(n.rawData)} here`),d()(void 0!==n),this._stored=n,this.version=e}traceInfo(){return{stored:null!==this._stored}}async get(){if(this.referenceMode&&this._stored){const e=this._stored;return await this.ensureBackingStore(),await this.backingStore.get(e.id)}return this._stored}async set(e,t=null,n=null){if(d()(void 0!==e),this.referenceMode&&e){const t=this.type,n=this.backingStore?this.backingStore.storageKey:this.storageEngine.baseStorageKey(t);this._stored={id:e.id,storageKey:n},await this.ensureBackingStore(),await this.backingStore.store(e,[this.storageKey+this.localKeyId++])}else{if(JSON.stringify(this._stored)===JSON.stringify(e)&&null==n)return;this._stored=e}this.version++;const r=this.referenceMode?e:this._stored;await this._fire(\"change\",new nn({data:r,version:this.version,originatorId:t,barrier:n}))}async clear(e=null,t=null){await this.set(null,e,t)}}class _i{constructor(e,t,n,r){this.version=e,this.pageSize=n;const i=[...t];i.sort((e,t)=>e.index-t.index),this.data=i.map(e=>e.value),r||this.data.reverse()}async next(){return 0===this.data.length?{done:!0}:{value:this.data.splice(0,this.pageSize),done:!1}}close(){this.data=[]}}class vi extends mi{constructor(e,t,n,r,i){super(e,n,r,i),this.items=new Map,this.cursors=new Map,this.cursorIndex=0}enableReferenceMode(){d()(!1,\"referenceMode is not supported for BigCollection\")}backingType(){return this.type.getContainedType()}async get(e){const t=this.items.get(e);return void 0!==t?t.value:null}async store(e,t,n){d()(null!=t&&t.length>0,\"keys required\"),this.version++,this.items.has(e.id)||this.items.set(e.id,{index:null,value:null,keys:{}});const r=this.items.get(e.id);r.index=this.version,r.value=e,t.forEach(e=>r.keys[e]=this.version)}async remove(e,t,n){this.version++,this.items.delete(e)}async stream(e,t=!0){d()(!isNaN(e)&&e>0),this.cursorIndex++;const n=new _i(this.version,this.items.values(),e,t);return this.cursors.set(this.cursorIndex,n),this.cursorIndex}async cursorNext(e){const t=this.cursors.get(e);if(!t)return{done:!0};const n=await t.next();return n.done&&this.cursors.delete(e),n}async cursorClose(e){const t=this.cursors.get(e);t&&(this.cursors.delete(e),t.close())}cursorVersion(e){const t=this.cursors.get(e);return t?t.version:null}async cloneFrom(e){e.items&&this.fromLiteral(e.toLiteral())}async toLiteral(){const e=[];for(const[t,{index:n,value:r,keys:i}]of this.items.entries())e.push({id:t,index:n,value:r,keys:Object.keys(i)});return{version:this.version,model:e}}fromLiteral({version:e,model:t}){this.version=e,this.items.clear();for(const{id:e,index:n,value:r,keys:i}of t){const t={};for(const e of i)t[e]=n;this.items.set(e,{index:n,value:r,keys:t})}}clearItemsForTesting(){this.items.clear()}}\n// @license\n// @license\nvar bi,wi;!function(e){e[e.arc=1]=\"arc\"}(bi||(bi={})),function(e){e[e.handles=1]=\"handles\"}(wi||(wi={}));class Si extends en{constructor(e,t){super();const n=e.match(/^synthetic:\\/\\/([^\\/]+)\\/([^\\/]+)\\/(.+)$/);if(null===n||4!==n.length)throw new Error(`invalid synthetic key: ${e}`);if(this.scope=bi[n[1]],this.category=wi[n[2]],this.scope!==bi.arc)throw new Error(`invalid scope '${n[1]}' for synthetic key: ${e}`);{this.targetType=new Ge;const e=t.parseStringAsKey(n[3]).childKeyForArcInfo();this.targetKey=e.toString()}if(this.category!==wi.handles)throw new Error(`invalid category '${n[2]}' for synthetic key: ${e}`);this.syntheticType=new Ye}get protocol(){return\"synthetic\"}base(){return d()(!1,\"base not supported for synthetic keys\"),null}get arcId(){return d()(!1,\"arcId not supported for synthetic keys\"),null}childKeyForHandle(e){return d()(!1,\"childKeyForHandle not supported for synthetic keys\"),null}childKeyForArcInfo(){return d()(!1,\"childKeyForArcInfo not supported for synthetic keys\"),null}childKeyForSuggestions(e,t){return d()(!1,\"childKeyForSuggestions not supported for synthetic keys\"),null}childKeyForSearch(e){return d()(!1,\"childKeyForSearch not supported for synthetic keys\"),null}toString(){return`${this.protocol}://${bi[this.scope]}/${wi[this.category]}/${this.targetKey}`}}class ki extends rn{constructor(e,t,n,r,i){let s;super(e,void 0,t,n),this.model=[],this.backingStore=void 0,this.targetStore=r,this.storageFactory=i,this.initialized=new Promise(e=>s=e);const o=async e=>{await this.process(e,!1),s(),r.on(\"change\",e=>this.process(e.data,!0),this)};r.get().then(e=>o(e))}async process(e,t){let n;try{if(e){const t=await Ii.parse(De.extractSerialization(e),{});n=t.activeRecipe&&t.activeRecipe.handles}}catch(e){console.warn(`Error parsing manifest at ${this.storageKey}:\\n${e.message}`)}const r=this.model;this.model=[];for(const e of n||[])this.storageFactory.isPersistent(e.storageKey)&&this.model.push(new ze(e.id,e.storageKey,e.mappedType,e.tags));if(t){const e=function(e,t,n){const r={add:[],remove:[]},i=new Map,s=new Map,o=new Map;for(const t of e){const e=n(t);i.set(e,t),s.set(e,t)}for(const e of t){const t=n(e);i.set(t,e),o.set(t,e)}for(const[e,t]of i)if(s.has(e)){if(o.has(e))continue;r.remove.push(t)}else d()(o.has(e)),r.add.push(t);return r}(r,this.model,JSON.stringify),t=e.add.map(e=>({value:e})),n=e.remove.map(e=>({value:e}));this._fire(\"change\",new nn({add:t,remove:n}))}}async toList(){return await this.initialized,this.model}async toLiteral(){throw new Error(\"unimplemented\")}async cloneFrom(){throw new Error(\"cloneFrom should never be called on SyntheticCollection!\")}async ensureBackingStore(){throw new Error(\"ensureBackingStore should never be called on SyntheticCollection!\")}async getMultiple(e){throw new Error(\"unimplemented\")}async storeMultiple(e,t,n){throw new Error(\"unimplemented\")}async removeMultiple(e,t){throw new Error(\"unimplemented\")}async get(e){throw new Error(\"unimplemented\")}remove(e,t,n){throw new Error(\"unimplemented\")}store(e,t,n){throw new Error(\"unimplemented\")}}const Ci={volatile:{storage:class extends tn{constructor(e){super(e),this._memoryMap={},this._typeMap={},this.localIDBase=0,this.typePromiseMap={},pi().set(this.arcId.toString(),this)}async construct(e,t,n){const r=await this._construct(e,t,n);return t instanceof Je||t instanceof We?r:t.isTypeContainer()&&t.getContainedType()instanceof Je?r:(r.enableReferenceMode(),r)}async _construct(e,t,n){const r=new fi(n);void 0===r.arcId&&(r.arcId=this.arcId.toString()),void 0===r.location&&(r.location=\"volatile-\"+this.localIDBase++);const i=mi.newProvider(t,this,void 0,e,r.toString());return void 0!==this._memoryMap[r.toString()]?null:(this._memoryMap[r.toString()]=i,i)}async connect(e,t,n){const r=new fi(n);return r.arcId!==this.arcId.toString()?null==pi().get(r.arcId)?null:pi().get(r.arcId).connect(e,t,n):void 0===this._memoryMap[n]?null:this._memoryMap[n]}baseStorageKey(e){const t=new fi(\"volatile\");return t.arcId=this.arcId.toString(),t.location=\"volatile-\"+e.toString(),t.toString()}async baseStorageFor(e,t){if(this._typeMap[t])return this._typeMap[t];if(this.typePromiseMap[t])return this.typePromiseMap[t];const n=this._construct(e.toString(),e.collectionOf(),t);this.typePromiseMap[t]=n;const r=await n;return d()(r,`could not construct baseStorage for key ${t}`),this._typeMap[t]=r,r}parseStringAsKey(e){const t=new fi(e);return void 0===t.arcId&&(t.arcId=this.arcId.toString()),t}},isPersistent:!1},synthetic:{storage:class extends tn{constructor(e,t){super(e),this.storageFactory=t}async construct(e,t,n){throw new Error(\"cannot construct SyntheticStorage providers; use connect\")}async connect(e,t,n){d()(null===t,\"SyntheticStorage does not accept a type parameter\");const r=new Si(n,this.storageFactory),i=await this.storageFactory.connect(e,r.targetType,r.targetKey);return null===i?null:new ki(r.syntheticType,e,n,i,this.storageFactory)}async baseStorageFor(e,t){throw new Error(\"baseStorageFor not implemented for SyntheticStorage\")}baseStorageKey(e,t){throw new Error(\"baseStorageKey not implemented for SyntheticStorage\")}parseStringAsKey(e){return new Si(e,this.storageFactory)}},isPersistent:!1}};class xi{constructor(e){this.arcId=e,this._storageInstances={},Object.keys(Ci).forEach(t=>{const{storage:n,isPersistent:r}=Ci[t];this._storageInstances[t]={storage:new n(e,this),isPersistent:r}})}static register(e,t){Ci[e]=t}getInstance(e){const t=this._storageInstances[e.split(\":\")[0]];if(!t)throw new Error(`unknown storage protocol: ${e}`);return t}_storageForKey(e){if(!e)throw new Error(\"key is required\");return this.getInstance(e).storage}isPersistent(e){return e&&this.getInstance(e).isPersistent}async construct(e,t,n){return await this._storageForKey(n).construct(e,t,n)}async connect(e,t,n){return await this._storageForKey(n).connect(e,t,n)}async connectOrConstruct(e,t,n){const r=this._storageForKey(n);let i=await r.connect(e,t,n);return null==i&&(i=await r.construct(e,t,n)),i}async baseStorageFor(e,t){return await this._storageForKey(t).baseStorageFor(e,t)}baseStorageKey(e,t){return this._storageForKey(t).baseStorageKey(e,t)}parseStringAsKey(e){return this._storageForKey(e).parseStringAsKey(e)}newKey(e,t){}async shutdown(){for(const e of Object.values(this._storageInstances))await e.storage.shutdown()}}\n/**\n * @license\n * Copyright (c) 2017 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */class Ti extends Error{constructor(e,t){super(t),this.location=e}}class Ei{constructor(e,t,n,r,i,s){this.referenceMode=!1,this.type=e,this.id=t,this.name=n,this.storageKey=r,this.storageProviderFactory=i,this.originalId=s}get version(){}get description(){}async inflate(){const e=await this.storageProviderFactory.connect(this.id,this.type,this.storageKey);return d()(null!=e,\"inflating missing storageKey \"+this.storageKey),e.originalId=this.originalId,e}toLiteral(){}toString(e){const t=[],n=[];return n.push(\"store\"),this.name&&n.push(`${this.name}`),n.push(`of ${this.type.toString()}`),this.id&&n.push(`'${this.id}'`),e&&e.length&&n.push(`${e.join(\" \")}`),t.push(n.join(\" \")),this.description&&t.push(`  description \\`${this.description}\\``),t.join(\"\\n\")}_compareTo(e){let t;return 0!==(t=$t(this.name,e.name))?t:0!==(t=$t(this.id,e.id))?t:0}}class Ai{traverse(e){if([\"string\",\"number\",\"boolean\"].includes(typeof e)||null===e)return;if(e instanceof Array){for(const t of e)this.traverse(t);return}d()(e.location,\"expected manifest node to have `location`\"),d()(e.kind,\"expected manifest node to have `kind`\");let t=!1;const n=()=>{if(!t){t=!0;for(const t of Object.keys(e))[\"location\",\"kind\",\"model\"].includes(t)||this.traverse(e[t])}};this.visit(e,n),n()}visit(e,t){}}const Oi=new Set;class Ii{constructor({id:e}){if(this._recipes=[],this._imports=[],this._particles={},this._schemas={},this._stores=[],this._interfaces=[],this.storeTags=new Map,this._fileName=null,this._idGenerator=lt.newSession(),this._storageProviderFactory=void 0,this._meta=new Rt,this._resources={},this.storeManifestUrls=new Map,this.errors=[],d()(e instanceof ct||\"string\"==typeof e),e instanceof ct)this._id=e;else{const t=e.split(\":\");this._id=ct._newIdInternal(t[0],t.slice(1))}}get id(){return this._meta.name?ct.fromString(this._meta.name):this._id}get storageProviderFactory(){return null==this._storageProviderFactory&&(this._storageProviderFactory=new xi(this.id)),this._storageProviderFactory}get recipes(){return this._recipes}get allRecipes(){return[...new Set(this._findAll(e=>e._recipes))]}get activeRecipe(){return this._recipes.find(e=>\"active\"===e.annotation)}get particles(){return Object.values(this._particles)}get allParticles(){return[...new Set(this._findAll(e=>Object.values(e._particles)))]}get imports(){return this._imports}get schemas(){return this._schemas}get fileName(){return this._fileName}get stores(){return this._stores}get allStores(){return[...this._findAll(e=>e._stores)]}get interfaces(){return this._interfaces}get meta(){return this._meta}get resources(){return this._resources}applyMeta(e){void 0!==this._storageProviderFactory&&d()(e.name===this._meta.name||null==e.name,\"can't change manifest ID after storage is constructed\"),this._meta.apply(e)}async createStore(e,t,n,r,i){const s=await this.storageProviderFactory.construct(n,e,i||`volatile://${this.id}`);return d()(null!==s.version),s.name=t,this.storeManifestUrls.set(s.id,this.fileName),this._addStore(s,r)}_addStore(e,t){return this._stores.push(e),this.storeTags.set(e,t||[]),e}newStorageStub(e,t,n,r,i,s){return this._addStore(new Ei(e,n,t,r,this.storageProviderFactory,s),i)}_find(e){let t=e(this);if(!t)for(const n of this._imports)if(t=n._find(e))break;return t}*_findAll(e){yield*e(this);for(const t of this._imports)yield*t._findAll(e)}findSchemaByName(e){return this._find(t=>t._schemas[e])}findTypeByName(e){const t=this.findSchemaByName(e);if(t)return new Ue(t);const n=this.findInterfaceByName(e);return n?new Ke(n):void 0}findParticleByName(e){return this._find(t=>t._particles[e])}findParticlesByVerb(e){return[...this._findAll(t=>Object.values(t._particles).filter(t=>t.primaryVerb===e))]}findStoreByName(e){return this._find(t=>t._stores.find(t=>t.name===e))}findStoreById(e){return this._find(t=>t._stores.find(t=>t.id===e))}findStoreTags(e){return this._find(t=>t.storeTags.get(e))}findManifestUrlForHandleId(e){return this._find(t=>t.storeManifestUrls.get(e))}findStoresByType(e,t={tags:[],subtype:!1}){const n=t.tags||[],r=t.subtype||!1;return[...this._findAll(t=>t._stores.filter(i=>(function(t){const n=e.resolvedType();if(!n.isResolved())return e instanceof qe==t.type instanceof qe&&e instanceof We==t.type instanceof We;if(r){const[e,r]=Le.unwrapPair(t.type,n);return e instanceof Ue&&r instanceof Ue&&e.entitySchema.isMoreSpecificThan(r.entitySchema)}return Xe.compareTypes({type:t.type},{type:e})})(i)&&function(e,t){return 0===n.filter(n=>!e.storeTags.get(t).includes(n)).length}(t,i)))].filter(t=>!!Ht.effectiveType(e,[{type:t.type,direction:t.type instanceof Ke?\"host\":\"inout\"}]))}findInterfaceByName(e){return this._find(t=>t._interfaces.find(t=>t.name===e))}findRecipesByVerb(e){return[...this._findAll(t=>t._recipes.filter(t=>t.verbs.includes(e)))]}generateID(){return this._idGenerator.newChildId(this.id)}static async load(e,t,n){n=n||{};let{registry:r,id:i}=n;return(r=r||{})&&r[e]?await r[e]:(r[e]=(async()=>{const n=await t.loadResource(e);return d()(void 0!==n,`${e} unable to be loaded by Manifest parser`),await Ii.parse(n,{id:i,fileName:e,loader:t,registry:r})})(),await r[e])}static async parse(e,t){t=t||{};let{session_id:n,fileName:r,loader:i,registry:s,context:o,throwImportErrors:a}=t;s=s||{};const l=`manifest:${r}:`;function c(e){for(const t of e.errors){if(t.key){if(Oi.has(t.key))continue;Oi.add(t.key)}console.warn(h(t).message)}}function h(t,n){if(!(t instanceof Ti||t.location))return t;const i=e.split(\"\\n\")[t.location.start.line-1];let s=t.message||\"\";if(i){let e=1;e=t.location.end.line===t.location.start.line?t.location.end.column-t.location.start.column:i.length-t.location.start.column,e=Math.max(1,e);let o,a=\"\";for(let e=0;e<t.location.start.column-1;e++)a+=\" \";for(let t=0;t<e;t++)a+=\"^\";s=`${o=n?\"Parse error in\":\"Post-parse processing error caused by\"} '${r}' line ${t.location.start.line}.\\n${t.message}\\n  ${i}\\n  ${a}`}const o=new Ti(t.location,s);return n||(o.stack=t.stack),o}let u=[];try{u=Tt(e)}catch(e){throw h(e,!0)}const d=new Ii({id:l});d._fileName=r,o&&d._imports.push(o);try{await Promise.all(u.map(async e=>{if(\"import\"===e.kind){const t=i.path(d.fileName),n=i.join(t,e.path);try{d._imports.push(await Ii.load(n,i,{registry:s}))}catch(t){d.errors.push(t),d.errors.push(new Ti(e.location,`Error importing '${n}'`))}}}));const e=async(e,t)=>{for(const n of u)n.kind===e&&(Ii._augmentAstWithTypes(d,n),await t(n))};await e(\"meta\",e=>d.applyMeta(e.items)),await e(\"resource\",e=>this._processResource(d,e)),await e(\"schema\",e=>this._processSchema(d,e)),await e(\"interface\",e=>this._processInterface(d,e)),await e(\"particle\",e=>this._processParticle(d,e,i)),await e(\"store\",e=>this._processStore(d,e,i)),await e(\"recipe\",e=>this._processRecipe(d,e,i))}catch(e){throw c(d),h(e,!1)}if(c(d),t.throwImportErrors&&d.errors.length>0)throw d.errors[0];return d}static _augmentAstWithTypes(e,t){(new class extends Ai{constructor(){super()}visit(t,n){switch(n(),t.kind){case\"schema-inline\":{const n=[],r=[],i=[];for(const s of t.names){const t=e.resolveTypeName(s);t&&t.schema&&t.schema.isAlias?r.push(t.schema):i.push(s),t&&t.schema&&n.push(t.schema)}const s={};for(let{name:e,type:r}of t.fields){for(const i of n)if(r){const n=i.fields[e];if(n&&!Be.typesEqual(n,r))throw new Ti(t.location,`Type of '${e}' does not match schema (${r} vs ${n})`)}else r=i.fields[e];if(!r)throw new Ti(t.location,`Could not infer type of '${e}' field`);s[e]=r}let o=new Be(i,s);for(const e of r)if(!(o=Be.union(e,o)))throw new Ti(t.location,\"Could not merge schema aliases\");return void(t.model=new Ue(o))}case\"variable-type\":{const e=t.constraint&&t.constraint.model;return void(t.model=He.make(t.name,e,null))}case\"slot-type\":{const e={};for(const n of Object.keys(t.fields)){const r=t.fields[n];e[r.name]=r.value}return void(t.model=Ze.make(e.formFactor,e.handle))}case\"type-name\":{const n=e.resolveTypeName(t.name);if(!n)throw new Ti(t.location,`Could not resolve type reference to type name '${t.name}'`);if(n.schema)t.model=new Ue(n.schema);else{if(!n.iface)throw new Ti(t.location,\"Expected {iface} or {schema}\");t.model=new Ke(n.iface)}return}case\"collection-type\":return void(t.model=new qe(t.type.model));case\"big-collection-type\":return void(t.model=new We(t.type.model));case\"reference-type\":return void(t.model=new Je(t.type.model));default:return}}}).traverse(t)}static _processSchema(e,t){let n;const r={};let i=[...t.names];for(const e of t.items)switch(e.kind){case\"schema-field\":{const t=e;if(r[t.name])throw new Ti(t.location,`Duplicate definition of field '${t.name}'`);r[t.name]=t.type;break}case\"description\":if(n)throw new Ti(e.location,\"Duplicate schema description\");n=e;break;default:throw new Ti(e.location,`unknown parser artifact ${e.kind} while processing schema`)}for(const n of t.parents){const s=e.findSchemaByName(n);if(!s)throw new Ti(t.location,`Could not find parent schema '${n}'`);for(const[e,i]of Object.entries(s.fields))if(r[e]&&!Be.typesEqual(r[e],i))throw new Ti(t.location,`'${n}' defines incompatible type for field '${e}'`);Object.assign(r,s.fields),i.push(...s.names)}i=[i[0],...i.filter(e=>e!==i[0])];const s=t.alias||i[0];if(!s)throw new Ti(t.location,\"Schema defined without name or alias\");const o=new Be(i,r,n);t.alias&&(o.isAlias=!0),e._schemas[s]=o}static _processResource(e,t){e._resources[t.name]=t.data}static _processParticle(e,t,n){if(d()(null==t.implFile||null!==t.args,\"no valid body defined for this particle\"),t.args||(t.args=[]),t.hasParticleArgument){const n=new Ti(t.location,\"Particle uses deprecated argument body\");n.key=\"hasParticleArgument\",e._warnings.push(n)}t.implFile&&n&&(t.implFile=n.join(e.fileName,t.implFile));const r=e=>{for(const t of e)t.type=t.type.model,r(t.dependentConnections)};r(t.args),e._particles[t.name]=new it(t)}static _processInterface(e,t){const n=[];for(const e of t.args){const t={name:void 0,type:void 0,direction:e.direction};\"*\"!==e.name&&(t.name=e.name),e.type&&(t.type=e.type.model),n.push(t)}const r=[];for(const e of t.slots)r.push({direction:e.direction,name:e.name,isRequired:e.isRequired,isSet:e.isSet});const i=new Ce(t.name,n,r);e._interfaces.push(i)}static _processRecipe(e,t,n){const r=e._newRecipe(t.name);t.annotation&&(r.annotation=t.annotation),t.verbs&&(r.verbs=t.verbs),this._buildRecipe(e,r,t.items)}static _buildRecipe(e,t,n){const r={require:n.filter(e=>\"require\"===e.kind),handles:n.filter(e=>\"handle\"===e.kind),byHandle:new Map,requireHandles:n.filter(e=>\"requireHandle\"===e.kind),byRequireHandle:new Map,particles:n.filter(e=>\"particle\"===e.kind),byParticle:new Map,slots:n.filter(e=>\"slot\"===e.kind),bySlot:new Map,byName:new Map,connections:n.filter(e=>\"connection\"===e.kind),search:n.find(e=>\"search\"===e.kind),description:n.find(e=>\"description\"===e.kind)};d()(!(r.handles.length>0&&r.requireHandles.length>0),\"Inconsistent handle definitions\");const i=r.handles.length>0?r.handles:r.requireHandles;for(const n of i){const i=t.newHandle(),s=n.ref;if(s.id){i.id=s.id;const t=e.findStoreById(i.id);t&&i.mapToStorage(t)}else if(s.name){const t=e.findStoreByName(s.name);d()(t,`Could not find handle ${s.name}`),i.mapToStorage(t)}i.tags=s.tags,n.name&&(d()(!r.byName.has(n.name),`duplicate handle name: ${n.name}`),i.localName=n.name,r.byName.set(n.name,{item:n,handle:i})),i.fate=n.fate?n.fate:null,r.byHandle.set(i,n)}const s=(t,n)=>{switch(n.targetType){case\"particle\":{const r=e.findParticleByName(n.particle);if(!r)throw new Ti(t.location,`could not find particle '${n.particle}'`);if(null!==n.param&&!r.handleConnectionMap.has(n.param))throw new Ti(t.location,`param '${n.param}' is not defined by '${n.particle}'`);return new Dt(r,n.param)}case\"localName\":if(!r.byName.has(n.name))throw new Ti(t.location,`local name '${n.name}' does not exist in recipe`);if(null==n.param&&0===n.tags.length&&r.byName.get(n.name).handle)return new Ft(r.byName.get(n.name).handle);throw new Ti(t.location,\"references to particles by local name not yet supported\");case\"tag\":return new Lt(n.tags);default:throw new Ti(t.location,`endpoint ${n.targetType} not supported`)}};for(const e of r.connections){const n=s(e,e.from),r=s(e,e.to);t.newConnectionConstraint(n,r,e.direction)}r.search&&(t.search=new Kt(r.search.phrase,r.search.tokens));for(const e of r.slots){const n=t.newSlot(void 0);e.ref.id&&(n.id=e.ref.id),e.ref.tags&&(n.tags=e.ref.tags),e.name&&(d()(!r.byName.has(e.name),`Duplicate slot local name ${e.name}`),n.localName=e.name,r.byName.set(e.name,n)),r.bySlot.set(n,e)}for(const n of r.particles){const i=t.newParticle(n.ref.name);if(i.verbs=n.ref.verbs,!(t instanceof Gt)&&n.ref.name){const t=e.findParticleByName(n.ref.name);if(!t)throw new Ti(n.location,`could not find particle ${n.ref.name}`);i.spec=t.clone()}n.name&&(d()(!r.byName.has(n.name)),i.localName=n.name,r.byName.set(n.name,{item:n,particle:i})),r.byParticle.set(i,n);for(const e of n.slotConnections){if(\"provide\"===e.direction)throw new Ti(n.location,\"invalid slot connection: provide slot must be dependent\");let s=i.consumedSlotConnections[e.param];if(!s){if(void 0!==i.spec){if(!i.spec.slotConnections.has(e.param))throw new Ti(e.location,`Consumed slot '${e.param}' is not defined by '${i.name}'`);e.dependentSlotConnections.forEach(e=>{if(!i.getSlotSpecByName(e.param))throw new Ti(e.location,`Provided slot '${e.param}' is not defined by '${i.name}'`)})}s=i.addSlotConnection(e.param)}s.tags=e.tags||[],e.dependentSlotConnections.forEach(e=>{if(\"consume\"===e.direction)throw new Ti(n.location,\"invalid slot connection: consume slot must not be dependent\");if(0!==e.dependentSlotConnections.length)throw new Ti(n.location,\"invalid slot connection: provide slot must not have dependencies\");if(t instanceof Gt){const n=t.parent.slots.find(t=>t.localName===e.name);void 0!==n&&(s.providedSlots[e.param]=n,n.sourceConnection=s,n.name=e.param)}let i=s.providedSlots[e.param];if(i){if(e.name)if(r.byName.has(e.name)){const n=r.byName.get(e.name);d()(n!==i),d()(!n.name&&i),d()(!n.sourceConnection&&i.sourceConnection),i.id=n.id,i.tags=n.tags,r.byName.set(e.name,i),t.removeSlot(n)}else r.byName.set(e.name,i);r.bySlot.set(i,e)}else i=r.byName.get(e.name);i||((i=t.newSlot(e.param)).localName=e.name,i.sourceConnection=s,e.name&&(d()(!r.byName.has(e.name)),r.byName.set(e.name,i)),r.bySlot.set(i,e)),s.providedSlots[e.param]||(s.providedSlots[e.param]=i),i.localName=e.name})}}for(const[n,i]of r.byParticle){for(const s of i.connections){let i;\"*\"===s.param?i=n.addUnnamedConnection():(i=n.connections[s.param])||(i=n.addConnectionName(s.param)),i.tags=s.target?s.target.tags:[];const o={\"->\":\"out\",\"<-\":\"in\",\"=\":\"inout\",consume:\"`consume\",provide:\"`provide\"}[s.dir];if(i.direction){if(!(i.direction===o||\"inout\"===o||\"host\"===i.direction&&\"in\"===o||\"`consume\"===i.direction&&\"in\"===o||\"`provide\"===i.direction&&\"out\"===o))throw new Ti(s.location,`'${s.dir}' not compatible with '${i.direction}' param of '${n.name}'`)}else{if(\"*\"!==s.param&&void 0!==n.spec)throw new Ti(s.location,`param '${s.param}' is not defined by '${n.name}'`);i.direction=o}let a,l;if(s.target&&s.target.name){let e=r.byName.get(s.target.name);if(e){if(!e.item)throw new Ti(s.location,`did not expect ${e} expected handle or particle`)}else{const n=t.newHandle();n.tags=[],n.localName=s.target.name,n.fate=\"create\",n.item={kind:\"handle\"},e={item:n.item,handle:n},r.byName.set(n.localName,e),r.byHandle.set(n,n.item)}if(\"handle\"===e.item.kind||\"requireHandle\"===e.item.kind)a=e.handle;else{if(\"particle\"!==e.item.kind)throw new Ti(s.location,`did not expect ${e.item.kind}`);l=e.particle}}if(s.target&&s.target.particle){const t=e.findParticleByName(s.target.particle);if(!t)throw new Ti(s.target.location,`Could not find hosted particle '${s.target.particle}'`);if(!(a=Xt.constructImmediateValueHandle(i,t,e.generateID())))throw new Ti(s.target.location,`Hosted particle '${t.name}' does not match interface '${i.name}'`)}if(l){let e;s.target.param?(e=l.connections[s.target.param])||(e=l.addConnectionName(s.target.param)):e=l.addUnnamedConnection(),(a=e.handle)||(a=t.newHandle(),e.connectToHandle(a))}a&&i.connectToHandle(a)}for(const e of i.slotConnections){let i=r.byName.get(e.name);i?(d()(r.bySlot.has(i)),i.name||(i.name=e.param),d()(i===r.byName.get(e.name),`Target slot ${i.name} doesn't match slot connection ${e.param}`)):e.name&&(t instanceof Gt&&void 0!==(i=t.parent.slots.find(t=>t.localName===e.name))&&(r.bySlot.set(i,e),e.name&&r.byName.set(e.name,i)),null==i&&((i=t.newSlot(e.param)).localName=e.name,r.byName.set(e.name,i),r.bySlot.set(i,e))),i&&n.consumedSlotConnections[e.param].connectToSlot(i)}}if(r.description&&r.description.description&&(t.description=r.description.description),r.require)for(const n of r.require){const r=t.newRequireSection();this._buildRecipe(e,r,n.items)}}resolveTypeName(e){const t=this.findSchemaByName(e);if(t)return{schema:t};const n=this.findInterfaceByName(e);return n?{iface:n}:null}static async _processStore(e,t,n){const r=t.name;let i=t.id;const s=t.originalId,o=t.type.model;null==i&&(i=`${e._id}store${e._stores.length}`);let a,l,c,h,u=t.tags;if(null==u&&(u=[]),\"storage\"===t.origin)return void e.newStorageStub(o,r,i,t.source,u,s);if(\"file\"===t.origin)t.source=n.join(e.fileName,t.source),a=await n.loadResource(t.source);else if(\"resource\"===t.origin&&(l=t.source,null==(a=e.resources[l])))throw new Ti(t.location,`Resource '${l}' referenced by store '${i}' is not defined in this manifest`);try{c=JSON.parse(a)}catch(e){throw new Ti(t.location,`Error parsing JSON from '${l}' (${e.message})'`)}if(o instanceof qe)h=o.collectionType;else if(o instanceof We)h=o.bigCollectionType;else{if(0===c.length)return void await Ii._createStore(e,o,r,i,u,t,s);c=c.slice(c.length-1),h=o}if(h instanceof Ue){let n=!1;if(c=c.map(t=>{if(null==t)return null;n=n||t.$id;const r=t.$id||e.generateID().toString();return delete t.$id,{id:r,rawData:t}}),!t.id&&!n){i=`${i}:${await It(JSON.stringify(c.map(e=>e.rawData)))}`}}const d=t.version||0,f=await Ii._createStore(e,o,r,i,u,t,s);if(c.length>0&&c[0].rawData&&c[0].rawData.storageKey){let t=c[0].rawData.storageKey;t=e.findStoreByName(t).storageKey,c=c.map(({id:e,rawData:n})=>({id:e,storageKey:t}))}else c.length>0&&(f.referenceMode=!1);let p;p=o instanceof qe?c.map(e=>({id:e.id,value:e,keys:new Set([e.id])})):o instanceof We?c.map(e=>{const t=e.rawData.$index;return delete e.rawData.$index,{id:e.id,index:t,value:e,keys:new Set([e.id])}}):c.map(e=>({id:e.id,value:e})),await f.fromLiteral({version:d,model:p})}static async _createStore(e,t,n,r,i,s,o){const a=await e.createStore(t,n,r,i);return a.source=s.source,a.description=s.description,a.originalId=o,a}_newRecipe(e){const t=new Jt(e);return this._recipes.push(t),t}toString(e){e=e||{};const t=[];return this._imports.forEach(n=>{if(e.recursive){t.push(`// import '${n.fileName}'`);n.toString(e);t.push(`${n.toString(e)}`)}else t.push(`import '${n.fileName}'`)}),Object.values(this._schemas).forEach(e=>{t.push(e.toManifestString())}),Object.values(this._particles).forEach(e=>{t.push(e.toString())}),this._recipes.forEach(n=>{t.push(n.toString(e))}),[...this.stores].sort(Bt).forEach(e=>{t.push(e.toString(this.storeTags.get(e).map(e=>`#${e}`)))}),t.join(\"\\n\")}get idGeneratorForTesting(){return this._idGenerator}}\n/**\n * @license\n * Copyright (c) 2019 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n/**\n * @license\n * Copyright (c) 2019 Google Inc. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * Code distributed by Google as part of this project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nconst Ri=i()(process.argv.slice(2),{string:[\"output\"],boolean:[\"verbose\",\"help\"],alias:{o:\"output\",v:\"verbose\"},default:{output:\"bundle.zip\",verbose:!1}});(Ri.help||0===Ri._.length)&&(console.log(\"Usage\\n  $ bundle [-options] [file ...]\\n\\nDescription\\n  Creates a zip bundle containing all transitive dependencies of an Arcs manifest.\\n\\nOptions\\n  --output, -o   name of the created bundle, bundle.zip by default\\n  --verbose, -v  list bundled files\\n  --help         usage info\\n\\nExamples\\n  $ bundle feature.recipes\\n  $ bundle -v -o mybundle.zip recipes/feature.recipes recipes/extra_stuff.manifest\"),process.exit()),Array.isArray(Ri.output)&&(console.error(\"Only one output path can be specified\"),process.exit(1)),async function(e,t,n){const r=await async function(...e){e=e.map(e=>l.a.isAbsolute(e)?e:l.a.resolve(process.cwd(),e).split(l.a.sep).join(\"/\"));const t=new Ct,n=await Promise.all(e.map(e=>Ii.load(e,t))),r=new Set;n.forEach(e=>(function e(t,n){n.add(t.fileName);for(const e of t.particles)n.add(e.implFile);for(const e of t.stores)e instanceof rn&&e.source&&n.add(e.source);for(const r of t.imports)e(r,n)})(e,r));const i=[...r].sort(),s=function(e){const t=e[0],n=e[e.length-1];let r=0;for(let e=0;e<Math.min(t.length,n.length)&&t[e]===n[e];e++)\"/\"===t[e]&&(r=e+1);return r}(i),o=n.map(e=>e.fileName);return i.map(e=>({filePath:e,bundlePath:e.substr(s),entryPoint:o.includes(e)}))}(...e);return n&&(console.log(\"Bundled files:\"),r.forEach(e=>console.log(e.filePath))),new Promise(e=>{const n=l.a.dirname(t);o.a.existsSync(n)||o.a.mkdirSync(n,{recursive:!0});const i=new h.a;for(const e of r)i.file(e.bundlePath,o.a.readFileSync(e.filePath));i.file(\"bundle-manifest.mf\",r.filter(e=>e.entryPoint).map(e=>`entry-point: ${e.bundlePath}\\n`).join(\"\")),i.generateNodeStream({streamFiles:!0}).pipe(o.a.createWriteStream(t)).on(\"finish\",()=>e())})}(Ri._,Ri.output,Ri.verbose).catch(e=>{console.error(e.message),process.exit(1)})}]);","extractedComments":[]}